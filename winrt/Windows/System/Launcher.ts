// --------------------------------------------------
// <auto-generated>
//     This code was generated by tswinrt.
//     Generated from Windows 255.255.255.255 at Fri Mar 26 17:23:08 2021
// </auto-generated>
// --------------------------------------------------

import { AsyncOperation, IAsyncOperation } from "../Foundation/IAsyncOperation`1";
import { GenerateShim } from "../Foundation/Interop/GenerateShim";
import { Uri } from "../Foundation/Uri";
import { IStorageFile } from "../Storage/IStorageFile";
import { LauncherOptions } from "./LauncherOptions";
import { shell } from "electron";

@GenerateShim('Windows.System.Launcher')
export class Launcher {
    static launchFileAsync(file: IStorageFile): IAsyncOperation<boolean> {
        return Launcher.launchFileWithOptionsAsync(file, null);
    }

    static launchFileWithOptionsAsync(file: IStorageFile, options: LauncherOptions): IAsyncOperation<boolean> {
        console.log(`request to launch ${file.path}...`);

        return AsyncOperation.from(async () => {
            await shell.openPath(file.path);
            return true;
        })
    }

    static launchUriAsync(uri: Uri): IAsyncOperation<boolean> {
        return Launcher.launchUriWithOptionsAsync(uri, null);
    }

    static launchUriWithOptionsAsync(uri: Uri, options: LauncherOptions): IAsyncOperation<boolean> {
        console.log(`request to launch ${uri.toString()}...`);

        return AsyncOperation.from(async () => {
            await shell.openExternal(uri.toString());
            return true;
        })
    }
}
