Share.MailDataLoader=function(){Share.DataLoader.apply(this,arguments)};Jx.augment(Share.MailDataLoader,Share.DataLoader);Share.MailDataLoader.prototype.beginLoading=function(){var n=Windows.ApplicationModel.DataTransfer.StandardDataFormats,t=this._createDataLoadPromise(n.webLink,this._dataPackage.getWebLinkAsync,this._shareData.tryInitializeWithUri),i=this._createDataLoadPromise(n.html,this._dataPackage.getHtmlFormatAsync,this._shareData.tryInitializeWithHtml),r=this._createDataLoadPromise(n.storageItems,this._dataPackage.getStorageItemsAsync,this._shareData.tryInitializeWithFiles),u=WinJS.Promise.join([t,i]).then(function(){return this._shareData.containsShareType(n.webLink)||this._shareData.containsShareType(n.html)?WinJS.Promise.as(null):this._createDataLoadPromise(n.text,this._dataPackage.getTextAsync,this._shareData.tryInitializeWithText)}.bind(this),function(n){Jx.log.exception("Share.MailDataLoader: Error joining WebLink and HTML Promises",n)}),f=r.then(function(){return this._shareData.containsShareType(n.storageItems)?WinJS.Promise.as(null):this._createDataLoadPromise(n.bitmap,this._dataPackage.getBitmapAsync,this._shareData.tryInitializeWithBitmap)}.bind(this),function(n){Jx.log.exception("Share.MailDataLoader: Error in files promise",n)});WinJS.Promise.join([f,u]).then(function(){this._shareData.isEmpty()&&(Jx.log.info("Share.DataLoader was not able to find any data to use in the data package."),this._shareData.recordError(null,Share.Constants.DataError.invalidFormat));this._shareData.calculateSubject();this.callCompleted()}.bind(this),function(n){this.callError(n)}.bind(this))};Share.MailDataLoader.prototype._createDataLoadPromise=function(n,t,i){return this._dataPackage.contains(n)?t.apply(this._dataPackage).then(function(t){try{var r=i.apply(this._shareData,[t]);r?Jx.log.info("Share.MailDataLoader successfully added to data object format: "+n):Jx.log.info("Share.MailDataLoader failed to validate format: "+n)}catch(u){this.callError(u)}}.bind(this),function(t){Jx.log.exception("Share.MailDataLoader: Error loading from dataPackage for type: "+n,t)}):WinJS.Promise.as(null)}