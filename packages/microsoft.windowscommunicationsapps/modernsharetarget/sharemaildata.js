Share.MailData=function(){Share.BaseData.apply(this,arguments);this.containedDataFormats=[]};Jx.augment(Share.MailData,Share.BaseData);Share.MailData.prototype.createDataLoader=function(){return new Share.MailDataLoader};Share.MailData.prototype.calculateSubject=function(){var t=Share.BaseData,n=this._tryGetProperty(this.shareOperation.data,"Subject");Jx.isString(n)||(n=this._tryGetProperty(this.shareOperation.data,"subject"),Jx.isString(n)||(n=t._tryGetTitle(this.shareOperation.data)));this.subject=t._truncateText(n,Share.Constants.subjectMax)};Share.MailData.prototype.containsShareType=function(n){return this.containedDataFormats.indexOf(n)!==-1};Share.MailData.prototype.isEmpty=function(){return this.containedDataFormats.length===0};Share.MailData.prototype.tryInitializeWithText=function(n){var t=false,i;return Jx.isNonEmptyString(n)&&(i=Jx.escapeHtml(n),t=Jx.isNonEmptyString(i.trim()),t&&(this.messageHtml=i,this.containedDataFormats.push(Windows.ApplicationModel.DataTransfer.StandardDataFormats.text))),t};Share.MailData.prototype.tryInitializeWithHtml=function(n){var r=false,t,i,u,e;if(Jx.isNonEmptyString(n)&&(t=Windows.ApplicationModel.DataTransfer.HtmlFormatHelper.getStaticFragment(n),r=Jx.isNonEmptyString(t.trim()),r)){if(i=this._extractHtmlFromFragment(n),i){i=window.toStaticHTML(i);var o=document.createRange(),s=o.createContextualFragment(n),f=s.querySelectorAll("style");for(u=f.length;u--;)e=f[u],t=e.outerHTML+t}this.messageHtml=t;this.containedDataFormats.push(Windows.ApplicationModel.DataTransfer.StandardDataFormats.html)}return r};Share.MailData.prototype._extractHtmlFromFragment=function(n){var s;Share.mark("extractHtmlFromFragment",Share.LogEvent.start);var u=null,f=n.match(/StartHTML:\d+/i),e=n.match(/EndHTML:\d+/i);if(f&&e){var t=Number(f[0].slice(10)),i=Number(e[0].slice(8)),o=window.unescape(encodeURIComponent(n)),r=o.length;t<=r&&i<=r&&t<=i?(s=o.slice(t,i),u=decodeURIComponent(window.escape(s))):Jx.log.error("StartHTML "+t+" and EndHTML "+i+" don't make sense for fragment of length "+r)}else Jx.log.error("Malformed CF_HTML fragment, missing StartHTML or EndHTML");return Share.mark("extractHtmlFromFragment",Share.LogEvent.end),u};Share.MailData.prototype.tryInitializeWithUri=function(n){var t=Jx.isObject(n),i;return t&&(i=n.schemeName.toLowerCase(),t=i==="http"||i==="https",t&&(this.uri=n,this.containedDataFormats.push(Windows.ApplicationModel.DataTransfer.StandardDataFormats.webLink))),t};Share.MailData.prototype.tryInitializeWithFiles=function(n){var t=Boolean(n)&&n.length>0;return t?(this.containedDataFormats.push(Windows.ApplicationModel.DataTransfer.StandardDataFormats.storageItems),this.storageItems=n):Jx.log.verbose("Received empty list of files from package"),t};Share.MailData.prototype.tryInitializeWithBitmap=function(n){var t=Boolean(n);return t?(this.containedDataFormats.push(Windows.ApplicationModel.DataTransfer.StandardDataFormats.bitmap),this.bitmap=n):Jx.log.verbose("Received empty bitmap from package"),t};Share.MailData.prototype._tryGetProperty=function(n,t){var i=null;return n.properties.hasKey(t)&&(i=n.properties.lookup(t)),i};Share.MailData.prototype.containedDataFormats=null;Share.MailData.prototype.messageHtml="";Share.MailData.prototype.subject="";Share.MailData.prototype.mailMessage=null;Share.MailData.prototype.account=null;Share.MailData.prototype.platform=null;Share.MailData.prototype.quickLink=null;Share.MailData.prototype.uri=null;Share.MailData.prototype.storageItems=null;Share.MailData.prototype.bitmap=null;Object.defineProperty(Share.MailData.prototype,"sourceUri",{get:function(){return this.shareOperation.data.properties.contentSourceWebLink}})