(function(){function o(n,t,i){return n.replace(/\{0\}/g,i).replace(/\{1\}/g,t)}function f(n){var t=document.createElement("link");t.type="text/css";t.rel="stylesheet";t.href=n;document.head.appendChild(t)}function s(){Qx.prototype.find=function(n){return Qx(this[0].querySelectorAll(n))};Qx.prototype.val=function(n){return n?(this[0].value=n,this):this[0].value};Qx.prototype.bind=Qx.prototype.on;Qx.prototype.attr=function(n,t){return this[0][n]=t,this};Qx.prototype.hide=function(){return this.css({display:"none"})}}function h(n){var b=function(n,t,i,r){return function(){i[r]=t?t.value!=="":true;n.disabled=false;for(var u in i)n.disabled=n.disabled||!i[u]}},h,c,u,f,it,k,rt,d,w,t,l,a,ut,v,ft,et;s();var y=Qx(i),p=y.find(".SURVEYSECTION"),ot=Qx(p[p.length-1]).find(".NAVBUTTON").last().val();for(h=0;h<p.length;h++){var g=Qx(p[h]),nt=g.find(".QUESTIONCONTAINER"),tt=g.find(".NAVBUTTON"),r=Qx(tt[tt.length-1]);for(h>0?(r.val(ot),Jx.addClass(r[0],"SecondButton")):Jx.addClass(r[0],"FirstButton"),c=[],u=0;u<nt.length;u++){if(f=Qx(nt[u]),f.find("table").each(function(){Qx(this).css({width:"100%"})}),it=f.find(".helplink"),it[0]){r.hide();continue}if(k=f.find(".QUESTIONREQUIRED"),rt=k.length>0&&k.html(),rt){for(r[0].disabled=true,c[u]=false,d=f.find("input"),w=0;w<d.length;w++)if(t=d[w],t.type==="radio"){Qx(t).on({click:b(r[0],null,c,u)});l=document.createElement("label");a=t.parentElement;t.nextSibling?(a.removeChild(t.nextSibling),l.innerHTML=t.value,t.fmsId=t.id,t.id=t.name+t.value):a.nextSibling&&(l.innerHTML=a.nextSibling.innerHTML);l.htmlFor=t.id;a.appendChild(l)}else t.type==="text"&&(ut=b(r[0],t,c,u),Qx(t).bind({input:ut}),t.type="email");v=f.find("textarea");v[0]&&(v.attr("rows",4),ft=b(r[0],v[0],c,u),v.bind({input:ft}))}}}y.find(".QUESTIONTEXT, .QUESTIONINSTRUCTION, .SURVEYINTROTEXT").each(function(){var n=this.innerHTML,t=Qx(this);n?(n=o(n,_ms_support_fms_surveyConfig.parameters[0],_ms_support_fms_surveyConfig.localizedAppName),this.innerHTML=n):Qx(this).hide()});et=n.encodeAnswers;n.encodeAnswers=function(t){return y.find("input").each(function(){this.fmsId&&(this.id=this.fmsId)}),y.find("option").each(function(){var n,r,t,i;if(this.selected)for(n=0;n<plugin0.pages.length;n++)for(r=plugin0.pages[n].questions,t=0;t<r.length;t++)i=r[t],i.getOptionById&&i.getOptionById(this.id)&&(i.selected=true)}),et.apply(n,[t])};n.onAfterNext.add(new window.MS.Support.Fms.SurveyEventDelegate(null,e));n.onAfterPrevious.add(new window.MS.Support.Fms.SurveyEventDelegate(null,e))}function e(){var t=window.plugin0,i=t.getCurrentPage(),f=t.pages[t.pages.length-2],e=t.pages[t.pages.length-1],r=false,u=false;i===f?t.next():i===e?c():i===t.pages[0]?r=true:u=Qx(i.domObject).find("button").length>0;parent.postMessage({onFirstPage:r,showHelp:u},n)}function c(){parent.postMessage({submitted:true,textInput:window.plugin0.submitFields.SURVEYANSWERS},n)}function l(t,i){clearTimeout(u);clearInterval(t);h(i);parent.postMessage({loaded:true},n)}function a(t){var i=t.data;t.origin===n&&i.backButtonPressed&&plugin0.previous()}var i=document.getElementById("FMSContainer"),n="ms-appx://"+decodeURIComponent(document.domain),r,t,u;window.handleLoad=function(){parent.postMessage({jsLoaded:true},n);var t=setInterval(function(){try{if(window.MS&&window.MS.Support.Fms.Survey.SurveyInstances.SURVERCONTAINER_plugin0){var n=window.MS.Support.Fms.Survey.SurveyInstances.SURVERCONTAINER_plugin0;n.startTime&&l(t,n)}}catch(i){Jx.log.exception("Feedback: Error when polling for FMS JS variables",i)}},100)};r=document.URL.split("?")[1];window._ms_support_fms_surveyConfig=JSON.parse(r);window._ms_support_fms_surveyConfig.target=i.id;f(_ms_support_fms_surveyConfig.localCss);f("/resources/sendasmile/css/"+_ms_support_fms_surveyConfig.parameters[0]+"SaSColor.css");t=document.createElement("script");t.type="text/javascript";t.src = "/jx/Jx.js";document.head.appendChild(t);window.addEventListener("message",a,false);u=setTimeout(function(){parent.postMessage({badLoad:true},n)},_ms_support_fms_surveyConfig.loadTimeout);window.alert=function(){}})()