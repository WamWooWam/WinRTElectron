Share.SOXE={};Share.SOXE.beginSOXERequest=function(n,t,i,r){var u=new XMLHttpRequest;return new WinJS.Promise(function(f,e){var o={lookUpUrl:n,ticket:t,soxeUrl:i,externalCallBack:f,externalErrorCallBack:e,xmlHttpRequest:u,market:r};Share.SOXE._soxeRequest(o)},function(){u.abort()})};Share.SOXE._soxeRequest=function(n){var u,c,f,e,o,s;try{var r=n.lookUpUrl,h=n.ticket,a=n.externalCallBack,i=n.externalErrorCallBack,t=n.xmlHttpRequest,v=n.soxeUrl,y=n.market;if(Jx.isNonEmptyString(r)){if(u=Share.SOXE._soxeUrlOverride?Share.SOXE._soxeUrlOverride+"&url="+encodeURIComponent(r):v+"?url="+encodeURIComponent(r),c=new Windows.Foundation.Uri(u),t.open("GET",u,true,null,null),t.setRequestHeader("Host",c.host),t.setRequestHeader("Accept-Language",y),Jx.isNonEmptyString(h))t.setRequestHeader("WLAuthToken",h);else{f="SOXE does not have a valid ticket";e=new Error(f);e.number=Share.Constants.ErrorCode.accessDenied;Jx.log.error(f);i(e);return}t.timeout=Share.SOXE._timeout;t.ontimeout=i;t.onreadystatechange=function(){try{t.readyState===4&&Share.SOXE._endSOXE(t,a,i)}catch(n){Jx.log.exception("Error retrieving/parsing SOXE results.",n);i(n)}};t.send(null)}else o="Url to send to SOXE was invalid.",s=new Error(o),s.number=Share.Constants.ErrorCode.invalidArgument,Jx.log.error(o),i(s)}catch(l){Jx.log.exception("Error sending SOXE request.",l);i(l)}};Share.SOXE._endSOXE=function(n,t,i){if(n.status===200)t(JSON.parse(n.responseText));else if(n.status!==200){var r="SOXE could not return results. Status code: "+n.status,u=new Error(r);u.number=Share.Constants.ErrorCode.unknownError;Jx.log.error(r);i(u)}};Share.SOXE._timeout=15e3;Share.SOXE._soxeUrlOverride=""