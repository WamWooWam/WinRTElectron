self.Jx={};Jx.isWWA="Windows"in self;Jx.isWorker="WorkerGlobalScope"in self;Jx.isTrident="msCapture"in self;Jx.inherit=function(n,t){function i(){}i.prototype=t.prototype||t;n.prototype=new i;n.prototype.constructor=n};Jx.mix=function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n};Jx.augment=function(n,t){return Jx.mix(n.prototype,t.prototype||t)};Jx.dispose=function(n){n&&n.dispose?n.dispose():n&&n.close&&n.close()};Jx._escapeRegex=/[&<>'"]/g;Jx._escapeChars={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"};Jx._escapeFn=function(n){return Jx._escapeChars[n]||" "};Jx.escapeHtml=function(n){return n.replace(Jx._escapeRegex,Jx._escapeFn)};Jx._escapeToSingleLineRegex=/[\n\r]+|[&<>'"]/g;Jx.escapeHtmlToSingleLine=function(n){return n.replace(Jx._escapeToSingleLineRegex,Jx._escapeFn)};Jx.fnEmptyString=function(){return""};Jx.fnEmpty=function(){};Jx.isString=function(n){return typeof n=="string"};Jx.isNonEmptyString=function(n){return typeof n=="string"&&Boolean(n)};Jx.isDefined=function(n){return n!=null};Jx.isNullOrUndefined=function(n){return n===undefined||n===null};Jx.isUndefined=function(n){return n===undefined};Jx.isObject=function(n){return n!==undefined&&n!==null&&typeof n=="object"};Jx.isInstanceOf=function(n,t){if(!Jx.isObject(n))return false;return t===undefined||n instanceof t};Jx.isObjectType=function(n){return typeof n=="object"};Jx.isFunction=function(n){return typeof n=="function"};Jx.isArray=function(n){return Array.isArray(n)};Jx.isNumber=function(n){return typeof n=="number"};Jx.isValidNumber=function(n){return typeof n=="number"&&isFinite(n)};Jx.isBoolean=function(n){return typeof n=="boolean"};Jx.isDate=function(n){return n instanceof Date};Jx._uidLast=0;Jx.uid=function(){return++this._uidLast};Jx._markPrefix="";Jx.setMarkPrefix=function(n){Jx._markPrefix=n};Jx.mark=function(n){msWriteProfilerMark(Jx._markPrefix+n)};Jx._startTA=function(n){Jx.mark("Jx."+n+",StartTA,Jx")};Jx._stopTA=function(n){Jx.mark("Jx."+n+",StopTA,Jx")};Jx.help=function(n){var t,i;t=Windows.System;i=new t.LauncherOptions;i.desiredRemainingView=Windows.UI.ViewManagement.ViewSizePreference.useHalf;t.Launcher.launchUriAsync(new Windows.Foundation.Uri("http://go.microsoft.com/fwlink/p/?LinkId="+{calendar:"282451",mail:"282452",people:"282453"}[n]),i).done()};Jx.abi=null;Jx.initABI=function(){Jx._startTA("abi");Jx.abi=new Microsoft.WindowsLive.Jx;Jx._stopTA("abi");Jx.initABI=Jx.fnEmpty};Jx.etw=function(n){Jx.initABI();Jx.abi.etw(n)};Jx.startSession=function(){Jx.initABI();Jx.abi.startSession()};Jx.flushSession=function(){Jx.abi&&Jx.abi.flushSession()};Jx.ptStart=function(n,t){Jx.initABI();Jx.abi.ptStart(n,t||"")};Jx.ptStop=function(n,t){Jx.initABI();Jx.abi.ptStop(n,t||"")};Jx.ptStopData=function(n,t,i,r,u,f,e,o,s){Jx.initABI();Jx.abi.ptStopData(n,t,i,r,u,f,e,o,s)};Jx.TimePoint={visibleComplete:0,responsive:1};Jx.ptStopLaunch=function(n,t){Jx.initABI();Jx.abi.ptStopLaunch(n,t)};Jx.ptStopResume=function(n){Jx.initABI();Jx.abi.ptStopResume(n)};Jx.ptStopResize=function(n,t,i,r,u){Jx.initABI();Jx.abi.ptStopResize(n,t,i,r,u)};Jx.fault=function(n,t,i){var r="Jx.fault: ( "+n+" ) : ( "+t+" )",u=-1;Jx.isValidNumber(i)&&(i={number:i,message:"From HRESULT"});i?(Jx.log&&Jx.log.exception(r,i),Jx.isNumber(i.number)&&(u=i.number)):Jx.log&&Jx.log.error(r);Jx.initABI();Jx.abi.fault(n,t,u)};Jx.erRegisterFile=function(n){Jx.log.info("Jx.erRegisterFile: "+n);Jx.initABI();Jx.abi.erRegisterFile(n)};Jx.promoteOriginalStack=function(n){var t,i;n instanceof Error&&(t=n.stack,Jx.isNonEmptyString(t)&&(i=n.description,n.description=Jx.isNonEmptyString(i)&&t.indexOf(i)===0?t:JSON.stringify(i)+" "+t))};Jx.findKey=function(n,t){for(var i in n)if(n[i]===t)return i};Jx.getAppNameFromId=function(n){for(var r=Object.keys(Jx.AppId),u=r.length,i,t=0;t<u;t++)if(i=r[t],Jx.AppId[i]===n&&i!=="min")return i};Jx.terminateApp=function(n){if(n||(n=new Error("[Jx.terminateApp: no original error]")),Jx.isString(n.description)||(n.description=n.message||"[Jx.terminateApp: no original description/message]"),!Jx.isString(n.stack)){if(n instanceof Error)try{throw n}catch(t){n.stack="[Jx.terminateApp] "+t.stack}Jx.isString(n.stack)||(n.stack="[Jx.terminateApp: no original stack]")}Jx.isValidNumber(n.number)||(n.number=0);MSApp.terminateApp(n)};Jx.ensurePromiseErrorHandling=function(){var i;if(Boolean(window.WinJS)&&Boolean(window.WinJS.Promise)){Jx.ensurePromiseErrorHandling=function(){};var n=function(n){if(n instanceof Error){if(n.name==="Canceled")return}else{var t;try{t=JSON.stringify(n)}catch(i){t="[Jx terminateOnError: unknown description]"}n=new Error(t)}Jx.terminateApp(n)},t=WinJS.Promise.wrapError(null),r=Object.getPrototypeOf(t).done;Object.getPrototypeOf(t).done=function(t,i,u){i=i||n;r.call(this,t,i,u)};i=WinJS.Promise.wrap();Object.getPrototypeOf(i).done=function(t){this.then(t).then(null,n)}}};Jx.appId=-1,function(){function i(t){var r,i,u;return t in n||(r="DTF:"+t,Jx._startTA(r),i=Jx.dtf(),u=t==="shortDate"?i.shortDate:t==="longDate"?i.longDate:t==="shortTime"?i.shortTime:new i(t),n[t]=u,Jx._stopTA(r)),n[t]}var r,n,t;Jx.dtf=function(){return r||(r=Windows.Globalization.DateTimeFormatting.DateTimeFormatter)};n={};t=Jx.DTFormatter=function(n){this._pattern=n};t.prototype={format:function(n){return i(this._pattern).format(n)}};Object.defineProperty(t.prototype,"clock",{get:function(){return i(this._pattern).clock}})}();Jx.delayDefine=function(n,t,i){if(Jx.isNonEmptyString(t))Object.defineProperty(n,t,{get:function(){return Object.defineProperty(n,t,{value:undefined,writable:true}),Jx.mark("Jx.delayDefine:"+t+",StartTA,Jx"),i(),Jx.mark("Jx.delayDefine:"+t+",StopTA,Jx"),n[t]},set:function(i){Object.defineProperty(n,t,{value:i,writable:true})},enumerable:true,configurable:true});else if(Jx.isArray(t))for(var r=0,u=t.length;r<u;r++)Jx.delayDefine(n,t[r],i)};Jx._delayGroups={};Jx.delayGroup=function(n,t){var i=Jx._delayGroups,r=i[n]=i[n]||[];r.push(t)};Jx.delayGroupExec=function(n){var r,t,i,u;if(r=Jx._delayGroups,t=r[n],t){for(Jx.mark("Jx.delayGroupExec:"+n+",StartTA,Jx"),i=0,u=t.length;i<u;i++)t[i]();Jx.mark("Jx.delayGroupExec:"+n+",StopTA,Jx");r[n]=null}};Jx.Events={initEvents:function(){return this._jxev=this._jxev||{},this},addListener:function(n,t,i){var r=this._jxev=this._jxev||{};return r[n]=r[n]||{recursionCount:0,isSweepNeeded:false,listeners:[]},r[n].listeners.push({fn:t,obj:i}),this},removeListener:function(n,t,i){var r,e,u,f;if(this._jxev&&(f=this._jxev[n],f))for(r=f.listeners,u=r.length;u--;)if(e=r[u],Boolean(e)&&e.fn===t&&e.obj===i)return f.recursionCount!==0?(r[u]=null,f.isSweepNeeded=true):r.splice(u,1),this;return this},hasListener:function(n){var i,r,u,t,f;if(i=this._jxev,i&&(r=i[n],r))for(u=r.listeners,t=0,f=u.length;t<f;++t)if(u[t])return true;return false},disposeEvents:function(){this._jxev&&(this._jxev=null)},raiseEvent:function(n,t,i){var s="Jx.Events.raiseEvent:"+n,f,e,r,h,u,o;if(Jx.mark(s+",StartTA,Jx,Events"),i=i||{},i.listeners=0,o=this._jxev,o&&(u=o[n],u)){for(f=u.listeners,++u.recursionCount,r=0,h=f.length;r<h;++r)e=f[r],e&&(e.fn.call(e.obj,t),i.listeners++);if(--u.recursionCount==0&&u.isSweepNeeded){for(r=f.length;r--;)f[r]||f.splice(r,1);u.isSweepNeeded=false}}return Jx.mark(s+",StopTA,Jx,Events"),this}};Jx.initEvents=function(n){return Jx.Events.initEvents.call(n)};Jx.addListener=function(n,t,i,r){return Jx.Events.addListener.call(n,t,i,r)};Jx.removeListener=function(n,t,i,r){return Jx.Events.removeListener.call(n,t,i,r)};Jx.hasListener=function(n,t){return Jx.Events.hasListener.call(n,t)};Jx.raiseEvent=function(n,t,i){return Jx.Events.raiseEvent.call(n,t,i)};Jx.disposeEvents=function(n){return Jx.Events.disposeEvents.call(n)};Jx.Log=function(){};Jx.LOG_ALWAYS=0;Jx.LOG_CRITICAL=1;Jx.LOG_ERROR=2;Jx.LOG_WARNING=3;Jx.LOG_INFORMATIONAL=4;Jx.LOG_VERBOSE=5;Jx.Log.prototype={enabled:true,piiEnabledInShip:false,level:Jx.LOG_INFORMATIONAL,_writeMsg:function(n){msWriteProfilerMark(n)},write:function(n,t){this.enabled&&n<=this.level&&this._writeMsg(t)},always:function(n){this.write(Jx.LOG_ALWAYS,n)},critical:function(n){this.write(Jx.LOG_CRITICAL,n)},error:function(n){this.write(Jx.LOG_ERROR,n)},warning:function(n){this.write(Jx.LOG_WARNING,n)},info:function(n){this.write(Jx.LOG_INFORMATIONAL,n)},verbose:function(n){this.write(Jx.LOG_VERBOSE,n)},perf:function(n,t){this.info(n+(t?" "+JSON.stringify(t):""))},exception:function(n,t){this.write(Jx.LOG_ERROR,n+"\n"+(t.stack||t.description||t.message||t.toString())+"\nError Code: "+t.number)},pii:function(n){this.piiEnabledInShip&&this.info(n)}};Jx.log=new Jx.Log;Jx.delayDefine(Jx,["Res","res"],function(){Jx.Res=function(){this._formatFns={};this._initResourceLoader()};Jx.Res.prototype={_resourceLoader:null,_initResourceLoader:function(){if(Jx.isWWA){var n=Windows.ApplicationModel.Resources.ResourceLoader;this._resourceLoader=Jx.isWorker?n.getForViewIndependentUse():n.getForCurrentView()}},_replaceRemainingEscapes:function(n){var t=n.substring(1);return t==="n"||t==="r"||t==="t"?" ":t},replaceOtherEscapes:function(n){return n.replace(/%./g,this._replaceRemainingEscapes)},getFormatFunction:function(n,t){function f(n,t){var f=n.lastIndexOf("%")+1,i="",o=f%2==1,e,r;if(o){for(e=Math.floor(f/2),r=0;r<e;r++)i+="%%";i+="' + arguments["+(t-u)+"] + '"}else i=n;return i}var r=this.getString(n),u=t?0:1,i=r.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/%+([0-9]{1,2})/g,f);return i=this.replaceOtherEscapes(i),new Function("return '"+i+"'")},loadCompoundString:function(n){var t=this._formatFns[n];return t||(t=this._formatFns[n]=this.getFormatFunction(n,true)),t.apply(null,arguments)},_parseSimple:function(n){for(var u=[],f=n.split(";"),t,r,o,s,i=0,e=f.length;i<e;i++)t=f[i],t.trim()!==""&&(r=t.indexOf(":"),o=t.substring(0,r),s=t.substring(r+1),u.push({destination:o.trim(),source:s.trim()}));return u},_getError:function(n){var t={InvalidMarkup:"Invalid markup",FailToFindItem:"Fail to find item:{0}",UndefinedProperty:"Undefined property name:{0}",InvalidValueForProperty:"Invalid value:[{0}] for given property:[{1}]",TooDeepLoop:"Nested loop more than {0} is not supported"}[n],i,r;if(t!==undefined)for(i=1,r=arguments.length;i<r;i++)t=t.replace("{"+String(i-1)+"}",arguments[i]);else t="unknown error";return t},_setMember:function(n,t,i){for(var u=n.split("."),f=t,e=u[0],r=1,o=u.length;r<o;r++)f=f[u[r-1]],e=u[r];e in HTMLElement.prototype?f[e]=i:f.setAttribute(e,i)},_parse:function(n){return this._parseSimple(n)},getString:function(n){return this._resourceLoader.getString(n)},addResourcePath:function(){},addIncludePath:function(){},_process:function(n){for(var u,r,t,o,f,i=0,e=n.length;i<e;i++)for(u=n[i],r=this._parse(u.getAttribute("data-win-res")),t=0,o=r.length;t<o;t++)f=this.getString(r[t].source),f!==undefined&&this._setMember(r[t].destination,u,f)},processAll:function(n){Jx.mark("Jx.Res.processAll,StartTA,Jx,Res");n=n||document.body;n.getAttribute("data-win-res")&&this._process([n]);var t=n.querySelectorAll("[data-win-res]");this._process(t);Jx.mark("Jx.Res.processAll,StopTA,Jx,Res")}};Jx.isWWA&&(Jx.res=new Jx.Res)});Jx.delayDefine(Jx,["AppData","appData"],function(){function n(n){Jx.mark("Jx.AppData."+n+",StartTA,Jx")}function t(n){Jx.mark("Jx.AppData."+n+",StopTA,Jx")}function i(i){i._ad||(n("current"),i._ad=Windows.Storage.ApplicationData.current,t("current"))}Jx.AppData=function(){this._rs=null;this._ls=null;this._ad=null};Jx.AppData.prototype={dispose:function(){this._ad=this._ls=this._rs=null},localSettings:function(){return i(this),this._ls||(n("localSettings"),this._ls=new Jx.AppDataContainer(this._ad.localSettings),t("localSettings")),this._ls},roamingSettings:function(){return i(this),this._rs||(n("roamingSettings"),this._rs=new Jx.AppDataContainer(this._ad.roamingSettings),t("roamingSettings")),this._rs}};Jx.AppDataContainer=function(n){this._adc=n;this._values=n.values};Jx.AppDataContainer.prototype={_settingSize:4095,dispose:function(){this._adc=null;this._values=null},name:function(){return this._adc.name},isLocal:function(){return this._adc.locality===Windows.Storage.ApplicationDataLocality.local},isRoaming:function(){return this._adc.locality===Windows.Storage.ApplicationDataLocality.roaming},_getContainer:function(n){return this._adc.containers[n]},getContainer:function(n){var t=this._getContainer(n);return t?new Jx.AppDataContainer(t):null},createContainer:function(n){return Jx.log.info("Jx.AppDataContainer.createContainer"),new Jx.AppDataContainer(this._adc.createContainer(n,Windows.Storage.ApplicationDataCreateDisposition.always))},container:function(n){return this.getContainer(n)||this.createContainer(n)},deleteContainer:function(n){Jx.log.info("Jx.AppDataContainer.deleteContainer");this._adc.deleteContainer(n)},get:function(n){return this._values.lookup(n)},set:function(n,t){return Jx.log.info("Jx.AppDataContainer.set"),this._values.insert(n,t)},remove:function(n){return Jx.log.info("Jx.AppDataContainer.remove"),this._values.remove(n)},setObject:function(n,t){function r(n,t){var u=true,f,i,e;for(f in n)if(i=n[f],!Jx.isNullOrUndefined(i)&&(Jx.isObject(i)?(e=t.createContainer(f),u=r(i,e)):u=Jx.isValidNumber(i)||Jx.isString(i)||Jx.isBoolean(i)?t.set(f,i):false,!u))break;return u}var u,i;return(u=JSON.stringify(t),Jx.log.info("Jx.AppDataContainer.setObject"),this.deleteContainer(n),i=this.createContainer(n),!r(t,i))?(this.deleteContainer(i.name()),false):true},getObject:function(n){function r(n,t){var i,r;if(t.size>0)for(i=t.first();i.hasCurrent;i.moveNext())r=i.current,n[r.key]=r.value}function u(n,t){var i,r,u;if(t.size>0)for(i=t.first();i.hasCurrent;i.moveNext())r=i.current,u=n[r.key]={},f(u,r.value)}function f(n,t){r(n,t.values);u(n,t.containers)}function e(n,t){r(n,t._values);u(n,t._adc.containers)}var t,i;return(t=this.getContainer(n),!t)?null:(i={},e(i,t),i)},getValues:function(){return this._adc.values},_getSegmentContainerName:function(n){return n+"_segment"},_setLongString:function(n,t,i){var f,r,e,o,u,s;if(Jx.log.info("Jx.AppDataContainer._setLongString"),this.remove(n),f=this._getSegmentContainerName(n),this.deleteContainer(f),r=true,i||(i=this._settingSize),e=t.length,e>i){for(o=this.createContainer(f),u=0,u;e>0&&r;e-=i,u++)s=t.substr(u*i,i),r=o._values.insert(String(u),s);r&&(r=o._values.insert("-1",u));r||this.deleteContainer(f)}else r=this._values.insert(n,t);return r},_getLongString:function(n){var t,u,i,f,r;if(t=this._values.lookup(n),!t){if(u=this._getSegmentContainerName(n),i=this.getContainer(u),!i)return"";for(f=i.get("-1"),t="",r=0;r<f;r++)t+=i.get(String(r))}return t},setObjectInSegments:function(n,t){return Jx.log.info("Jx.AppDataContainer.setObjectInSegments"),this._setLongString(n,JSON.stringify(t))},getObjectInSegments:function(n){var t=this._getLongString(n);if(Jx.isNonEmptyString(t))try{return JSON.parse(t)}catch(i){return Jx.log.exception("Jx.AppDataContainer.getObjectInSegments: JSON failed to parse data",i),Jx.log.pii("Failing data: "+t),null}else return null}};Jx.appData=null});Jx._platformNamespace=null;Jx.forceSync=function(n,t){Jx.sync(n,true,t)};Jx.startupSync=function(n,t){Jx.sync(n,false,t)};Jx.sync=function(n,t,i){var r,u,f,o,e;for(Jx.mark("Jx.forceSync,StartTA,Jx"),Jx.log.info("Jx.forceSync.start"),r=Jx._platformNamespace||Microsoft.WindowsLive.Platform,u=n.accountManager.getConnectedAccountsByScenario(i,r.ConnectedFilter.normal,r.AccountSort.name),f=0,o=u.count;f<o;f++)e=u.item(f),(Boolean(t)||Number(e.syncType)!==r.SyncType.manual)&&Jx.forceSyncAccount(e,i);u.dispose();Jx.mark("Jx.forceSync,StopTA,Jx")};Jx.forceSyncAccount=function(n,t){var e,r,u,f,i;Jx.mark("Jx.forceSyncAccount,StartTA,Jx");e=Jx._platformNamespace||Microsoft.WindowsLive.Platform;Jx.mark("Jx.forceSyncAccount - accountId:"+n.objectId+" scenario:"+t+",Info,Jx");r=e.ResourceType;u=e.ApplicationScenario;switch(t){case u.mail:f=r.mail;break;case u.calendar:f=r.calendar;break;case u.people:f=r.contacts}if(i=n.getResourceByType(f),Boolean(i)&&i.canEdit){i.isSyncNeeded=true;try{i.commit();n.commit()}catch(o){Jx.log.warning("Unable to force sync account.");Jx.log.warning("Name: "+o.name);Jx.log.warning("Message: "+o.message)}}Jx.mark("Jx.forceSyncAccount,StopTA,Jx")}