Jx.delayDefine(Calendar.Controls,"TimeIndicator",function(){"use strict";function t(n){Jx.mark("Calendar.TimeIndicator."+n+",StartTA,Calendar")}function i(n){Jx.mark("Calendar.TimeIndicator."+n+",StopTA,Calendar")}function u(){return'<div class="timeIndicator" aria-hidden="true"><div class="line"><\/div><div class="clock"><span class="text"><\/span><\/div><\/div>'}var r=Calendar.Helpers,n=Calendar.Controls.TimeIndicator=function(){if(this._resetUiMembers(),this._onVisibilityChange=this._onVisibilityChange.bind(this),this._update=this._update.bind(this),!n._formatter){var t=Windows.Globalization.ApplicationLanguages.languages,i=t[0].toLowerCase();n._formatter=i.substring(0,3)==="en-"?r.simpleTimeWithMinutes:r.simpleTimeWithMinutesNoPeriod}};n.prototype.activateUI=function(n){t("activateUI");this._host=n;this._minuteHeight=n.offsetHeight/1440;this._el?this._host.appendChild(this._el):(this._host.insertAdjacentHTML("beforeend",u()),this._el=this._host.lastElementChild,this._clock=this._el.querySelector(".clock"),this._text=this._clock.querySelector(".text"));this._update();document.addEventListener("visibilitychange",this._onVisibilityChange,false);i("activateUI")};n.prototype.deactivateUI=function(){t("deactivateUI");this._host&&(this._pause(),this._el.parentNode.removeChild(this._el),document.removeEventListener("visibilitychange",this._onVisibilityChange,false),this._host=null);i("deactivateUI")};n.prototype._resetUiMembers=function(){this._text=null;this._clock=null;this._el=null;this._timeout=null;this._host=null;this._minuteHeight=0;this._clockOffset=0};n.prototype._onVisibilityChange=function(){document.msHidden?this._pause():this._update()};n.prototype._update=function(){var c,r,o,s;t("_update");var u=new Date,e=u.getHours(),f=u.getMinutes(),l=(e*60+f)*this._minuteHeight,h=this._el.style;h.top=l+"px";h.opacity="1";this._text.innerText=n._formatter.format(u);c=this._clock.offsetHeight;r=c/2;e===0?(o=f*this._minuteHeight,o<r&&(r=o)):e===23&&(s=(60-f)*this._minuteHeight,s<r&&(r+=r-s));r!==this._clockOffset&&(this._clock.style.top="-"+r+"px",this._clockOffset=r);u.setSeconds(0);u.setMinutes(f+1);this._timeout=setTimeout(this._update,u-Date.now());i("_update")};n.prototype._pause=function(){this._el.style.opacity="0";clearTimeout(this._timeout)}})