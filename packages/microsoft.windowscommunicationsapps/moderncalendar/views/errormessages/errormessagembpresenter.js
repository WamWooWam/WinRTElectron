Jx.delayDefine(Calendar.Controls,"ErrorMessageMessageBarPresenter",function(){var t=Calendar.Controls.ErrorMessageMessageBarPresenter=function(){},n=t.prototype;n._mb=null;n._className=null;n._cm=null;n._collection=null;n._frame=null;n.init=function(n,t,i,r){var e,u,f;for(this._mb=n,this._cm=t.calendarManager,this._className=r,this._frame=i,this._collection=this._cm.getCalendarErrors(),this._collectionChanged=this._collectionChanged.bind(this),e=this._collection.count,u=0;u<e;u++)f=this._collection.item(u),f&&this._handleError(f.objectId);this._collection.addEventListener("collectionchanged",this._collectionChanged);this._collection.unlock()};n.shutdown=function(){this._collection&&(this._collection.removeEventListener("collectionchanged",this._collectionChanged),this._collection.dispose(),this._collection=null)};n._collectionChanged=function(n){n.eType==Microsoft.WindowsLive.Platform.CollectionChangeType.itemAdded&&n.objectId&&this._handleError(n.objectId)};n._handleError=function(n){var t=this._cm.getCalendarError(n),u,i,r;if(t){if(u={messageHTML:t.message,button2:{text:Jx.res.getString("/messagebar/messageBarCloseText"),tooltip:Jx.res.getString("/messagebar/messageBarCloseTooltip"),callback:this._closeClicked.bind(this)},cssClass:this._className},i=t.eventHandle,i){r=null;try{r=this._cm.getEventFromHandle(i)}catch(f){r=null}r&&(u.button1={text:Jx.res.getString("/messagebar/messageBarOpenEvent"),tooltip:Jx.res.getString("/messagebar/messageBarOpenEvent"),callback:this._openEventClicked.bind(this)})}this._mb.addErrorMessage(n,t.priority,u)}};n._closeClicked=function(n,t){this._mb.removeMessage(t);var i=this._cm.getCalendarError(t);i&&i.deleteObject()};n._openEventClicked=function(n,t){var u=this._cm.getCalendarError(t),f=true,r,i;if(u&&(r=u.eventHandle,r)){i=null;try{i=this._cm.getEventFromHandle(r)}catch(e){i=null}i&&(this._mb.removeMessage(t),u.deleteObject(),this._frame.fire("editEvent",{event:i,dirty:true}),f=false)}f&&Calendar.Helpers.showCantOpenEvent(this._mb.getButton1())}})