(function(){var n=Calendar.WorkerEx=function(n){this._worker=n;this._nextId=1;this._listeners={};this._onMessage=this._onMessage.bind(this);this._worker.addEventListener("message",this._onMessage)};n.prototype.postCommand=function(n,t,i){return i=i||this._nextId++,this._worker.postMessage({name:n,id:i,data:t}),i};n.prototype.dispose=function(){this._listeners={};this._worker.removeEventListener("message",this._onMessage);this._worker=null};n.prototype.addListener=function(n,t,i){var r=this._listeners[n]||(this._listeners[n]=[]);r.push({fn:t,ctx:i})};n.prototype.removeListener=function(n,t,i){var u=this._listeners[n],r,e,f;if(u)for(r=0,e=u.length;r<e;r++)if(f=u[r],f.fn===t&&f.ctx===i){u.splice(r,1);break}};n.prototype._onMessage=function(n){var u=n.data,e=u.command,t=this._listeners[e],i,f,r;if(t)for(t=t.slice(),i=0,f=t.length;i<f;i++)r=t[i],r.fn.call(r.ctx,u)}})()