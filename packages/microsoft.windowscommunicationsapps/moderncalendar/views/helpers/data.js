(function(){function u(n){msWriteProfilerMark("Calendar:Helpers."+n+",StartTA,Calendar")}function f(n){msWriteProfilerMark("Calendar:Helpers."+n+",StopTA,Calendar")}var n=Calendar.Helpers,r;n.isSameDate=function(n,t){return n.getDate()===t.getDate()&&n.getMonth()===t.getMonth()&&n.getFullYear()===t.getFullYear()};n.isSameMonth=function(n,t){return n.getMonth()===t.getMonth()&&n.getFullYear()===t.getFullYear()};n.isSameYear=function(n,t){return n.getFullYear()===t.getFullYear()};n.isPreviousMonth=function(t,i){var r=new Date(t.getFullYear(),t.getMonth()+1,1);return n.isSameMonth(r,i)};n.isNextMonth=function(t,i){var r=new Date(t.getFullYear(),t.getMonth()-1,1);return n.isSameMonth(r,i)};n.getMonthsBetween=function(n,t){return 12*(t.getFullYear()-n.getFullYear())+t.getMonth()-n.getMonth()};n.getYearsBetween=function(n,t){return t.getFullYear()-n.getFullYear()};n.getDayInfo=function(t,i){var r=new Date(t),f=n.isSameDate(i,r),u=false,e=false;return f||(r.setDate(r.getDate()+1),u=n.isSameDate(i,r),u||(r.setDate(r.getDate()-2),e=n.isSameDate(i,r))),{day:i,isYesterday:e,isToday:f,isTomorrow:u}};n._eventColors={};n.processEventColor=function(t){return n._eventColors[t]||(n._eventColors[t]="#"+("00000"+t.toString(16)).substr(-6))};n.minuteInMilliseconds=6e4;n.hourInMilliseconds=36e5;n.dayInMilliseconds=864e5;var i=new Jx.DTFormatter("longDate"),t=new Jx.DTFormatter("shortTime"),e=new Jx.DTFormatter("shortDate");n.dateAndTime={format:function(n){return i.format(n)+" "+t.format(n)}};n.shortDateAndTime={format:function(n){var i=Jx.isRtl()?"‏":"‎";return e.format(n)+i+" "+t.format(n)}};n.ensureFormats=function(){var t,i,r;u("ensureFormats");t=Jx.res;n.noSubject=t.getString("NoSubject");n.accEvent=t.getFormatFunction("AccEvent");n.accAllDay=t.getFormatFunction("AccEventAllDay");n.accAllDayWithDate=t.getFormatFunction("AccEventAllDayWithDate");i=Windows.Globalization.DateTimeFormatting.DateTimeFormatter;n._simpleTimeWithMinutes=new i("hour minute");n._simpleTimeWithoutMinutes=new i("hour");n._simpleTimeWithMinutes=new i(n._simpleTimeWithMinutes.patterns[0].replace(" ","​"));n._simpleTimeWithoutMinutes=new i(n._simpleTimeWithoutMinutes.patterns[0].replace(" ","​"));n._simpleTimeWithMinutesNoPeriod=new i(n._simpleTimeWithMinutes.patterns[0].replace(/\{period\.abbreviated\}/,""));n.simpleTimeWithMinutes={format:function(t){return n._simpleTimeWithMinutes.format(t).toLocaleLowerCase()}};n.simpleTimeWithMinutesNoPeriod={format:function(t){return n._simpleTimeWithMinutesNoPeriod.format(t).toLocaleLowerCase()}};n.simpleTimeWithoutMinutes={format:function(t){return n._simpleTimeWithoutMinutes.format(t).toLocaleLowerCase()}};n.simpleTime={format:function(t){return t.getMinutes()?n.simpleTimeWithMinutes.format(t):n.simpleTimeWithoutMinutes.format(t)}};n.simpleTimeUpper={format:function(t){return t.getMinutes()?n._simpleTimeWithMinutes.format(t):n._simpleTimeWithoutMinutes.format(t)}};n.dateUID=function(n){return n.toDateString().replace(/ /g,"-")};n.shortEventLength=18e5;n.mediumEventLength=3599999;n.percentageOfDay=100/n.dayInMilliseconds;n.busyStatusClasses=["free","tentative","busy","outOfOffice","workingElsewhere"];n.accEventStatuses=[t.getString("EventStatusFree"),t.getString("EventStatusTentative"),t.getString("EventStatusBusy"),t.getString("EventStatusOOF"),t.getString("EventStatusElsewhere")];n.firstDayOfWeek=Windows.System.UserProfile.GlobalizationPreferences.weekStartsOn;r=new Date(0,0,1);r.setFullYear(0);n.zeroYearTime=r.getTime();n.ensureFormats=Jx.fnEmpty;f("ensureFormats")};n.getEventUiInfo=function(r,u){n.ensureFormats();var h=r.subject||n.noSubject,c=r.location,l=n.accEventStatuses[r.busyStatus],a=r.startDate,v=r.endDate,f="",e="",o,s,y;try{f=r.calendar.name;e=r.calendar.account.emailAddress}catch(p){Jx.log.error("Event "+r.id+" has no calendar.")}return r.allDayEvent?u?(o=i.format(a),s=i.format(v),y=n.accAllDayWithDate(o,s,h,c,f,e,l)):y=n.accAllDay(h,c,f,e,l):(n.isSameDate(a,v)&&!u?(o=t.format(a),s=t.format(v)):(o=n.dateAndTime.format(a),s=n.dateAndTime.format(v)),y=n.accEvent(o,s,h,c,f,e,l)),{handle:r.handle,subject:h,location:c,label:y,calendar:f,email:e,statusText:l,color:n.processEventColor(r.color),status:n.busyStatusClasses[r.busyStatus]}};r=0;n.getIdFromEventHandle=function(n,t){var i=t?"-"+r++:"";return n+i};n.getNowDate=function(){return new Date};n.roundDateDown=function(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate())};n.getDaysUntilStart=function(t){return Math.ceil((n.roundDateDown(t.startDate)-n.roundDateDown(n.getNowDate()))/n.dayInMilliseconds)};n.orderEvents=function(n,t){var e=n.start,o=t.start,i,r,u,f;if(e<o)return-1;if(e>o)return 1;var s=n.winrt,h=t.winrt,c=s.busyStatus,l=h.busyStatus;return c>l?-1:c<l?1:(i=n.end,r=t.end,i>r)?-1:i<r?1:(u=s.id,f=h.id,u<f)?-1:u>f?1:0};n.getCollection=function(n,t,i){for(var o=[],r,f,e,u=0,s=i.count;u<s;u++)r=i.item(u),r&&(f=r.startDate.getTime(),e=r.endDate.getTime(),f<=t&&e>=n&&o.push({winrt:r,start:f,end:e}));return o}})()