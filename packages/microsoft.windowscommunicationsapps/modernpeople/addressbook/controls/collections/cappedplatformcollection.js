Jx.delayDefine(People,"CappedPlatformCollection",function(){"use strict";var n=window.People,t=Microsoft.WindowsLive.Platform;n.CappedPlatformCollection=function(t,i){Jx.initEvents(this);this._realCollection=new n.PlatformCollectionWatcher(t,new n.Callback(this._collectionChanged,this));this._cappedCount=i};Object.defineProperty(n.CappedPlatformCollection.prototype,"count",{get:function(){return Math.min(this._cappedCount,this._realCollection.getCount())}});n.CappedPlatformCollection.prototype.unlock=function(){this._realCollection._collection.unlock()};n.CappedPlatformCollection.prototype.item=function(n){var t;return n<this._cappedCount&&(t=this._realCollection.item(n)),t};n.CappedPlatformCollection.prototype.addEventListener=function(n,t,i){Jx.addListener(this,n,t,i)};n.CappedPlatformCollection.prototype.removeEventListener=function(n,t,i){Jx.removeListener(this,n,t,i)};n.CappedPlatformCollection.prototype.dispose=function(){this._realCollection.dispose();this._realCollection=null};n.CappedPlatformCollection.prototype._collectionChanged=function(n,i){switch(i.eType){case t.CollectionChangeType.itemAdded:i.index<this._cappedCount&&(this._realCollection.getCount()>this._cappedCount&&this._simulateRemoval(n,this._cappedCount-1),this._fireCollectionChangeEvent(n,i));break;case t.CollectionChangeType.itemRemoved:if(i.index<this._cappedCount){var r=this._realCollection.getCount();this._fireCollectionChangeEvent(n,i);r>=this._cappedCount&&this._simulateAddition(n,this._cappedCount-1)}break;case t.CollectionChangeType.itemChanged:(i.index<this._cappedCount||i.previousIndex<this._cappedCount)&&(i.previousIndex>=this._cappedCount?(this._simulateRemoval(n,this._cappedCount-1),this._simulateAddition(n,i.index)):i.index>=this._cappedCount?(this._simulateRemoval(n,i.previousIndex),this._simulateAddition(n,this._cappedCount-1)):this._fireCollectionChangeEvent(n,i));break;case t.CollectionChangeType.reset:this._fireCollectionChangeEvent(n,i)}};n.CappedPlatformCollection.prototype._simulateAddition=function(n,i){var r={eType:t.CollectionChangeType.itemAdded,index:i,previousIndex:-1,objectId:this._realCollection.item(i).objectId};this._fireCollectionChangeEvent(n,r)};n.CappedPlatformCollection.prototype._simulateRemoval=function(n,i){var r={eType:t.CollectionChangeType.itemRemoved,index:i,previousIndex:-1,objectId:this._realCollection.item(i).objectId};this._fireCollectionChangeEvent(n,r)};n.CappedPlatformCollection.prototype._fireCollectionChangeEvent=function(n,t){Jx.raiseEvent(this,"collectionchanged",{target:n,detail:[t]})}})