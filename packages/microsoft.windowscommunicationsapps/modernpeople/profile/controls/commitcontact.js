Jx.delayDefine(People,"CommitContact",function(){var t=window.People,n=t.CommitContact=function(n,t,i,r){this._personListener=null;this._contactListener=null;this._callback=i;this._context=r;this._contact=n;this._person=t;this._timeout=setTimeout(this._onTimeout.bind(this),5e3);try{t&&!n.person?(t.addEventListener("changed",this._personListener=this._onPersonChanged.bind(this)),t.commitAndLink(n)):(n.addEventListener("changed",this._contactListener=this._onContactChanged.bind(this)),n.commit(),n.person&&this._onComplete())}catch(u){Jx.log.exception("Error committing contact",u);this._onComplete()}};n.prototype={_onPersonChanged:function(n){Array.prototype.indexOf.call(n,"manualLinkCompleted")!==-1&&this._onComplete()},_onContactChanged:function(){this._contact.person!==null&&this._onComplete()},_onTimeout:function(){this._onComplete()},_onComplete:function(){var n=this._callback,t=this._context,i=this._contact?this._contact.person:null;this.dispose();n&&n.call(t,i)},dispose:function(){var n,r,t,u,i;this._callback=null;this._context=null;n=this._contactListener;this._contactListener=null;r=this._contact;this._contact=null;t=this._personListener;this._personListener=null;u=this._person;this._person=null;i=this._timeout;this._timeout=0;i&&clearTimeout(i);try{t&&u.removeEventListener("changed",t);n&&r.removeEventListener("changed",n)}catch(f){Jx.log.exception("Error removing event listener",f)}}};n.canCreateContacts=function(n){var t,i;t=false;try{i=n.getResourceByType(Microsoft.WindowsLive.Platform.ResourceType.contacts);i!==null&&i.isEnabled&&(t=true)}catch(r){Jx.log.exception("Error finding account resource",r)}return t}})