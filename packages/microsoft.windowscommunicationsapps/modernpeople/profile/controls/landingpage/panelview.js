Jx.delayDefine(People,"PanelView",function(){function i(n){n.id||(n.id="panel"+String(Jx.uid()));var t=Number(n.position);return t===Number.NEGATIVE_INFINITY?t=1:t===Number.POSITIVE_INFINITY?t=1e3:t+=2,"<div class='panelView-panel "+(n.className||"")+"' id='"+n.id+"' style='-ms-grid-column:"+String(t)+"'>"+n.getUI()+"<\/div>"}function r(n){n.activateUI(document.getElementById(n.id));n.needsReady=true}function u(n){this.position=n}var t=window.People,n=t.PanelView=function(n,t,i,r,f,e,o){this._host=n;this._person=i;this._fields=r;this._panelProviders=o;this._panels=[new u(Number.POSITIVE_INFINITY)];this._jobSet=t;this._element=null;this._viewport=null;this._hydrationData=f||e;this.initComponent()};Jx.inherit(n,Jx.Component);n.prototype.getUI=function(n){this._panelProviders.forEach(function(n){n.load(this,this._person,this._fields,this._hydrationData)},this);n.html="<div id='"+this._id+"' class='panelView-viewport'><div class='panelView-canvas'>"+this._panels.map(i).join("")+"<\/div><\/div>"};n.prototype.activateUI=function(){var f=this._viewport=document.getElementById(this._id),u,n,i;this._element=f.firstChild;this._panels.forEach(r);this._host.getLayoutState()!==t.Layout.layoutState.snapped&&this._scheduleReady();u=this._hydrationData;u&&(n=u.viewport,Jx.isObject(n)&&(i=this._getScrollProperty(),n[i]&&(f[i]=n[i])))};n.prototype.onEnterComplete=function(){this._scheduleReady()};n.prototype.getPanelElements=function(){return Array.prototype.slice.call(this._element.querySelectorAll(".panelView-panel:not(.panelView-paddingPanel)"))};n.prototype._getScrollProperty=function(){return this._host.getLayoutState()===t.Layout.layoutState.snapped?"scrollTop":"scrollLeft"};n.prototype.prepareSaveBackState=function(){return this.suspend()};n.prototype.suspend=function(){var n={},i=function(t){var i={};t.suspend(i);Jx.mix(n,i)},t,r;return this._panelProviders.forEach(i),this._panels.forEach(i),t=this._getScrollProperty(),r=n.viewport={},r[t]=this._viewport[t],n};n.prototype.scrollToBeginning=function(){var n=this._getScrollProperty();this._viewport[n]=0};n.prototype._onReady=function(){for(var i=this._panels,t,n=0,r=i.length;n<r;++n)if(t=i[n],t.needsReady){t.needsReady=false;t.ready();this._scheduleReady();break}};n.prototype._scheduleReady=function(){this._jobSet.addUIJob(this,this._onReady,null,t.Priority.panel)};n.prototype.addPanel=function(n){for(var t=0,u,f,e;t<this._panels.length&&this._panels[t].position<n.position;)t++;this._panels.splice(t,0,n);this._element&&(u=this._element.children,t<u.length?(f=u[t],e="beforebegin"):(f=this._element,e="beforeend"),f.insertAdjacentHTML(e,i(n)),r(n),this._scheduleReady())};n.prototype.removePanel=function(n){for(var i=false,u,f,t=0,r=this._panels.length;t<r;t++)if(this._panels[t].id===n){u=this._panels.splice(t,1)[0];u.deactivateUI();i=true;break}return i&&this._element!==null&&(f=document.getElementById(n),this._element.removeChild(f)),i};n.prototype.getJobSet=function(){return this._jobSet};n.prototype.getPlatform=function(){return this._host.getPlatform()};n.prototype.getFrameCommands=function(){return this._host.getFrameCommands()};n.prototype.getCommandBar=function(){return this._host.getCommandBar()};n.prototype.getNavBar=function(){return this._host.getNavBar()};n.prototype.getLayout=function(){return this._host.getLayout()};n.prototype.back=function(n){this._host.back(n)};n.prototype.deactivateUI=function(){this._element=null;this._panels&&this._panels.forEach(function(n){n.deactivateUI()});this._panels=[];this._panelProviders&&this._panelProviders.forEach(function(n){n.unload()});Jx.Component.prototype.deactivateUI.call(this)};n.PanelPosition={contactPanel:0,upsellPanel:1,feedPanel:2,notificationsPanel:3,photosPanel:4};u.prototype={className:"panelView-inactivePanel panelView-paddingPanel",getUI:function(){return""},activateUI:function(){},ready:function(){},suspend:function(){},deactivateUI:function(){}}})