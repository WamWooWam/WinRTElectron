Jx.delayDefine(People.Controls,"ContactDeleteFlyout",function(){function r(){function st(){document.body.removeChild(r);s.forEach(function(n){n.shutdownUI()});s=[]}function ht(){var n=e.querySelectorAll("input:checked");o.disabled=n.length===0}function l(n){if(n.canDelete)try{n.deleteObject()}catch(t){Jx.log.exception("Contact deletion failed",t)}}function ct(n){l(n.contact)}function lt(){if(f){if(f.hide(),f=null,u.length===1)l(u[0]);else{var n=e.querySelectorAll("input:checked");Array.prototype.forEach.call(n,ct)}Jx.bici.increment(Microsoft.WindowsLive.Instrumentation.Ids.People.profileDetailsDeleteContact,1)}return false}var r,f,i,c;r=document.createElement("div");r.className="profile-flyout";r.setAttribute("data-win-control","WinJS.UI.Flyout");r.setAttribute("aria-described-by","delete-flyout_dsc");r.innerHTML='<form id="delete-flyout" class="profile-flyout"><p id="delete-flyout-text" class="profile-flyout win-body"><\/p><ul id="delete-flyout-list" class="profile-flyout"><\/ul><ul id="delete-flyout-list-3rdParty" class="profile-flyout"><\/ul><p id="delete-flyout-subText" class="profile-flyout win-body"><\/p><input type="submit" id="delete-flyout-submit"/><span role="note" class="profile-flyout-description" id="delete-flyout_dsc"><\/span><span role="note" class="profile-flyout-description" id="delete-flyout-check_dsc"><\/span><span role="note" class="profile-flyout-description" id="delete-flyout-ic_dsc"><\/span><span role="note" class="profile-flyout-description" id="delete-flyout-submit_dsc"><\/span><\/form>';f=new WinJS.UI.Flyout(r);f.addEventListener("afterhide",st);i=r.querySelector("#delete-flyout");i.onsubmit=lt;var a=i.querySelector("#delete-flyout-text"),e=i.querySelector("#delete-flyout-list"),h=i.querySelector("#delete-flyout-list-3rdParty"),v=i.querySelector("#delete-flyout-subText"),o=i.querySelector("#delete-flyout-submit"),y=i.querySelector("#delete-flyout_dsc"),p=i.querySelector("#delete-flyout-check_dsc"),w=i.querySelector("#delete-flyout-ic_dsc"),b=i.querySelector("#delete-flyout-submit_dsc"),u=[],s=[],k=n.IdentityControl,d=t.BillboardLayout,g={size:40,secondaryContent:t.Networks},nt=Jx.res.getString("/strings/profileDelete_Label_Flyout"),tt=Jx.res.getString("/strings/profileDelete_Label_Checkbox"),it=Jx.res.getString("/strings/profileDelete_Label_IC"),rt=Jx.res.getString("/strings/profileDelete_Label_Submit");r.setAttribute("aria-label",nt);o.setAttribute("aria-label",rt);var ut=Jx.res.getString("/strings/profileDelete_Desc_Flyout"),ft=Jx.res.getString("/strings/profileDelete_Desc_Checkbox"),et=Jx.res.getString("/strings/profileDelete_Desc_IC"),ot=Jx.res.getString("/strings/profileDelete_Desc_Submit");y.innerText=ut;p.innerText=ft;w.innerText=et;b.innerText=ot;c=Jx.res.getString("/strings/profileDelete_Submit");o.type="submit";o.value=c;this.show=function(n,t,c,l){var y,p,w;u=n.linkedContacts.slice();o.disabled=false;Jx.isNullOrUndefined(l)||(y=u.some(function(n){return!n.isGal&&n.objectId!==l.objectId}),y&&(v.innerText=Jx.res.getString("/strings/profileDelete_subText")),u=[l]);e.innerHTML="";h.innerHTML="";u.forEach(function(n){var f,r,t,o,i,c;n.isGal||(f=n.canDelete,r=document.createElement("li"),u.length>1&&(t=document.createElement("input"),t.contact=n,t.type="checkbox",t.role="checkbox",t.setAttribute("aria-described-by","delete-flyout-check_dsc"),t.setAttribute("aria-label",tt),f?(t.defaultChecked=true,t.checked=true):t.disabled=true,r.appendChild(t)),o=new k(n,null,{interactive:false}),i=document.createElement("div"),i.className="profile-flyout-ic",i.role="img",i.setAttribute("aria-described-by","delete-flyout-ic_dsc"),i.setAttribute("aria-label",it),i.innerHTML=o.getUI(d,g),s.push(o),r.appendChild(i),c=f?e:h,c.appendChild(r))});p=e.querySelectorAll("input:checked");Array.prototype.forEach.call(p,function(n){n.addEventListener("click",ht,false)});w=h.hasChildNodes()?"2":"1";a.innerText=Jx.res.getString("/strings/profileDelete_Text"+w);s.forEach(function(n){n.activateUI(i)});document.body.appendChild(r);f.show(t,c)};this.getFlyout=function(){return f}}$include("$(cssResources)/controls-people.css");var n=window.People,i=n.Controls,u=n.Nav,t=n.IdentityElements;i.ContactDeleteFlyout=r})