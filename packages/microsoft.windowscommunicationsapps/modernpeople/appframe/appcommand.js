Jx.delayDefine(People,["AppCommands","Command"],function(){function i(n){var i=true,r;return!!n.commandId&&(!!n.onInvoke||!!n.link||n.type!==t.button)||(r="People.AppCommands.checkCommand: Invalid command! command.commandId="+n.commandId+",command.onInvoke="+String(n.onInvoke)+",command.link="+n.link,Jx.log.error(r),i=false),i}var n=window.People,t;n.Command=function(n,i,r,u,f,e,o,s,h,c,l,a){this.commandId=n;this.name=i;this.tooltip=r;this.iconSymbol=u;this.enabled=f;this.visible=e;this.context=o;this.onInvoke=s;this.link=h?h:null;this.useCustomLayout=c?true:false;this.section=l?"selection":"global";this.beforeShowUpdate=a?a:null;this.formattedName=[];this.formattedTooltip=[];this.isLocked=false;this.number="0";this.type=t.button;this.selected=false;this.flyout=null;this.biciIndex=-1};t=n.Command.Types={button:"button",toggle:"toggle",flyout:"flyout",seperator:"seperator",customFlyout:"customFlyout"};n.Command.prototype.setSelected=function(n){this.selected=n};n.Command.prototype.getSelected=function(){return this.selected};n.Command.prototype.setFlyout=function(n){this.type=t.flyout;this.flyout=n};n.Command.prototype.setCustomFlyout=function(n){this.type=n?t.customFlyout:t.button};n.Command.prototype.setBiciIndex=function(n){n>=0&&(this.biciIndex=n)};n.Command.prototype.getLabel=function(){return this._loadString(this.name,this.formattedName)};n.Command.prototype.getTooltip=function(){var n=this._loadString(this.tooltip,this.formattedTooltip);return Jx.isNonEmptyString(n)||(n=this.getLabel()),n};n.Command.prototype._loadString=function(n,t){var i="";return Jx.isNonEmptyString(n)?i=Jx.res.getString(n):Jx.isArray(t)&&Jx.isNonEmptyString(t[0])&&(i=Jx.res.loadCompoundString.apply(Jx.res,t)),i};n.Command.prototype.setFormattedName=function(){var n=null;arguments.length>0&&Jx.isNonEmptyString(arguments[0])&&(n=Array.prototype.slice.apply(arguments));this.formattedName=n};n.Command.prototype.setFormattedTooltip=function(){var n=null;arguments.length>0&&Jx.isNonEmptyString(arguments[0])&&(n=Array.prototype.slice.apply(arguments));this.formattedTooltip=n};n.Command.prototype.setIsLocked=function(n){this.isLocked=n};n.Command.prototype.update=function(n){var i,t;i=[];for(t in n)!Jx.isFunction(n[t])&&this.hasOwnProperty(t)&&this[t]!==n[t]&&(this[t]=n[t],i.push(t));return i};n.AppCommands=function(){Jx.log.info("People.AppCommands");this._name="People.AppCommands";this._commands=[]};n.AppCommands.prototype.getCommandsLength=function(){return this._commands.length};n.AppCommands.prototype.getCommandByIndex=function(n){var t=null;return n>=0&&n<this._commands.length&&(t=this._commands[n]),t};n.AppCommands.prototype.addCommand=function(n){this.insertCommand(n,this._commands.length)};n.AppCommands.prototype.removeCommand=function(n){this._removeCommand(n.commandId)};n.AppCommands.prototype.insertCommand=function(n,t){return i(n)?this._findCommand(n.commandId)!==-1?(Jx.log.error("People.AppCommands.insertCommand: Failed to add command "+n.commandId+" as the id already exists."),false):(this._commands.splice(t,0,n),Jx.log.info("People.AppCommands.insertCommand: Added command with commandId="+n.commandId),true):false};n.AppCommands.prototype.updateCommand=function(n){var r,u,t;return r=[],u=null,i(n)&&(t=this._findCommand(n.commandId),t!==-1?(r=this._commands[t].update(n),u=this._commands[t]):Jx.log.warning("People.AppCommands.updateCommand: Failed. Didn't find command "+n.commandId)),{props:r,command:u}};n.AppCommands.prototype._removeCommand=function(n){var t=false,i=this._findCommand(n);return i!==-1?(this._commands.splice(i,1),t=true,Jx.log.info("People.AppCommands._removeCommand: Removed command with commandId="+n)):Jx.log.warning("People.AppCommands._removeCommand: Failed. Didn't find command "+n),t};n.AppCommands.prototype.reset=function(){for(var t,n=this._commands.length-1;n>=0;n--)t=this._commands[n],t.isLocked||this._removeCommand(t.commandId)};n.AppCommands.prototype._findCommand=function(n){for(var i=-1,t=0,r=this._commands.length;t<r;t++)if(n===this._commands[t].commandId){i=t;break}return i}})