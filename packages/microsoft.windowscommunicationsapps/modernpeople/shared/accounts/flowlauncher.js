Jx.delayDefine(People.Accounts,"FlowLauncher",function(){var u=window.People,n=u.Accounts,t=Microsoft.WindowsLive.Platform,i=n.FlowLauncher=function(t,i,r,u){n.AccountControlBase.call(this,t,i);this._biciSuffix=r;this._jobSet=u},r;Jx.augment(i,n.AccountControlBase);i.prototype._getBiciSuffix=function(){return this._biciSuffix};i.prototype._launchAddAccount=function(i){var o=this._biciSuffix==="canvas"?u.Bici.EntryPoint.canvas:u.Bici.EntryPoint.accountSettings,s=this._scenario,f=this._platform,r=function(t){var i=new n.AccountDialog(t,n.AccountDialogMode.add,s,f,o);i.show()},e;i.sourceId==="IMAP"?(e=new n.AccountBarricadeDialog(i),e.showChooseAccountTypeDialog(function(n){switch(n){case t.AccountType.easAccountFactory:r(f.accountManager.getAccountBySourceId("EXCH",""));break;case t.AccountType.imapAccountFactory:r(i)}})):r(i)};r=[];r[t.ConfigureType.createConnectedAccount]=function(i,r){i.sourceId!=="ABCH"||this._hasDefaultAccount()?this._launchAddAccount(i,r):n.showCredUIAsync(function(){this._forcePlatformConnectedIdCheckAsync(this._platform)}.bind(this),Jx.fnEmpty,Jx.fnEmpty,t.Result.defaultAccountDoesNotExist)};r[t.ConfigureType.editOnWeb]=function(i,r){this._hasDefaultAccount()?this._launchWebAuthAddFlow(i,r):n.showCredUIAsync(function(){this._forcePlatformConnectedIdCheckAsync(this._platform).then(function(){var n=this._platform.accountManager.defaultAccount.meContact;if(n.cid.value===0)return u.Promises.waitForPropertyChange(n,"cid")}.bind(this)).then(function(){this._launchWebAuthAddFlow(i,r)}.bind(this))}.bind(this),Jx.fnEmpty,Jx.fnEmpty,t.Result.defaultAccountDoesNotExist)};r[t.ConfigureType.editOnClient]=function(t){n.showAccountSettingsPage(this._platform,this._scenario,n.AccountSettingsPage.perAccountSettings,{launchedFromApp:true,account:t,jobSet:this._jobSet})};i.prototype.launchManageFlow=function(n,t){var i=r[n.getConfigureType(this._scenario)];i&&i.call(this,n,t)};i.prototype.launchManageFlowByObjectId=function(n,t){try{var i=this._platform.accountManager.loadAccount(n);i!==null&&this.launchManageFlow(i,t)}catch(r){Jx.log.exception("FlowLauncher.prototype.launchManageFlowByObjectId failed",r)}}})