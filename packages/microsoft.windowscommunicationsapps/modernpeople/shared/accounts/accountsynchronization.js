Jx.delayDefine(People.Accounts,"AccountSynchronization",function(){var n=People.Accounts;n.AccountSynchronization=function(n){if(this._settings=Jx.appData.localSettings().container("People"),this._callback=null,this._context=null,this._ready=this._settings.get("AccountSyncComplete"),!this._ready){var t=n.accountManager.defaultAccount.getResourceByType(Microsoft.WindowsLive.Platform.ResourceType.accounts);t.isInitialSyncFinished?(this._ready=true,this._settings.set("AccountSyncComplete",true)):(this._ready=false,this._listener=this._onResourceChange.bind(this),t.addEventListener("changed",this._listener),this._resource=t)}};Jx.augment(n.AccountSynchronization,Jx.Events);n.AccountSynchronization.prototype.areAccountsAvailable=function(n,t){return!this._ready&&n&&(this._callback=n,this._context=t?t:null),this._ready};n.AccountSynchronization.prototype.dispose=function(){this._unhook();this._callback=null;this._context=null;Jx.dispose(this._settings)};n.AccountSynchronization.prototype._onResourceChange=function(n){Array.prototype.indexOf.call(n,"isInitialSyncFinished")!==-1&&this._resource.isInitialSyncFinished&&(this._settings.set("AccountSyncComplete",true),this._ready=true,this._callback&&(this._callback.call(this._context),this._callback=null,this._context=null),this.raiseEvent("accountsAvailable"),this._unhook())};n.AccountSynchronization.prototype._unhook=function(){this._listener&&(this._resource.removeEventListener("changed",this._listener),this._listener=null);this._resource=null}})