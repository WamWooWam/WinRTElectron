Jx.delayDefine(People,["Contact","Compare"],function(){function n(n,t){var u="ABCH",r,i,f,e;return(n&&n.account&&(u=n.account.sourceId||u),r=a[u],r||(r=a._WLCOMM),i=r[t],i||(i=r.defaultLength),!i)?null:(f=n?n[t]:null,f&&(e=f.length,e>i))?e:i}function v(n,t,i){var r,u,f,e;for(r in t)if(t[r].fieldList||(t[r].fieldList=[]),u=i[r],u)t[r].fieldList=u;else for(f in n)e=n[f].group,r===e&&t[e].fieldList.push(f)}function y(n){return n==="SKYPE"||n==="TWITR"}function b(n,t){var i="";return y(t)&&(i=n.nickname,t==="TWITR"&&Jx.isNonEmptyString(i)&&i.charAt(0)!=="@"&&(i="@"+i)),i}function k(n,t){return y(t)?"":n.nickname}function d(n,t){return Jx.isNullOrUndefined(t)||t===""||n==="mapLocation"&&!i.Location.isValid(t)}function p(n){return n.toLowerCase().replace(/[\s\(\)\-.]/g,"")}function g(n,t){var i=u.different,r=p(n),f=p(t),e,o;return r===f?(e=n.length,o=t.length,i=e===o?u.equal:e>o?u.superset:u.subset):r.indexOf(f)!==-1?i=u.superset:f.indexOf(r)!==-1&&(i=u.subset),i}function nt(n,t,r){var f=u.different;switch(n){case"mapLocation":f=i.Location.compare(t,r);break;case"tel":f=g(t,r);break;default:(t===r||Jx.isString(t)&&Jx.isString(r)&&t.toLowerCase()===r.toLowerCase())&&(f=u.equal)}return f}function tt(n,t,i,r,f,e){for(var c=false,s,h,o=0;o<n.length;o++)if(s=n[o],s.fieldName===t||Jx.isDefined(r.dedupetype)&&s.fieldType.dedupetype===r.dedupetype||e){if(h=nt(r.type,i,s.fieldValue),h===u.subset){c=true;break}if(h===u.equal){s.fieldNetwork.indexOf(f)===-1&&s.fieldNetwork.push(f);c=true;break}h===u.superset&&(n.splice(o,1),o--)}c||n.push({fieldName:t,fieldValue:i,fieldType:r,fieldNetwork:[f],hasDisplayed:false})}var i=window.People,t=i.Contact={},r=null,f=null,u=i.Compare={subset:-1,equal:0,superset:1,different:2},w,o,s,e,h,c;t._formValidator=function(n,t){var u,o;return i.UiForm.isEmptyString(t.firstName)&&i.UiForm.isEmptyString(t.lastName)&&i.UiForm.isEmptyString(t.companyName)&&i.UiForm.isEmptyString(t.personalEmailAddress)&&i.UiForm.isEmptyString(t.businessEmailAddress)&&i.UiForm.isEmptyString(t.otherEmailAddress)?(n.setFormError(Jx.res.getString("/strings/profile_formValidator_missingFieldsHeader"),Jx.res.getString("/strings/profile_formValidator_missingFields")),u=e[r.locale],u||(u=e.firstLast,f.IsFirstLast()||(u=e.lastFirst)),o=u.name[0],n.setInputFocus(o),false):true};w=function(n){for(var i,t=0;t<n.length;t++)if(i=n[t].mainMri,i!==null&&i!=="")return i;return""};o={firstLast:{name:["firstName","lastName","yomiFirstName","yomiLastName","middleName","title","suffix"]},lastFirst:{name:["lastName","firstName","yomiLastName","yomiFirstName","middleName","title","suffix"]}};t.viewFieldList={firstName:{group:"name",mustEdit:true},lastName:{group:"name",mustEdit:true},yomiFirstName:{group:"name"},yomiLastName:{group:"name"},middleName:{group:"name"},username:{group:"otherInfo"},nickname:{group:"otherInfo"},title:{group:"name"},suffix:{group:"name"},windowsLiveEmailAddress:{group:"email",type:"email",dedupetype:"email",canEdit:false},personalEmailAddress:{group:"email",type:"email",dedupetype:"email"},yahooEmailAddress:{group:"email",type:"email",dedupetype:"email",locId:"fieldTitle_personalEmailAddress"},businessEmailAddress:{group:"email",type:"email",dedupetype:"email"},otherEmailAddress:{group:"email",type:"email",dedupetype:"email"},federatedEmailAddress:{group:"email",type:"email",dedupetype:"email",locId:"fieldTitle_otherEmailAddress"},mobilePhoneNumber:{group:"phone",type:"tel",dedupetype:"mobiletel"},mobile2PhoneNumber:{group:"phone",type:"tel",dedupetype:"mobiletel"},homePhoneNumber:{group:"phone",type:"tel",dedupetype:"hometel"},home2PhoneNumber:{group:"phone",type:"tel",dedupetype:"hometel"},businessPhoneNumber:{group:"phone",type:"tel",dedupetype:"worktel"},business2PhoneNumber:{group:"phone",type:"tel",dedupetype:"worktel"},pagerNumber:{group:"phone",type:"number",active:false},businessFaxNumber:{group:"phone",type:"number",active:false},homeFaxNumber:{group:"phone",type:"number",active:false},homeLocation:{group:"location",type:"mapLocation"},businessLocation:{group:"location",type:"mapLocation"},otherLocation:{group:"location",type:"mapLocation"},significantOther:{group:"otherInfo",active:false},companyName:{group:"otherInfo",active:false},yomiCompanyName:{group:"otherInfo",active:false},jobTitle:{group:"otherInfo",active:false},officeLocation:{group:"otherInfo",active:false},webSite:{group:"otherInfo",type:"url"},notes:{group:"otherInfo",active:false,lines:3}};s={name:{multiple:true,disallowFieldTypeChange:true,canView:false},email:{multiple:true},phone:{multiple:true},location:{multiple:true,showFirstFieldOnGroupEmpty:false},otherInfo:{multiple:true,showFirstFieldOnGroupEmpty:false,disallowFieldTypeChange:true}};t._viewGroupList=null;t.getViewGroupList=function(){if(t._viewGroupList)return t._viewGroupList;r||(r=new i.LocaleHelper);f||(f=new i.NameHelper(r));var n=o[r.locale];return n||(n=o.firstLast,f.IsFirstLast()||(n=o.lastFirst)),v(t.viewFieldList,s,n),t._viewGroupList=s,s};var l={firstName:40,yomiFirstName:40,middleName:40,lastName:40,yomiLastName:40,companyName:40,yomiCompanyName:40,nickname:40,title:40,suffix:40,personalEmailAddress:321,businessEmailAddress:321,otherEmailAddress:321,mobilePhoneNumber:50,mobile2PhoneNumber:50,homePhoneNumber:50,home2PhoneNumber:50,businessPhoneNumber:50,business2PhoneNumber:50,pagerNumber:50,businessFaxNumber:50,homeFaxNumber:50,"homeLocation-street":64,"homeLocation-city":64,"homeLocation-state":64,"homeLocation-zipCode":64,"homeLocation-country":64,"businessLocation-street":64,"businessLocation-city":64,"businessLocation-state":64,"businessLocation-zipCode":64,"businessLocation-country":64,"otherLocation-street":64,"otherLocation-city":64,"otherLocation-state":64,"otherLocation-zipCode":64,"otherLocation-country":64,jobTitle:1024,significantOther:1024,notes:1024,webSite:2048,defaultLength:4096},a={WL:l,ABCH:l,_WLCOMM:{notes:65535,defaultLength:4096}};e={firstLast:{name:["firstName","lastName","middleName","companyName","nickname","title","suffix","yomiFirstName","yomiLastName","yomiCompanyName"]},lastFirst:{name:["lastName","firstName","middleName","companyName","nickname","title","suffix","yomiLastName","yomiFirstName","yomiCompanyName"]},"ja-JP":{name:["lastName","firstName","yomiLastName","yomiFirstName","companyName","yomiCompanyName","nickname","title","suffix","middleName"]}};h=function(){return r||(r=new i.LocaleHelper),r.region==="JP"};t.editFieldList={firstName:{group:"name",mustEdit:true,maxLength:n},yomiFirstName:{group:"name",mustEdit:h,maxLength:n},middleName:{group:"name",maxLength:n},lastName:{group:"name",mustEdit:true,maxLength:n},yomiLastName:{group:"name",mustEdit:h,maxLength:n},companyName:{group:"name",mustEdit:true,maxLength:n},yomiCompanyName:{group:"name",mustEdit:h,maxLength:n},nickname:{group:"name",maxLength:n},title:{group:"name",maxLength:n},suffix:{group:"name",maxLength:n},personalEmailAddress:{group:"email",type:"email",maxLength:n},businessEmailAddress:{group:"email",type:"email",maxLength:n},otherEmailAddress:{group:"email",type:"email",maxLength:n},mobilePhoneNumber:{group:"phone",type:"tel",maxLength:n},mobile2PhoneNumber:{group:"phone",type:"tel",maxLength:n},homePhoneNumber:{group:"phone",type:"tel",maxLength:n},home2PhoneNumber:{group:"phone",type:"tel",maxLength:n},businessPhoneNumber:{group:"phone",type:"tel",maxLength:n},business2PhoneNumber:{group:"phone",type:"tel",maxLength:n},pagerNumber:{group:"phone",type:"tel",maxLength:n},businessFaxNumber:{group:"phone",type:"tel",maxLength:n},homeFaxNumber:{group:"phone",type:"tel",maxLength:n},homeLocation:{group:"location",type:"mapLocation",maxLength:n},businessLocation:{group:"location",type:"mapLocation",maxLength:n},otherLocation:{group:"location",type:"mapLocation",maxLength:n},jobTitle:{group:"otherInfo",maxLength:n},significantOther:{group:"otherInfo",maxLength:n},webSite:{group:"otherInfo",type:"url",htmlType:"text",maxLength:n},notes:{group:"otherInfo",lines:11,maxLength:n}};c={name:{multiple:true,disallowFieldTypeChange:true,canView:false},email:{multiple:true},phone:{multiple:true},location:{multiple:true,showFirstFieldOnGroupEmpty:false},otherInfo:{multiple:true,showFirstFieldOnGroupEmpty:false,disallowFieldTypeChange:true}};t._editGroupList=null;t.getEditGroupList=function(){if(t._editGroupList)return t._editGroupList;r||(r=new i.LocaleHelper);f||(f=new i.NameHelper(r));var n=e[r.locale];return n||(n=e.firstLast,f.IsFirstLast()||(n=e.lastFirst)),v(t.editFieldList,c,n),t._editGroupList=c,c};t.getFieldValue=function(n,t,i){return t==="username"?b(n,i):t==="nickname"?k(n,i):n[t]};t.createUniqueFields=function(n,i){var c,u=[],f,l,w,b,a,nt,e,o,v,s,h,r,g,y,p;if(i){c=true;for(f in t.viewFieldList)(t.viewFieldList[f].type===i||t.viewFieldList[f].dedupetype===i)&&u.push(f)}else{c=false;l=t.getViewGroupList();for(w in l)b=l[w],u.push.apply(u,b.fieldList)}for(a=[],nt=[],e=0;e<u.length;e++)for(o=u[e],v=t.viewFieldList[o],s=0;s<n.length;s++){h=n[s];r=null;try{r=h.account}catch(k){if(k.number!==-2067070973)throw k}(g=r?r.sourceId:"",y=t.getFieldValue(h,o,g),d(v.type,y))||(p="",r!==undefined&&r!==null&&(p=h.canEdit&&r.isDefault?Jx.res.getString("/strings/profile_fieldAttribution_addedByYou"):r.displayName),tt(a,o,y,v,p,c))}return a}})