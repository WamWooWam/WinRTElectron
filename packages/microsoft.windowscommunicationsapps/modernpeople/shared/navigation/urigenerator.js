Jx.delayDefine(People,"Nav",function(){var t=window.People,n=window.People.Nav={},i;n.useMockPages=false;i=n.Scenes;n.Pages={allcontacts:{id:"allcontacts",control:"allcontactsctrl",requirePerson:false,requireMe:false,showMessageBar:true,showConnectedTo:true},createcontact:{id:"createcontact",control:"addprofile",requirePerson:false,requireMe:false,blockNavbar:true,stickyAppbar:true,isEdit:true},editmepicture:{id:"editmepicture",control:"editmepicture",requirePerson:true,requireMe:true,blockNavbar:true,stickyAppbar:true,showMessageBar:true,isEdit:true},editprofile:{id:"editprofile",control:"editprofile",requirePerson:true,requireMe:false,blockNavbar:true,stickyAppbar:true,isEdit:true},galsearchresults:{id:"galsearchresults",control:"galsearchresults",requirePerson:false,requireMe:false,showMessageBar:true},linkperson:{id:"linkperson",control:"link",requirePerson:true,requireMe:false,blockNavbar:true,stickyAppbar:true,showMessageBar:true,isEdit:true},notification:{id:"notification",control:"notification",requirePerson:false,requireMe:false,showMessageBar:true},viewab:{id:"viewab",control:"ab",requirePerson:false,requireMe:false,showMessageBar:true,showConnectedTo:true},viewme:{id:"viewme",control:"landing",requirePerson:true,requireMe:true,showConnectedTo:true},viewmephoto:{id:"viewmephoto",control:"photo",requirePerson:true,requireMe:true},viewmeprofile:{id:"viewmeprofile",control:"viewmeprofile",requirePerson:true,requireMe:true,showConnectedTo:true},viewmera:{id:"viewmera",control:"ra",requirePerson:true,requireMe:true,showMessageBar:true},viewperson:{id:"viewperson",control:"landing",requirePerson:true,requireMe:false,showMessageBar:true,isEdit:false},viewphoto:{id:"viewphoto",control:"photo",requirePerson:true,requireMe:false,showMessageBar:true},viewprofile:{id:"viewprofile",control:"profile",requirePerson:true,requireMe:false,showMessageBar:true},viewra:{id:"viewra",control:"ra",requirePerson:true,requireMe:false,showMessageBar:true},viewraitem:{id:"viewraitem",control:"raitem",requirePerson:true,requireMe:false,showMessageBar:true},whatsnew:{id:"whatsnew",control:"whatsnew",requirePerson:false,requireMe:false,showMessageBar:true,showConnectedTo:true}};n.navigate=function(i){var f,u,e,r;if(i[0]==="#")n._navigateAsync(i);else try{f=new Windows.Foundation.Uri(i);u=t.Protocol.fromUri(f);u.verb==="sms"||u.verb==="tel"||u.contact.sourceId==="SKYPE"?(r=new Windows.System.LauncherOptions,r.preferredApplicationDisplayName="Skype",r.preferredApplicationPackageFamilyName="Microsoft.SkypeApp_kzf8qxf38zg5c",Windows.System.Launcher.launchUriAsync(f,r).done()):(u.verb==="profile"||u.verb==="message")&&u.contact.sourceId==="FB"?(e=Jx.root._platformCache._platform.accountManager.getAccountBySourceId("FB",""),r=new Windows.System.LauncherOptions,r.preferredApplicationDisplayName=e&&!Jx.isNullOrUndefined(e.displayName)?e.displayName:"Facebook",r.preferredApplicationPackageFamilyName="Facebook.Facebook_e4jwt0ac4m2g0",Windows.System.Launcher.launchUriAsync(f,r).done()):Windows.System.Launcher.launchUriAsync(f).done()}catch(o){Jx.log.exception("bad URI: ",o);t.inPeopleApp&&n._navigateAsync("#")}};n._navigateAsync=function(n){Jx.root.go(Jx.parseHash(n.slice(1)))};n.back=function(){Jx.root.back()};n.canGoBack=function(){return Jx.root.canGoBack()};n.backAsync=function(){msSetImmediate(function(){Jx.root.back()})};n.getUri=function(n,i,r,u){r=Jx.isNullOrUndefined(r)?"":escape(JSON.stringify(r));var f=null;return t.inPeopleApp?(f="#page="+escape(n)+"&id="+escape(i||"")+"&data="+r,Jx.isNullOrUndefined(u)||(f+="&verb="+escape(u))):(f="wlpeople:"+escape(n)+","+escape(i||"")+","+r,Jx.isNullOrUndefined(u)||(f+=","+escape(u))),f};n.getViewAddressBookUri=function(t){return n.getUri(n.Pages.viewab.id,"",t)};n.getProfileDetailUri=function(t,i){return n.getUri(n.Pages.viewprofile.id,t,i)};n.getEditProfileDetailUri=function(t,i){return n.getUri(n.Pages.editprofile.id,t,i)};n.getCreateContactUri=function(t){return n.getUri(n.Pages.createcontact.id,"",t)};n.getMeUri=function(t){return n.getUri(n.Pages.viewme.id,"",t)};n.getMePhotoUri=function(t){return n.getUri(n.Pages.viewmephoto.id,"",t)};n.getMeProfileUri=function(t){return n.getUri(n.Pages.viewmeprofile.id,"",t)};n.getMeRAUri=function(t){return n.getUri(n.Pages.viewmera.id,"",t)};n.getEditMePictureUri=function(t){return n.getUri(n.Pages.editmepicture.id,"",t)};n.getViewRAUri=function(t,i){return n.getUri(n.Pages.viewra.id,t,i)};n.getViewPhotoUri=function(t,i){return n.getUri(n.Pages.viewphoto.id,t,i)};n.getRASelfpageUri=function(t,i){return n.getUri(n.Pages.viewraitem.id,t,i)};n.getWhatsNewUri=function(t){return n.getUri(n.Pages.whatsnew.id,"",t)};n.getNotificationUri=function(t){return n.getUri(n.Pages.notification.id,"",t)};n.getAllContactsUri=function(t){return n.getUri(n.Pages.allcontacts.id,"",t)};n.getAllContactsSearchUri=function(i,r){return t.inPeopleApp?"#page="+n.Pages.allcontacts.id+"&query="+escape(i)+'&data="'+escape(r)+'"':"wlpeople:"+n.Pages.allcontacts.id+","+escape(i)+","+escape(r)};n.getGALSearchUri=function(i,r){return t.inPeopleApp?"#page="+n.Pages.galsearchresults.id+"&query="+escape(i)+'&data="'+escape(r)+'"':"wlpeople:"+n.Pages.galsearchresults.id+","+escape(i)+","+escape(r)};n.getLinkPersonUri=function(t,i){return n.getUri(n.Pages.linkperson.id,t,i)};n.getViewPersonUri=function(t,i,r){return n.getUri(n.Pages.viewperson.id,t,i,r)};n.getViewRecipientUri=function(t,i){var r=t.person;return r&&r.isInAddressBook?r.objectType==="MeContact"?n.getMeUri():n.getViewPersonUri(r.objectId):n.getViewPersonUri("",{objectType:"literal",name:t.calculatedUIName,email:t.emailAddress,accountId:i?i.objectId:null})};n.convertProtocolPathToHash=function(t){var o,s,u;var h=t.replace(/\s*$/,""),f=/([^,]*)(?:,([^,]*)(?:,(.*))?)?/g.exec(h),i=f?f.slice(1):[],r=unescape(i[0]||"").toLowerCase(),e=null;if(r in n.Pages&&(o=n.Pages[r].requirePerson||r===n.Pages.allcontacts.id,s=o&&i[1]?unescape(i[1]):"",(r!==n.Pages.allcontacts.id||!(i.length>2))&&r!==n.Pages.galsearchresults.id)){if(u=null,i[2])try{u=JSON.parse(unescape(i[2]))}catch(c){Jx.log.exception("People.Navigate.convertUriToHash: JSON.parse failed.",c);Jx.log.info("failed token: '"+i[2]+"'.")}e=n.getUri(r,s,u)}return e};n.setPageLastScrollPosition=function(t,i){try{window.localStorage.setItem(t,i)}catch(r){Jx.log.write(2,"Failed to save state to local storage: [ "+t+" ]"+r.toString());n.removePageLastScrollPosition(t)}};n.getPageLastScrollPosition=function(n){return parseInt(window.localStorage.getItem(n),0)};n.removePageLastScrollPosition=function(n){window.localStorage.removeItem(n)!==0&&Jx.log.write(2,"Failed to remove old state [ "+n+" ]")};n.inPeopleApp=function(){return t.inPeopleApp||false}})