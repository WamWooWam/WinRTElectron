Jx.delayDefine(People,"ShareSource",function(){var t=window.People,n=t.ShareSource={},i=n.DataRequestedEventArgs=function(n){this.request=n.request};i.prototype.request=null;i.prototype.handled=false;n.sharePersonCallback=function(i,r){var u,s,e,o,f,h;for(r.handled=true,r.request.data.properties.title=i.calculatedUIName,u=i.getUserTile(Microsoft.WindowsLive.Platform.UserTileSize.small,false),Jx.isObject(u)&&Jx.isNonEmptyString(u.appdataURI)&&(s=new Windows.Foundation.Uri(u.appdataURI),r.request.data.properties.thumbnail=Windows.Storage.Streams.RandomAccessStreamReference.createFromUri(s)),e=[],o=i.linkedContacts,f=0,h=o.count;f<h;f++)e.push(o.item(f));var a=t.Contact.createUniqueFields(e,"mapLocation"),v=a.map(function(n){return{value:n.fieldValue}}),c=t.Location.getBestLocation(v),l=c?c.value:null;n.sharePersonAsText(i,l,r.request);n.sharePersonAsHtml(i,l,r.request)};n.sharePersonAsText=function(n,i,r){var u=n.calculatedUIName+"\n",e,f;Jx.isNonEmptyString(n.mostRelevantEmail)&&(u+=n.mostRelevantEmail+"\n");Jx.isNonEmptyString(n.mostRelevantPhone)&&(u+=n.mostRelevantPhone+"\n");Jx.isObject(i)&&(e=new t.AddressHelper,f=e.formatViewAddressAsString(i),Jx.isNonEmptyString(f)&&(u+=f+"\n"));r.data.setText(u)};n.sharePersonAsHtml=function(n,i,r){var u=document.createElement("body"),f,c,e,o,s,h,l,a;u.innerHTML="<div style='padding: 3px'><div id='userTile' style='display: inline-block; vertical-align: middle; margin-right: 4px;'><img id='userTileImage' src='usertileimage'/><\/div><div style='display: inline-block; vertical-align: middle; line-height: 125%;'><div id='contactName'><\/div><div id='contactEmail'><\/div><div id='contactPhone'><\/div><div id='contactAddress' style='line-height: 100%;'><\/div><\/div><\/div>";f=n.getUserTile(Microsoft.WindowsLive.Platform.UserTileSize.medium,false);Jx.isObject(f)&&Jx.isNonEmptyString(f.appdataURI)?(c=new Windows.Foundation.Uri(f.appdataURI),r.data.resourceMap.usertileimage=Windows.Storage.Streams.RandomAccessStreamReference.createFromUri(c),u.querySelector("#userTileImage").setAttribute("alt",n.calculatedUIName)):u.querySelector("#userTile").removeNode(true);u.querySelector("#contactName").innerText=n.calculatedUIName;e=u.querySelector("#contactEmail");o=Jx.escapeHtml(n.mostRelevantEmail);Jx.isNonEmptyString(n.mostRelevantEmail)?e.innerHTML="<a href='mailto:'"+o+">"+o+"<\/a>":e.removeNode(true);s=u.querySelector("#contactPhone");Jx.isNonEmptyString(n.mostRelevantPhone)?s.innerText=n.mostRelevantPhone:s.removeNode(true);h=u.querySelector("#contactAddress");Jx.isObject(i)?(l=new t.AddressHelper,h.innerHTML=l.formatViewAddressAsHtml(i)):h.removeNode(true);a=Windows.ApplicationModel.DataTransfer.HtmlFormatHelper.createHtmlFormat(u.innerHTML);r.data.setHtmlFormat(a)}})