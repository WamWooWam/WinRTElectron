Jx.delayDefine(People.Social,["loadUtilities","unreadNotifications","populateDemoDataAsync"],function(){var t=window.People,n=t.Social,r=t.RecentActivity,i;n.loadUtilities=Jx.fnEmpty;n.unreadNotifications={isEnabled:function(){return this._isInitialized?this._notifications!==null:Jx.appData.localSettings().container("People").container("Social").get("notificationsEnabled")},getCount:function(){return this._notifications!==null?this._notifications.unreadCount:0},initialize:function(){if(People.loadSocialNotifications(),this._isInitialized=true,!n.disableNotifications){var t=this._capabilities=People.RecentActivity.Platform.SocialCapabilities.meCapabilities;t.addListener("propertychanged",this._onCapabilityPropertyChanged,this);t.canShowNotifications&&this._initializeNotificationsInternal()}Jx.appData.localSettings().container("People").container("Social").set("notificationsEnabled",this.isEnabled());this._raiseChangedEvent()},refreshCount:function(){this._notifications?this._notifications.refreshUnreadCount():this._isRefreshPending=true},_initializeNotificationsInternal:function(){if(!this._notifications){var n=r.Identity.createMeIdentity();this._notifications=n.networks.aggregatedNetwork.notifications;this._notifications.addListener("propertychanged",this._onNotificationsPropertyChanged,this);this._isRefreshPending&&(this._isRefreshPending=false,this.refreshCount())}},_onCapabilityPropertyChanged:function(n){if(n.propertyName==="CanShowNotifications"){var t=n.sender;t.canShowNotifications?(this._initializeNotificationsInternal(),this._raiseChangedEvent()):this._notifications&&(this._notifications.removeListener("propertychanged",this._onNotificationsPropertyChanged,this),this._notifications=null,this._raiseChangedEvent());Jx.appData.localSettings().container("People").container("Social").set("notificationsEnabled",this.isEnabled())}},_onNotificationsPropertyChanged:function(n){n.propertyName==="UnreadCount"&&this._raiseChangedEvent()},_raiseChangedEvent:function(){Jx.raiseEvent(this,"changed",{sender:this})},_isInitialized:false,_isRefreshPending:false,_notifications:null};n.populateDemoDataAsync=function(n,t){return People.loadSocialProviders(),People.RecentActivity.Providers.RetailModeHelper.populateDemoDataAsync(n,t)};i=/\{(\d+)\}/g;n.format=function(n){var t=arguments;return n.replace(i,function(n,i){var r=t[parseInt(i)+1];return Jx.isNullOrUndefined(r)?"":r.toString()})};n.clearKeys=function(n){for(var t in n)delete n[t]};n.Events={removeListenerSafe:function(n,t,i){var u,f,r,e;if(this._jxev&&(u=this._jxev[n],u))for(f=u.listeners,r=f.length;r>=0;r--)if(e=f[r],Boolean(e)&&e.fn===t&&e.obj===i)return u.recursionCount!==0?(f[r]=null,u.isSweepNeeded=true):f.splice(r,1),true;return false}};n.removeListenerSafe=function(t,i,r,u){return n.Events.removeListenerSafe.call(t,i,r,u)}})