//! Copyright (c) Microsoft Corporation. All rights reserved.
Jx.delayDefine(People.RecentActivity.UI.Feed,["FeedPanel","FeedLayout"],function(){People.loadSocialModel();People.loadSocialUICore();People.RecentActivity.UI.Host.LandingPagePanelProvider;$include("$(cssResources)/Social.css");People.RecentActivity.UI.Feed.create_stackingListViewAnimations=function(){var n={};return n.introAnimationsEnabled=true,n.insertAnimationsEnabled=true,n.removeAnimationsEnabled=true,n.fadeInEnabled=true,n.repositionEnabled=true,n};People.RecentActivity.UI.Feed.create_stackingListViewData=function(){var n={};return n.elements=[],n.items=[],n};People.RecentActivity.UI.Feed.StackingListViewOrientation={horizontal:0,vertical:1};People.RecentActivity.UI.Feed.create_stackingListViewPositionState=function(n,t,i,r,u,f,e,o){var s={};return s.c=n,s.r=t,s.s=i,s.w=r,s.z=u,s.o=f,s.p=e,s.i=o,s};People.RecentActivity.UI.Feed.create_stackingListViewSchedulerTask=function(n,t){var i={};return i.action=t,i.priority=n,i};People.RecentActivity.UI.Feed.create_stackingListViewSettings=function(){var n={};return n.animations=People.RecentActivity.UI.Feed.create_stackingListViewAnimations(),n};People.RecentActivity.UI.Feed.StackingListViewStackingState={none:0,stackable:1,unstackable:2};People.RecentActivity.UI.Feed.create_stackingListViewState=function(n,t,i,r,u){var f={};return f.a=n,f.l=u,f.d=i,f.i=r,f.s=t,f};People.RecentActivity.UI.Feed.create_stackingListViewItemState=function(n,t){var i={};return i.i=t,i.l=n,i};People.RecentActivity.UI.Feed.create_stackingListViewMarkupState=function(n,t){var i={};return i.m=t,i.o=n,i};People.RecentActivity.UI.Feed.create_baseEntryState=function(n){var t={};return t.c=n,t};People.RecentActivity.UI.Feed.create_linkEntryState=function(n,t){var i={};return i.i=n,i.s=t,i};People.RecentActivity.UI.Feed.create_photoAlbumEntryImageState=function(n,t,i,r){var u={};return u.h=n,u.w=t,u.x=i,u.y=r,u};People.RecentActivity.UI.Feed.create_photoAlbumEntryState=function(n,t,i){var r={};return r.h=n,r.a=t,r.b=i,r};People.RecentActivity.UI.Feed.create_photoEntryState=function(n,t,i,r,u){var f={};return f.c=n,f.h=i,f.w=t,f.x=r,f.y=u,f};People.RecentActivity.UI.Feed.create_videoEntryState=function(n,t,i){var r={};return r.i=n,r.h=i,r.w=t,r};People.RecentActivity.UI.Feed.create_feedLayoutHydrationData=function(n,t,i){var r={};return r.t=i,r.s=t,r.v=n,r};People.RecentActivity.UI.Feed.SeeMoreStatusPanel=function(n,t){People.RecentActivity.UI.Core.Control.call(this,n);this._feedLayout$1=t;this._listview$1=t.listView};Jx.inherit(People.RecentActivity.UI.Feed.SeeMoreStatusPanel,People.RecentActivity.UI.Core.Control);People.RecentActivity.UI.Feed.SeeMoreStatusPanel.prototype._feedLayout$1=null;People.RecentActivity.UI.Feed.SeeMoreStatusPanel.prototype._listview$1=null;People.RecentActivity.UI.Feed.SeeMoreStatusPanel.prototype._progress$1=null;People.RecentActivity.UI.Feed.SeeMoreStatusPanel.prototype._errorContainer$1=null;People.RecentActivity.UI.Feed.SeeMoreStatusPanel.prototype._errors$1=null;People.RecentActivity.UI.Feed.SeeMoreStatusPanel.prototype.showProgress=function(){this._errorContainer$1.isVisible=false;this._progress$1.isVisible=true};People.RecentActivity.UI.Feed.SeeMoreStatusPanel.prototype.showError=function(n,t){this._errors$1==null&&(this._errors$1=new People.RecentActivity.UI.Core.ErrorMessageControl(this._feedLayout$1.feed.network.identity,People.RecentActivity.UI.Core.ErrorMessageContext.whatsNew,People.RecentActivity.UI.Core.ErrorMessageOperation.read),this._errors$1.render(),this._errorContainer$1.appendControl(this._errors$1));t===People.RecentActivity.UI.Core.ErrorMessageLocation.inline&&(this._progress$1.isVisible=false,this._errorContainer$1.isVisible=true);this._errors$1.location=t;this._errors$1.show(n)};People.RecentActivity.UI.Feed.SeeMoreStatusPanel.prototype.onDisposed=function(){this._feedLayout$1=null;this._listview$1=null;People.RecentActivity.UI.Core.EventManager.events.removeListenerSafe("documentkeydown",this._onKeyDown$1,this);this._errorContainer$1!=null&&(this._errorContainer$1.dispose(),this._errorContainer$1=null);this._errors$1!=null&&(this._errors$1.dispose(),this._errors$1=null);this._progress$1!=null&&(this._progress$1.dispose(),this._progress$1=null);People.RecentActivity.UI.Core.Control.prototype.onDisposed.call(this)};People.RecentActivity.UI.Feed.SeeMoreStatusPanel.prototype.onRendered=function(){People.RecentActivity.UI.Core.EventManager.events.addListener("documentkeydown",this._onKeyDown$1,this);var n=this.element;this._errorContainer$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(n,"seemore-error");this._progress$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(n,"seemore-progress");this._progress$1.label=Jx.res.getString("/strings/raSeeMoreProgressUpdating")};People.RecentActivity.UI.Feed.SeeMoreStatusPanel.prototype._onKeyDown$1=function(n){var t,i,u,r;t=false;i=false;switch(n.keyCode){case WinJS.Utilities.Key.end:this.isVisible?(this.focus(),this._listview$1.activeItemIndex=-1,n.preventDefault()):this._feedLayout$1.canRequestMoreEntries&&this._listview$1.isFullyRendered&&(this.isVisible=true,u=this,People.Animation.fadeIn(this.element).done(function(){return u.isDisposed||u.focus(),null}),this._listview$1.scrollToEnd(),this._listview$1.activeItemIndex=-1,n.preventDefault());break;case WinJS.Utilities.Key.leftArrow:case WinJS.Utilities.Key.upArrow:People.RecentActivity.UI.Core.HtmlHelper.isLeftToRight?i=true:t=true;break;case WinJS.Utilities.Key.rightArrow:case WinJS.Utilities.Key.downArrow:People.RecentActivity.UI.Core.HtmlHelper.isLeftToRight?t=true:i=true}r=this._listview$1.lastItemIndex;r!==-1&&(t?this.isActive?n.preventDefault():this.isVisible&&this._listview$1.activeItemIndex===r&&(this.focus(),this._listview$1.activeItemIndex=-1,n.preventDefault()):i&&this.isActive&&(this._listview$1.activeItemIndex=r,this._listview$1.activeItem.focus(),n.preventDefault()))};People.RecentActivity.UI.Feed.StackingListViewChanges=function(){this._inserts=[];this._removals=[]};People.RecentActivity.UI.Feed.StackingListViewChanges.prototype._inserts=null;People.RecentActivity.UI.Feed.StackingListViewChanges.prototype._insertsProcessed=false;People.RecentActivity.UI.Feed.StackingListViewChanges.prototype._removals=null;People.RecentActivity.UI.Feed.StackingListViewChanges.prototype._removalsProcessed=false;Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewChanges.prototype,"inserts",{get:function(){return this._inserts}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewChanges.prototype,"insertsProcessed",{get:function(){return this._insertsProcessed},set:function(n){this._insertsProcessed=n}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewChanges.prototype,"removals",{get:function(){return this._removals}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewChanges.prototype,"removalsProcessed",{get:function(){return this._removalsProcessed},set:function(n){this._removalsProcessed=n}});People.RecentActivity.UI.Feed.StackingListViewChanges.prototype.dispose=function(){for(var t,n=0;n<this._inserts.length;n++)t=this._inserts[n],t.dispose();for(this._inserts.length=0,n=0;n<this._removals.length;n++)t=this._removals[n],t.dispose();this._removals.length=0},function(){var t=50,i=500,r=500,n=250;People.RecentActivity.UI.Feed.StackingListViewControl=function(n,t){this._timerScroll$1=-1;this._timerBatchRender$1=-1;People.RecentActivity.UI.Core.Control.call(this,n);this._viewport$1=People.RecentActivity.UI.Core.HtmlHelper.createElement(People.RecentActivity.UI.Core.Html.stackingListViewViewport);this.element.children.length>0?this.element.insertBefore(this._viewport$1,this.element.children[0]):this.element.appendChild(this._viewport$1);this._data$1=People.RecentActivity.UI.Feed.create_stackingListViewData();this._settings$1=People.RecentActivity.UI.Feed.create_stackingListViewSettings();this._changes$1=[];this._orientation$1=t;this._stateManager$1=new People.RecentActivity.UI.Feed.StackingListViewStateManager;this._scheduler$1=new People.RecentActivity.UI.Feed.StackingListViewScheduler;this._scheduler$1.addListener("emptied",this._onSchedulerEmptied$1,this);this._initializeLayoutEngine$1();this._updateViewportCssClass$1();this.addClass("ra-listView")};Jx.inherit(People.RecentActivity.UI.Feed.StackingListViewControl,People.RecentActivity.UI.Core.Control);People.RecentActivity.UI.Feed.StackingListViewControl._batchRenderCount$1=People.RecentActivity.Configuration.maxStackableEntries;People.RecentActivity.UI.Feed.StackingListViewControl.prototype._data$1=null;People.RecentActivity.UI.Feed.StackingListViewControl.prototype._scheduler$1=null;People.RecentActivity.UI.Feed.StackingListViewControl.prototype._settings$1=null;People.RecentActivity.UI.Feed.StackingListViewControl.prototype._changes$1=null;People.RecentActivity.UI.Feed.StackingListViewControl.prototype._stateManager$1=null;People.RecentActivity.UI.Feed.StackingListViewControl.prototype._viewport$1=null;People.RecentActivity.UI.Feed.StackingListViewControl.prototype._currentChanges$1=null;People.RecentActivity.UI.Feed.StackingListViewControl.prototype._pendingChanges$1=null;People.RecentActivity.UI.Feed.StackingListViewControl.prototype._editing$1=false;People.RecentActivity.UI.Feed.StackingListViewControl.prototype._initial$1=true;People.RecentActivity.UI.Feed.StackingListViewControl.prototype._orientation$1=0;People.RecentActivity.UI.Feed.StackingListViewControl.prototype._layoutHorizontal$1=null;People.RecentActivity.UI.Feed.StackingListViewControl.prototype._layoutVertical$1=null;People.RecentActivity.UI.Feed.StackingListViewControl.prototype._layout$1=null;People.RecentActivity.UI.Feed.StackingListViewControl.prototype._inputHandler$1=null;People.RecentActivity.UI.Feed.StackingListViewControl.prototype._timerScrollOffset$1=0;People.RecentActivity.UI.Feed.StackingListViewControl.prototype._cachedScrollOffset=-1;Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewControl.prototype,"activeItem",{get:function(){return this._inputHandler$1.activeItem},set:function(n){this._inputHandler$1.activeItem=n}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewControl.prototype,"activeItemIndex",{get:function(){return this._inputHandler$1.activeItemIndex},set:function(n){this._inputHandler$1.activeItemIndex=n}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewControl.prototype,"lastItemIndex",{get:function(){return this._layout$1.lastItemIndex}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewControl.prototype,"count",{get:function(){return this._data$1.items.length}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewControl.prototype,"orientation",{get:function(){return this._orientation$1},set:function(n){this._orientation$1!==n&&(this._orientation$1=n,this._onOrientationUpdated$1())}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewControl.prototype,"scrollPosition",{get:function(){return this._layout$1.viewportOffset},set:function(n){Jx.log.write(4,"StackingListViewControl::ScrollPosition::set: "+n);this._layout$1.viewportOffset=n}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewControl.prototype,"rowHeight",{get:function(){return this._layout$1.rowHeight}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewControl.prototype,"isFullyRendered",{get:function(){for(var t,n=0;n<this._data$1.items.length;n++)if(t=this._data$1.items[n],!t.isRendered||t.orientation!==this._orientation$1)return false;return true}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewControl.prototype,"containsVirtualizedItem",{get:function(){for(var t,n=0;n<this._data$1.items.length;n++)if(t=this._data$1.items[n],t.isReadyForStacking&&!t.isLoaded)return true;return false}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewControl.prototype,"isWithinSeeMoreRange",{get:function(){return this._layout$1.viewportOffset+this._layout$1.viewportSize*2>=this._layout$1.scrollerSize}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewControl.prototype,"batchCount",{get:function(){return Math.ceil(this._data$1.items.length/t)}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewControl.prototype,"scheduler",{get:function(){return this._scheduler$1}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewControl.prototype,"viewport",{get:function(){return this._viewport$1}});People.RecentActivity.UI.Feed.StackingListViewControl.prototype.getFirstItemInView=function(n){return this._layout$1.getFirstItemInView(n)};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.getPreviousItem=function(n){return this._layout$1.getPreviousItem(n)};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.getNextItem=function(n){return this._layout$1.getNextItem(n)};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.scrollToEnd=function(){this._layout$1.scrollToEnd()};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.invalidateStates=function(){this._stateManager$1.invalidate()};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.beginEdits=function(){this._editing$1||(this._editing$1=true,this._pendingChanges$1=new People.RecentActivity.UI.Feed.StackingListViewChanges)};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.endEdits=function(){this._editing$1&&(this._editing$1=false,(this._pendingChanges$1.inserts.length>0||this._pendingChanges$1.removals.length>0)&&(this._changes$1.push(this._pendingChanges$1),this._scheduler$1.schedule(3,this._processChanges$1.bind(this))),this._pendingChanges$1=null)};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.insert=function(n,t){this._pendingChanges$1.inserts.push(n);n.index=t};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.remove=function(n){this._pendingChanges$1.removals.push(n)};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.getState=function(){return this._layout$1.getState()};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.getItemStates=function(n){return this._stateManager$1.setItemState(this._layout$1.getItemState(n)),this._stateManager$1.getItemStates()};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.getMarkupState=function(){return this._stateManager$1.setMarkupState(this._layout$1.getMarkupState()),this._stateManager$1.getMarkupState()};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.setState=function(n){this._stateManager$1.setListViewState(n)};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.setItemStates=function(n){this._stateManager$1.setItemStates(n)};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.setMarkupState=function(n){n.o===this._layout$1.layoutState&&(this._stateManager$1.setMarkupState(n),this._layout$1.initializeFromMarkup())};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.forceLayout=function(){(Windows.UI.ViewManagement.ApplicationView.value!==Windows.UI.ViewManagement.ApplicationViewState.snapped||Windows.UI.ViewManagement.ApplicationView.value===this._layout$1.layoutState)&&(Windows.UI.ViewManagement.ApplicationView.value===Windows.UI.ViewManagement.ApplicationViewState.snapped||this._layout$1.layoutState!==Windows.UI.ViewManagement.ApplicationViewState.snapped)&&this._layout$1.forceLayout()};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.freeze=function(){this._scheduler$1!=null&&this._scheduler$1.freeze();clearTimeout(this._timerBatchRender$1);clearTimeout(this._timerScroll$1);this._timerBatchRender$1=-1;this._timerScroll$1=-1};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.clearTimers=function(){this._timerScroll$1!==-1&&this._scheduler$1.isPaused&&this._scheduler$1.resume();clearTimeout(this._timerBatchRender$1);clearTimeout(this._timerScroll$1);this._timerBatchRender$1=-1;this._timerScroll$1=-1};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.resumeScrollListener=function(){Jx.log.write(4,"StackingListViewControl::ResumeScrollListener()");this.attach("scroll",this._onScroll$1.bind(this))};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.stopScrollListener=function(){Jx.log.write(4,"StackingListViewControl::StopScrollListener()");this.detach("scroll")};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.checkMoreItemsRequested=function(){this.isFullyRendered&&this.isWithinSeeMoreRange&&this._onMoreItemsRequested$1()};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.onDisposed=function(){var t,n,i;for(this._scheduler$1.removeListenerSafe("emptied",this._onSchedulerEmptied$1,this),this._scheduler$1.dispose(),n=0;n<this._data$1.items.length;n++)t=this._data$1.items[n],t.dispose();for(this._data$1.items.length=0,n=0;n<this._changes$1.length;n++)i=this._changes$1[n],i.dispose();this._changes$1.length=0;this._currentChanges$1!=null&&(this._currentChanges$1.dispose(),this._currentChanges$1=null);this._pendingChanges$1!=null&&(this._pendingChanges$1.dispose(),this._pendingChanges$1=null);this._timerScroll$1!==-1&&(clearTimeout(this._timerScroll$1),this._timerScroll$1=-1);this._timerBatchRender$1!==-1&&(clearTimeout(this._timerBatchRender$1),this._timerBatchRender$1=-1);this._layoutHorizontal$1!=null&&(this._layoutHorizontal$1.dispose(),this._layoutHorizontal$1=null);this._layoutVertical$1!=null&&(this._layoutVertical$1.dispose(),this._layoutVertical$1=null);this._inputHandler$1!=null&&(this._inputHandler$1.dispose(),this._inputHandler$1=null);this._layout$1=null;this._viewport$1=null;People.RecentActivity.UI.Core.Control.prototype.onDisposed.call(this)};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.onRendered=function(){People.RecentActivity.UI.Core.Control.prototype.onRendered.call(this);this.attach("scroll",this._onScroll$1.bind(this));this.role="list";this._inputHandler$1=new People.RecentActivity.UI.Feed.StackingListViewInputHandler(this,this._data$1)};People.RecentActivity.UI.Feed.StackingListViewControl.prototype._initializeLayoutEngine$1=function(){var n=null;this._orientation$1?this._orientation$1===1&&(this._layoutVertical$1==null&&(this._layoutVertical$1=new People.RecentActivity.UI.Feed.StackingListViewVerticalLayoutEngine(this,this._data$1,this._settings$1,this._stateManager$1)),n=this._layoutVertical$1):(this._layoutHorizontal$1==null&&(this._layoutHorizontal$1=new People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine(this,this._data$1,this._settings$1,this._stateManager$1)),n=this._layoutHorizontal$1);n!==this._layout$1&&(this._layout$1!=null&&this._layout$1.disown(),Jx.log.write(4,"StackingListViewControl::InitializeLayoutEngine: resetting scroll position to 0..."),this.element.scrollLeft=0,this.element.scrollTop=0,this._layout$1=n,this._layout$1.takeOwnership())};People.RecentActivity.UI.Feed.StackingListViewControl.prototype._updateViewportCssClass$1=function(){this._orientation$1?this._orientation$1===1&&(this.removeClass("ra-listViewHorizontal"),this.addClass("ra-listViewVertical")):(this.removeClass("ra-listViewVertical"),this.addClass("ra-listViewHorizontal"))};People.RecentActivity.UI.Feed.StackingListViewControl.prototype._processChanges$1=function(){this.isDisposed||(this._changes$1.length>0?(this._currentChanges$1=this._changes$1[0],this._changes$1.shift(),this._processCurrentChange$1()):(this.raiseEvent("editscompleted",new People.RecentActivity.EventArgs(this)),this._layout$1.updateAriaAttributes(),this._layout$1.updateScrollPoints(),this._scheduler$1.onCompleted()))};People.RecentActivity.UI.Feed.StackingListViewControl.prototype._processCurrentChange$1=function(){if(!this._currentChanges$1.removalsProcessed&&(this._currentChanges$1.removalsProcessed=true,this._currentChanges$1.removals.length>0)){this._processRemovals$1();return}if(!this._currentChanges$1.insertsProcessed&&(this._currentChanges$1.insertsProcessed=true,this._currentChanges$1.inserts.length>0)){this._processInserts$1();return}this._currentChanges$1=null;this._processChanges$1()};People.RecentActivity.UI.Feed.StackingListViewControl.prototype._processRemovals$1=function(){Jx.log.write(4,"StackingListViewControl::ProcessRemovals()");var n=this._currentChanges$1.removals;this._layout$1.remove(n,this._onUpdateCompleted$1.bind(this));this._inputHandler$1.remove(n)};People.RecentActivity.UI.Feed.StackingListViewControl.prototype._processInserts$1=function(){Jx.log.write(4,"StackingListViewControl::ProcessInserts("+this._initial$1+")");var n=this._currentChanges$1.inserts;this._initial$1?(this._initial$1=false,this._layout$1.initialize(n,this._onUpdateCompleted$1.bind(this))):this._layout$1.add(n,this._onUpdateCompleted$1.bind(this));this._inputHandler$1.add(n)};People.RecentActivity.UI.Feed.StackingListViewControl.prototype._onOrientationUpdated$1=function(){var n=this,t;this._scheduler$1.empty();this.clearTimers();this.stopScrollListener();t=this._layout$1.getFirstItemInView(this._cachedScrollOffset);this._settings$1.animations.fadeInEnabled?(this._viewport$1.style.opacity="0",this._updateViewportCssClass$1(),this._scheduler$1.schedule(1,function(){n._onOrientationUpdatedInternal$1(t);n._viewport$1.style.width="";People.Animation.fadeIn(n._viewport$1).done(function(){return n.isDisposed||(n.resumeScrollListener(),n._scheduler$1.onCompleted()),null})})):(this._updateViewportCssClass$1(),this._onOrientationUpdatedInternal$1(t),this.resumeScrollListener())};People.RecentActivity.UI.Feed.StackingListViewControl.prototype._onOrientationUpdatedInternal$1=function(n){this._initializeLayoutEngine$1();n!=null&&n.orientation===this._orientation$1&&(this._layout$1.viewportOffset=n.column===1&&n.row===1?0:n.offset)};People.RecentActivity.UI.Feed.StackingListViewControl.prototype._onUpdateCompleted$1=function(){this._processCurrentChange$1()};People.RecentActivity.UI.Feed.StackingListViewControl.prototype._onScroll$1=function(){this._timerBatchRender$1!==-1&&(clearTimeout(this._timerBatchRender$1),this._timerBatchRender$1=-1);this._timerScroll$1!==-1&&clearTimeout(this._timerScroll$1);this._timerScrollOffset$1=this._cachedScrollOffset=this._layout$1.viewportOffset;this._timerScroll$1=setTimeout(this._onScrollTimerElapsed$1.bind(this),n);this._scheduler$1.pause()};People.RecentActivity.UI.Feed.StackingListViewControl.prototype._onScrollTimerElapsed$1=function(){var t=this,i=this._layout$1.viewportOffset,r,u;if(i!==this._timerScrollOffset$1){Jx.log.write(3,"StackingListViewControl: Scrolling hasn't stopped yet");this._timerScrollOffset$1=i;this._timerScroll$1=setTimeout(this._onScrollTimerElapsed$1.bind(this),n);return}Jx.log.write(4,"StackingListViewControl::OnScrollTimerElapsed()");this._timerScroll$1=-1;this.checkMoreItemsRequested();r=this._layout$1.viewportSize;u=this._layout$1.scrollerSize;i+r>=u-r/8?(Jx.log.write(4,"StackingListViewControl::OnScrollTimerElapsed::RenderBatch()"),this._scheduler$1.schedule(2,function(){t._layout$1.renderBatch(People.RecentActivity.UI.Feed.StackingListViewControl._batchRenderCount$1,function(){t._scheduler$1.onCompleted()})})):this.containsVirtualizedItem&&(Jx.log.write(4,"StackingListViewControl::OnScrollTimerElapsed::RenderItemsInView()"),this._scheduler$1.schedule(2,function(){t._layout$1.renderItemsInView(t._data$1.items,true,i,false,false,function(){t._scheduler$1.onCompleted()})}));this._scheduler$1.resume()};People.RecentActivity.UI.Feed.StackingListViewControl.prototype._onBatchRenderTimerElapsed$1=function(){var n=this;Jx.log.write(4,"StackingListViewControl::OnBatchRenderTimerElapsed()");this._timerBatchRender$1=-1;this._scheduler$1.isEmpty&&!this._scheduler$1.isPaused&&this._scheduler$1.schedule(4,function(){Jx.log.write(4,"StackingListViewControl::OnBatchRenderTimerElapsed::RenderBatch()");n._layout$1.renderBatch(People.RecentActivity.UI.Feed.StackingListViewControl._batchRenderCount$1,function(t,i){n.isDisposed||((t>=People.RecentActivity.UI.Feed.StackingListViewControl._batchRenderCount$1||i>=People.RecentActivity.UI.Feed.StackingListViewControl._batchRenderCount$1)&&(n._timerBatchRender$1=setTimeout(n._onBatchRenderTimerElapsed$1.bind(n),r)),n._scheduler$1.onCompleted())})})};People.RecentActivity.UI.Feed.StackingListViewControl.prototype._onSchedulerEmptied$1=function(){this._timerBatchRender$1!==-1||this.isFullyRendered||(this._timerBatchRender$1=setTimeout(this._onBatchRenderTimerElapsed$1.bind(this),i))};People.RecentActivity.UI.Feed.StackingListViewControl.prototype._onMoreItemsRequested$1=function(){Jx.log.write(4,"StackingListViewControl::OnMoreItemsRequested()");this.raiseEvent("moreitemsrequested",new People.RecentActivity.EventArgs(this))};People.RecentActivity.UI.Feed.StackingListViewControl.prototype.item=function(n){return this._data$1.items[n]}}();People.RecentActivity.UI.Feed.StackingListViewLayoutEngine=function(n,t,i,r){this._control=n;this._data=t;this._settings=i;this._stateManager=r;this._layoutState=Windows.UI.ViewManagement.ApplicationView.value};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine._removeAriaLabelRegex=new RegExp("aria-label=(['\"]).*?\\1","");People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype._data=null;People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype._settings=null;People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype._stateManager=null;People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype._control=null;People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype._promise=null;People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype._ownership=false;People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype._disposed=false;People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype._updateScrollPointsScheduled=false;People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype._updateAriaAttributesScheduled=false;People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype._layoutState=0;Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype,"element",{get:function(){return this._control.element}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype,"layoutState",{get:function(){return this._layoutState},set:function(n){this._layoutState=n}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype,"control",{get:function(){return this._control}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype,"viewportElement",{get:function(){return this._control.viewport}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype,"elements",{get:function(){return this._data.elements}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype,"items",{get:function(){return this._data.items}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype,"settings",{get:function(){return this._settings}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype,"hasOwnership",{get:function(){return this._ownership}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype,"stateManager",{get:function(){return this._stateManager}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype,"state",{get:function(){return this._stateManager.getListViewState()}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype,"stateItems",{get:function(){return this._stateManager.getItemState(this._layoutState)}});People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.dispose=function(){this._disposed||(this._disposed=true,this.disown(),this._control=null,this.onDisposed())};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.disown=function(){if(this._ownership=false,this._promise!=null){try{this._promise.cancel()}catch(n){}this._promise=null}this.onDisowned()};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.takeOwnership=function(){var i,r,n,f,t;if(!this._ownership&&(this._ownership=true,this.onOwnershipTaken(),i=this._data.items,r=i.length,r>0)){this.repositionItemsWithoutStacking();var e=this._control.orientation,u=this.stateItems,o=People.RecentActivity.Configuration.batchEntryCount,s=e?3*o:o;for(n=0;n<r;n++)f=i[n].itemId,t=i[n],u==null||Jx.isUndefined(u.i[f])?t.positionState=null:(t.isRepositioned=false,t.positionState=u.i[f]),t.orientation=e;this.repositionItems(0,r-1)}};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.forceLayout=function(){var n=this,i,t;People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUIForceLayoutStart);this.onLayoutForced();i=this.viewportElement;i.style.opacity="0";t=this._control.scheduler;Jx.log.write(4,"StackingListViewLayoutEngine::ForceLayout(), window.screen.height="+window.screen.height);t.empty();this._control.clearTimers();this._control.stopScrollListener();t.schedule(1,function(){var r,i,s,u;Jx.log.write(4,"StackingListViewLayoutEngine::ForceLayout::ExecuteScheduledTask()");var f=n.items,e=f.length,o=n.stateItems,h=n.state;for(r=0;r<e;r++)i=f[r],s=i.itemId,o==null||Jx.isUndefined(o.i[s])||(i.isRepositioned=false,i.positionState=o.i[s]),i.resize();n.repositionItems(0,e-1);h!=null&&(u=h.i,u>0&&u<e&&(n.viewportOffset=f[u].offset));People.Animation.fadeIn(n.viewportElement).done(function(){return n._disposed||(n._control.resumeScrollListener(),t.onCompleted()),People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUIForceLayoutStop),null})})};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.add=function(n,t){var s=this,f,v,i,u,r;Jx.log.write(4,"StackingListViewLayoutEngine::Add()");this._sortItemsByIndex(n);var h=this.items,e=this.elements,y=Array.apply(null,e),c=[],l=this.viewportElement,p=this._control.orientation,o=true,a=h.length;for(a||(o=false),f=0,v=n.length;f<v;f++)i=n[f],u=i.index,i.orientation=p,i.owner=this._control,this.loadItem(i),h.splice(u,0,i),r=i.element,Jx.addClass(r,"ra-listViewItem"),e.splice(u,0,r),c.push(r),r.style.display="none",u+1<a?(l.insertBefore(r,e[u+1]),o=false):l.appendChild(r);this._updateItemIndices();window.msSetImmediate(function(){s._isAlive()&&s.executeInsertAnimation(n,c,y,o,t)})};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.initializeFromMarkup=function(){var n=this;Jx.log.write(4,"StackingListViewLayoutEngine::InitializeFromMarkup()");this._control.scheduler.schedule(0,function(){if(!n._isAlive()){n._control.scheduler.onCompleted();return}var t=n.viewportElement;t.innerHTML=n._stateManager.getMarkupState().m;t.style.opacity="0";n.viewportOffset=n._stateManager.getScrollPosition();n._settings.animations.introAnimationsEnabled?window.msSetImmediate(function(){if(!n._isAlive()){n._control.scheduler.onCompleted();return}n._promise=People.Animation.enterContent(n.viewportElement);n._promise.done(function(){return n._settings.animations.introAnimationsEnabled=false,n._control.scheduler.onCompleted(),null})}):n._control.scheduler.onCompleted()})};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.initialize=function(n,t){var h,u,i,c,f;Jx.log.write(4,"StackingListViewLayoutEngine::Initialize()");People.RecentActivity.Core.EtwHelper.writeSimpleEvent(People.RecentActivity.Core.EtwEventName.uiListViewRenderInitialBatchStart);this._sortItemsByIndex(n);var e=this.items,o=this.elements,s=n.length,v=this.viewportElement;for(e.push.apply(e,n),h=this._control.orientation,u=0;u<s;u++)i=n[u],c=i.index,i.owner=this._control,i.orientation=h,this.loadItem(i),f=i.element,Jx.addClass(f,"ra-listViewItem"),o.splice(c,0,f),v.appendChild(f);this.repositionItems(0,s-1);this.onLayoutInitialized();this._updateItemIndices();var l=this._stateManager.getScrollPosition(),r=this.state,a=this.stateItems,y=a==null?0:Object.keys(a.i).length;r!=null&&r.i!==-1&&r.i<=y+2*People.RecentActivity.Configuration.batchEntryCount&&r.i<this.items.length&&l===-1?this.bringItemIntoView(this.items[r.i],t):this.executeEnterContentAnimation(n,o,l,t)};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.remove=function(n,t){var e=this,r,s,i;Jx.log.write(4,"StackingListViewLayoutEngine::Remove()");var u=this.items,f=this.elements,o=[];for(r=0,s=n.length;r<s;r++)i=u.indexOf(n[r]),i!==-1&&(u[i].dispose(),u.splice(i,1),o.push(f[i]),f.splice(i,1));this._updateItemIndices();window.msSetImmediate(function(){e._isAlive()&&e.executeRemoveAnimation(o,f,t)})};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.renderBatch=function(n,t){for(var y=this,a,f,u,e,h,o,v,c=this._data.items,r=[],l=-1,s=-1,i=c[0];i!=null;){if(i.isRendered)break;i=this.getNextItem(i)}for(i==null||!i.index?i==null&&(s=0):(a=this.getPreviousItem(i),l=a.index);i!=null;){if(!i.isRendered||i.orientation!==this._control.orientation)break;i=this.getNextItem(i)}if(i!=null&&(s=i.index),f=0,u=0,l!==-1)for(i=c[l];i!=null&&f<n;)i.isRendered||(this.renderItem(i),f++,r.push(i)),i=this.getPreviousItem(i);if(e=f>0?r[r.length-1]:null,s!==-1)for(i=c[s];i!=null&&u<n;)i.isRendered?i.orientation!==this._control.orientation&&(i.element.style.opacity="0",i.isVisible=true,i.orientation=this._control.orientation,i.isReadyForStacking=true,u++,r.push(i)):(this.renderItem(i),u++,r.push(i)),i=this.getNextItem(i);if(e==null&&u>0&&(e=r[0]),e!=null&&(this.repositionFromBatch(e),this.updateAriaAttributes(),this.updateScrollPoints(),this._control.checkMoreItemsRequested(),this._settings.animations.fadeInEnabled)){for(h=new Array(r.length),o=0,v=h.length;o<v;o++)h[o]=r[o].element;People.Animation.fadeIn(h).done(function(){return y._isAlive()&&t(f,u),null});return}t(0,0)};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.bringItemIntoView=function(n,t){var f=this,r,o;Jx.log.write(4,"StackingListViewLayoutEngine::BringItemIntoView("+n.index+")");var i=this.items,u=this.renderItems(i.slice(0,i.indexOf(n)+1)),e=this._renderItemsInViewInternal(i.slice(i.indexOf(n)+1),n.isStateApplied?n.offset:this.getItemOffset(n));for(r=0;r<e.length;r++)o=e[r],u.push(o.element);if(u.length>0&&(this.repositionItems(0,i.length-1),this.viewportOffset=n.offset,this._settings.animations.fadeInEnabled)){People.Animation.fadeIn(u).done(function(){return f._isAlive()&&f._safeInvokeCallback(t),null});return}this.viewportOffset=n.offset;this._safeInvokeCallback(t)};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.scrollToEnd=function(){this.viewportOffset=this.scrollerSize-this.viewportSize};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.getState=function(){var n=this.getFirstItemInView();return People.RecentActivity.UI.Feed.create_stackingListViewState(this._control.activeItemIndex,this.viewportOffset,n!=null?n.itemId:null,n!=null?n.index:-1,this._layoutState)};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.getItemState=function(n){var u={},f=this._data.items,i=f.length,t,r;for(n&&(i=Math.min(i,People.RecentActivity.Configuration.batchEntryCount)),t=0;t<i;t++)r=f[t],u[r.itemId]=r.positionState;return People.RecentActivity.UI.Feed.create_stackingListViewItemState(this._layoutState,u)};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.getMarkupState=function(){var r=[],u=this._data.items,f,o,i,s,n,c,t;if(u.length>0)for(f=this.viewportOffset,o=this.viewportSize,i=0,s=u.length;i<s;i++)if(n=u[i],n.isElementLoaded){var e=n.element,h=n.offset,l=n.size;h+l<f||h>f+o?(this._control.orientation||n.isRendered&&!n.hasImplicitWidth&&n.widthOverride===-1&&(c=n.size!==0?n.size:n.contentWidthPixels,e.style.width=c+"px"),t=e.outerHTML,t=t.replace(People.RecentActivity.UI.Feed.StackingListViewLayoutEngine._removeAriaLabelRegex,""),t=t.substr(0,t.indexOf(">")+1)+t.substr(t.lastIndexOf("<")),r.push(t)):r.push(e.outerHTML)}return People.RecentActivity.UI.Feed.create_stackingListViewMarkupState(this._layoutState,window.toStaticHTML(r.join("")))};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.updateScrollPoints=function(){var n=this;this._updateScrollPointsScheduled||(this._updateScrollPointsScheduled=true,this._control.scheduler.schedule(6,function(){n._updateScrollPointsScheduled=false;n.onUpdateScrollPoints();n._control.scheduler.onCompleted()}))};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.updateAriaAttributes=function(){var n=this;this._updateAriaAttributesScheduled||(this._updateAriaAttributesScheduled=true,this._control.scheduler.schedule(5,function(){n._updateAriaAttributesScheduled=false;n.onUpdateAriaAttributes();n._control.scheduler.onCompleted()}))};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.renderItemsInView=function(n,t,i,r,u,f){var v=this,s,l,y,a,c,e,o,h;for(n.length&&this._isAlive()||f(0),s=[],n=Array.apply(null,n),l=this.items.length;n.length>0;)if(y=n[0],e=this._renderItemsInViewInternal(n,i),e.length>0){for(o=0,h=e.length;o<h;o++)s.push(e[o].element);u?this.repositionItems(0,l-1):r?(a=this.getFirstItemInSection(y),a!=null?this.repositionItems(a.index,l-1):this.repositionFromBatch(e[0])):this.repositionFromBatch(e[0])}else break;if(c=s.length,c>0){for(e=this._renderItemsInViewNeighbours(n,i),o=0,h=e.length;o<h;o++)s.push(e[o].element);if(e.length!==0&&this.repositionFromBatch(e[0]),this._control.checkMoreItemsRequested(),t&&this._settings.animations.fadeInEnabled){this._promise=People.Animation.fadeIn(s);this._promise.done(function(){return v._promise=null,v._isAlive()&&f(c),null});return}}f(c)};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.onDisposed=function(){};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.onDisowned=function(){this._disposed||(this._stateManager.setListViewState(this.getState()),this._stateManager.setItemState(this.getItemState(false)))};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.onOwnershipTaken=function(){};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.onLayoutForced=function(){};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.repositionLatestBatch=function(){return this.repositionItems((this._control.batchCount-1)*50,this.items.length-1)};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.repositionFromBatch=function(n){var t=n.index,i=Math.floor(t/50);return this.repositionItems(i*50,this.items.length-1)};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.executeEnterContentAnimation=function(n,t,i,r){var u=this;Jx.log.write(4,People.Social.format("StackingListViewLayoutEngine::ExecuteEnterContentAnimation(items:{0}, elements:{1}, offset:{2})",n.length,t.length,i));this.renderItemsInView(n,false,i,false,true,function(){People.RecentActivity.Core.EtwHelper.writeSimpleEvent(People.RecentActivity.Core.EtwEventName.uiListViewRenderInitialBatchStop);People.RecentActivity.Core.EtwHelper.writeSimpleEvent(People.RecentActivity.Core.EtwEventName.uiListViewAnimateInStart);i>0&&u.state!=null&&u.state.a<n.length&&(u.viewportOffset=i,u._control.activeItemIndex=u.state.a);t.length>0&&u.settings.animations.introAnimationsEnabled?(u._promise=People.Animation.enterContent(u.viewportElement),u._promise.done(function(){return People.RecentActivity.Core.EtwHelper.writeSimpleEvent(People.RecentActivity.Core.EtwEventName.uiListViewAnimateInStop),u._promise=null,u._isAlive()&&u._safeInvokeCallback(r),null})):(People.RecentActivity.Core.EtwHelper.writeSimpleEvent(People.RecentActivity.Core.EtwEventName.uiListViewAnimateInStop),u._isAlive()&&u._safeInvokeCallback(r))})};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.executeInsertAnimation=function(n,t,i,r,u){var f=this;if(Jx.log.write(4,People.Social.format("StackingListViewLayoutEngine::ExecuteInsertAnimation(items:{0}, elementsNew:{1}, elementsAffected:{2}, append:{3})",n.length,t.length,i.length,r)),!t.length){this._safeInvokeCallback(u);return}r?this.repositionItems(this.lastItemIndex,this.items.length-1):this.repositionFromBatch(n[0]);this.renderItemsInView(n,true,-1,r,false,function(){f._isAlive()&&f._safeInvokeCallback(u)})};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.executeRemoveAnimation=function(n,t,i){var r=this,f,e,u,o;if(Jx.log.write(4,People.Social.format("StackingListViewLayoutEngine::ExecuteRemoveAnimation(elementsRemoved:{0}, elementsAffected:{1})",n.length,t.length)),f=this.items.length,n.length>0)if(this._stateManager.invalidate(),this.settings.animations.removeAnimationsEnabled){for(e=People.Animation.createDeleteFromListAnimation(n,t),this.repositionItems(0,f-1),u=0,o=n.length;u<o;u++)n[u].style.opacity="0";this._promise=e.execute();this._promise.done(function(){return r._promise=null,r._isAlive()&&(r._removeElements(n),r._safeInvokeCallback(i)),null})}else this._removeElements(n),this.repositionItems(0,f-1),this._safeInvokeCallback(i);else this._safeInvokeCallback(i)};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.renderItems=function(n){var r,u,t,i;if(!n.length||!this._ownership)return[];for(r=[],u=n.length,t=0;t<u;t++)i=n[t],i.isRendered||(this.renderItem(i),r.push(i.element));return r};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.renderItem=function(n){var t,i,r,u;n.isRendered||(n.isStateApplied||(t=this.stateItems,t!=null&&(i=n.itemId,Jx.isUndefined(t.i[i])||(n.positionState=t.i[i]))),n.load(),n.render(),r=n.element,r.id=n.itemId,u=r.style,n.isStateApplied&&n.widthOverride===-1&&(u.width=""),u.display="")};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.loadItem=function(n){if(!n.isElementLoaded){var t=null;this._stateManager.hasMarkupState&&(t=People.RecentActivity.UI.Core.HtmlHelper.findElementById(this.viewportElement,n.itemId));n.loadElement(t)}};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.setViewportStyle=function(n){var t=this.viewportElement.style;t.msGridRows=n===-1?"":"("+100/n+"%)["+n+"]"};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype._isAlive=function(){return!this._disposed&&this._ownership};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype._sortItemsByIndex=function(n){n.sort(function(n,t){return n.index-t.index})};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype._removeElements=function(n){for(var r=this.viewportElement,t=0,i=n.length;t<i;t++)r.removeChild(n[t])};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype._safeInvokeCallback=function(n){n!=null&&n()};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype._updateItemIndices=function(){for(var t=this.items,n=0,i=t.length;n<i;n++)t[n].index=n};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype._renderItemsInViewInternal=function(n,t){var h,c,e,u,i,r;var o=t!==-1?t:this.viewportOffset,s=this.viewportSize+400,l=o+s,v=this.items,f=[],a=n.length;if(t!==-1){for(h=o-s/2,c=o+s,e=0;e<n.length;e++)i=n[e],i.isRendered||(r=i.isStateApplied?i.offset:this.getItemOffset(i),r>=h&&r<=c&&(this.renderItem(i),f.push(i)));return f}for(u=0;u<a;u++){if(i=n[u],!i.isRendered&&(r=i.isStateApplied?i.offset:this.getItemOffset(i),r<=l)){this.renderItem(i);f.push(i);continue}break}return n.splice(0,u),f};People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype._renderItemsInViewNeighbours=function(n,t){var r,f,i,e;var u=[],o=t!==-1?t:this.viewportOffset,s=this.viewportSize+400,h=o+s;for(r=0,f=n.length;r<f;r++)i=n[r],i.isRendered||(e=i.isStateApplied?i.offset:this.getItemOffset(i),e<=h&&(this.renderItem(i),u.push(i)));return u};People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine=function(n,t,i,r){People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.call(this,n,t,i,r);this._map$1=[]};Jx.inherit(People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine,People.RecentActivity.UI.Feed.StackingListViewLayoutEngine);People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype._rowHeight$1=0;People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype._map$1=null;Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype,"viewportOffset",{get:function(){return this.element.scrollLeft},set:function(n){Jx.log.write(4,"StackingListViewHorizontalLayoutEngine::ViewportOffset::set: "+n);this.element.scrollLeft=n},configurable:true});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype,"viewportSize",{get:function(){return this.element.clientWidth},configurable:true});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype,"rowHeight",{get:function(){return this._rowHeight$1||(this._rowHeight$1=Math.floor(this.viewportElement.clientHeight/People.RecentActivity.Configuration.maxStackableEntries)),this._rowHeight$1},configurable:true});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype,"scrollerSize",{get:function(){return this.element.scrollWidth},configurable:true});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype,"lastItemIndex",{get:function(){var n=this._map$1[this._map$1.length-1];return n&&Boolean(n.length)?n[n.length-1].index:-1},configurable:true});People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype.getFirstItemInView=function(n){var i,u,r,t;for((Jx.isNullOrUndefined(n)||n===-1)&&(n=this.viewportOffset),i=1,u=this._map$1.length;i<u;i++)if(r=this._map$1[i],r!=null&&(t=r[1],t!=null&&t.isRendered&&t.offset+t.size>=n))return t;return null};People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype.getFirstItemInSection=function(n){var t=this._map$1[n.column];return t!=null?t[1]:null};People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype.onDisposed=function(){this._map$1=null;People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.onDisposed.call(this)};People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype.onUpdateScrollPoints=function(){var i,r,f,n,t,u;for(People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUIUpdateSnapListStart),i=[],r=1,f=this._map$1.length;r<f;r++)if(n=this._map$1[r],n!=null)for(t=1;t<n.length;t++)if(n[t]!=null){i.push(n[t].offset);break}u=this.element;u.style.msScrollSnapPointsX="snapList("+i.join("px, ")+"px)";u.style.msScrollSnapPointsY="";Jx.log.write(4,i.join(","));People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUIUpdateSnapListStop)};People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype.onUpdateAriaAttributes=function(){var t,i,e,n,r,u;People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUIUpdateAriaStart);for(var f=1,o=this._map$1.length,s=this.items.length,h=1;f<o;f++)if(t=this._map$1[f],t!=null)for(i=1,e=t.length;i<e;i++)n=t[i],n!=null&&n.isRendered&&!n.isDisposed&&(r=this.getPreviousItem(n),u=this.getNextItem(n),n.flowFrom=r!=null&&!r.isDisposed?r.id:null,n.flowTo=u!=null&&!u.isDisposed?u.id:null,n.setPosition=h++,n.setSize=s);People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUIUpdateAriaStop)};People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype.onLayoutForced=function(){Windows.UI.ViewManagement.ApplicationView.value!==this.layoutState&&(this.stateManager.setItemState(this.getItemState(false)),this.stateManager.setListViewState(this.getState()),this.layoutState=Windows.UI.ViewManagement.ApplicationView.value);Jx.log.write(4,"StackingListViewHorizontalLayoutEngine::OnLayoutForced(), window.screen.height="+window.screen.height);this.setViewportStyle(People.RecentActivity.Configuration.maxStackableEntries);People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.onLayoutForced.call(this)};People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype.onOwnershipTaken=function(){this.setViewportStyle(People.RecentActivity.Configuration.maxStackableEntries);People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.onOwnershipTaken.call(this)};People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype.getItemOffset=function(n){var t,i,r;return t=n.element,i=t.style.display,t.style.display="",r=n.element.offsetLeft,t.style.display=i,r};People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype.getPreviousItem=function(n){if(!n.index||n.column===1&&n.row===1)return null;if(n.row===1){var t=this._map$1[n.column-1];return t!=null?t[t.length-1]:null}return this._getSiblingFromMap$1(this._map$1[n.column],n.row-1,-1)};People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype.getNextItem=function(n){var t,i,r,u;if(t=this._map$1[n.column],t!=null){if(i=n.row+n.rowSpan,t.length>i)return t[i];if(r=n.column+1,this._map$1.length>r&&(u=this._map$1[r],u!=null))return u[1]}return null};People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype.repositionItemsWithoutStacking=function(){for(var u=People.RecentActivity.Configuration.maxStackableEntries,i=this.items,n,t=0,r=i.length;t<r;t++)n=i[t],n.column=t+1,n.row=1,n.rowSpan=u,n.stackingState=0,n.widthOverride=-1};People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype.onLayoutInitialized=function(){var u=this.stateManager.getScrollPosition(),t,i,n,r;for(Jx.log.write(4,"StackingListViewHorizontalLayoutEngine::OnLayoutInitialized("+u+")"),t=0,i=this.items;t<i.length;t++)n=i[t],r=n.element.style,n.isStateApplied&&u!==-1?n.widthOverride!==-1||n.hasImplicitWidth||(n.size!==0&&(r.width=n.size+"px"),n.isReadyForStacking=true):r.display="none"};People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype.repositionItems=function(n,t){var a,st,u,h,rt,c,i,g,nt,w,ut,tt,e,o,f,r,ot,k,l,d,p;if(Jx.log.write(4,People.Social.format("StackingListViewHorizontalLayoutEngine::RepositionItems(start:{0}, end:{1})",n,t)),People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUIRepositionItemsStart),a=this.items,st=a.length,!st||!this.hasOwnership)return People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUIRepositionItemsStop),this._map$1.length=0,new Array(0);u=1;h=People.RecentActivity.Configuration.maxStackableEntries;!n||(rt=this.getFirstItemInSection(a[n]),rt!=null?(n=rt.index,u=a[n].column):n=0);var v={},ht={},ct=this.stateItems;if(ct!=null&&this._repositionItemsWithState$1(n,t,u,h,ct,v,ht))return Jx.log.write(4,"StackingListViewHorizontalLayoutEngine::RepositionItems::RepositionItemsWithState == true"),People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUIRepositionItemsStop),new Array(0);var s=[],y=50,lt=Math.ceil(n/y)*y;for(c=n;c<=t;c++)if(i=a[c],!n||!(i.column>0)||!(i.column<u)){if(!Jx.isUndefined(v[i.itemId])){if(i.column>u)for(g=this._map$1[i.column],f=1,p=g.length;f<p;f++)nt=g[f],nt&&(nt.isRepositioned=true,nt.column=u,s.push(g[f].element));i.column>=u&&u++;continue}if(w=i.element,(u!==i.column||1!==i.row)&&s.push(w),i.isRepositioned=true,i.column=u,i.row=1,i.widthOverride=-1,i.offset=w.offsetLeft,i.size=i.contentWidthPixels,v[i.itemId]=i,ut=false,i.isReadyForStacking&&(tt=i.isLoaded?i.contentHeight:i.rowSpan,e=h-tt,e>0)){ut=true;o=[];o.push(i);var it=i.size,b=it,ft=b,at=0,vt=0,yt=0,et=c<=lt?lt+y-1:Math.ceil(c/y)*y-1;for(et=Math.min(et,t),f=c+1;f<=et&&e>0;f++)(r=a[f],ot=r.itemId,!r.isReadyForStacking||!Jx.isUndefined(v[ot])||!Jx.isUndefined(ht[ot])&&i.column!==r.column||n&&r.column>0&&r.column<u||!i.acceptsNeighbour(r))||(k=r.isLoaded?r.contentHeight:r.rowSpan,k>e)||(at=r.column,vt=r.row,yt=r.rowSpan,(r.column!==u||r.row!==h-e+1||r.rowSpan!==k)&&s.push(r.element),r.isRepositioned=true,r.column=u,r.row=h-e+1,r.rowSpan=k,r.stackingState=1,r.widthOverride=-1,e-=k,v[r.itemId]=r,r.size=it=r.contentWidthPixels,r.offset=i.offset,b=Math.max(b,it),ft=Math.min(ft,it),o.push(r));if(o.length!==1){if(i.rowSpan!==tt&&s.push(w),i.rowSpan=tt,i.stackingState=1,e>0&&(l=o[o.length-1],l.rowSpan=l.rowSpan+e,at===l.column&&vt===l.row&&yt===l.rowSpan&&s.splice(s.indexOf(l.element),1)),b!==ft)for(d=0,p=o.length;d<p;d++)o[d].size=o[d].widthOverride=b;u++;continue}}i.rowSpan!==h&&s.push(w);i.rowSpan=h;i.stackingState=ut?1:i.isReadyForStacking?2:0;u++}return People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUIRepositionItemsStop),this._repositionItemsInMap$1(),s};People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype._repositionItemsWithState$1=function(n,t,i,r,u,f,e){var b,k,s,c,l,a,v,y,w,d,p,o,g,h;for(Jx.log.write(4,"StackingListViewHorizontalLayoutEngine::RepositionItemsWithState("+n+", "+t+")"),b=0,k=this.items,o=n;o<=t;o++)if(s=k[o],c=s.itemId,Jx.isUndefined(u.i[c]))break;else s.isStateApplied||(s.positionState=u.i[c]),b++,n&&s.column===i||(s.stackingState===2?f[c]=s:s.stackingState!==1||s.isLoaded&&s.isReadyForStacking&&s.contentHeight!==s.rowSpan?!s.stackingState||(e[c]=s):f[c]=s);for(this._repositionItemsInMap$1(),o=1;o<this._map$1.length;o++)if(l=this._map$1[o],l!=null){for(a=0,v=1;v<l.length;v++)h=l[v],h!=null&&(a+=h.rowSpan);a!==r&&(Jx.log.write(4,"StackingListViewHorizontalLayoutEngine::RepositionItemsWithState::RemoveColumnItems("+a+" != "+r+")"),this._removeColumnItems$1(f,o))}y=0;for(w in e){for(d={key:w,value:e[w]},p=this._removeColumnItems$1(f,d.value.column),o=0,g=p.length;o<g;o++)h=p[o],e[h.itemId]=h;y+=p.length}return y>0&&Jx.log.write(4,"StackingListViewHorizontalLayoutEngine::RepositionItemsWithState::RemoveColumnItems(neighbors, removed="+y+")"),Object.keys(f).length===t-n+1};People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype._removeColumnItems$1=function(n,t){var f=[],u=this._map$1[t],i,r;if(u!=null)for(i=1;i<u.length;i++)r=u[i],r!=null&&(delete n[r.itemId],f.push(r));return f};People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype._repositionItemsInMap$1=function(){var t,n,u;for(this._map$1.length=0,t=this.items,n=0,u=t.length;n<u;n++){var i=t[n],f=i.column,e=i.row,r=this._map$1[f];r==null&&(r=this._map$1[f]=[]);r[e]=i}};People.RecentActivity.UI.Feed.StackingListViewHorizontalLayoutEngine.prototype._getSiblingFromMap$1=function(n,t,i){if(n!=null){for(;t>0&&t<n.length&&n[t]==null;t+=i);return n[t]}return null};People.RecentActivity.UI.Feed.StackingListViewItem=function(n){this._widthOverride$1=-1;People.RecentActivity.UI.Core.Control.call(this,n)};Jx.inherit(People.RecentActivity.UI.Feed.StackingListViewItem,People.RecentActivity.UI.Core.Control);People.RecentActivity.UI.Feed.StackingListViewItem.prototype._index$1=0;People.RecentActivity.UI.Feed.StackingListViewItem.prototype._loaded$1=false;People.RecentActivity.UI.Feed.StackingListViewItem.prototype._loadedElement$1=false;People.RecentActivity.UI.Feed.StackingListViewItem.prototype._orientation$1=0;People.RecentActivity.UI.Feed.StackingListViewItem.prototype._stackingState$1=0;People.RecentActivity.UI.Feed.StackingListViewItem.prototype._row$1=0;People.RecentActivity.UI.Feed.StackingListViewItem.prototype._column$1=0;People.RecentActivity.UI.Feed.StackingListViewItem.prototype._rowSpan$1=0;People.RecentActivity.UI.Feed.StackingListViewItem.prototype._isReadyForStacking$1=false;People.RecentActivity.UI.Feed.StackingListViewItem.prototype._setPosition$1=0;People.RecentActivity.UI.Feed.StackingListViewItem.prototype._setSize$1=0;People.RecentActivity.UI.Feed.StackingListViewItem.prototype._flowFrom$1=null;People.RecentActivity.UI.Feed.StackingListViewItem.prototype._flowTo$1=null;People.RecentActivity.UI.Feed.StackingListViewItem.prototype._owner$1=null;People.RecentActivity.UI.Feed.StackingListViewItem.prototype._size$1=0;People.RecentActivity.UI.Feed.StackingListViewItem.prototype._offset$1=0;People.RecentActivity.UI.Feed.StackingListViewItem.prototype._isStateApplied$1=false;People.RecentActivity.UI.Feed.StackingListViewItem.prototype._isRepositioned$1=false;Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewItem.prototype,"isReadyForStacking",{get:function(){return this._isReadyForStacking$1},set:function(n){this._isReadyForStacking$1=n}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewItem.prototype,"orientation",{get:function(){return this._orientation$1},set:function(n){n!==this._orientation$1&&(this._orientation$1=n,this.onOrientationChanged())}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewItem.prototype,"stackingState",{get:function(){return this._stackingState$1},set:function(n){n!==this._stackingState$1&&(this._stackingState$1=n)}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewItem.prototype,"owner",{get:function(){return this._owner$1},set:function(n){this._owner$1=n}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewItem.prototype,"row",{get:function(){return this._row$1},set:function(n){n!==this._row$1&&(this._row$1=n,this.element.style.msGridRow=n.toString())}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewItem.prototype,"rowSpan",{get:function(){return this._rowSpan$1},set:function(n){n!==this._rowSpan$1&&(this._rowSpan$1=n,this.element.style.msGridRowSpan=n.toString())}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewItem.prototype,"column",{get:function(){return this._column$1},set:function(n){n!==this._column$1&&(this._column$1=n,this.element.style.msGridColumn=n.toString())}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewItem.prototype,"isElementLoaded",{get:function(){return this._loadedElement$1}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewItem.prototype,"isLoaded",{get:function(){return this._loaded$1}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewItem.prototype,"flowFrom",{get:function(){return this._flowFrom$1},set:function(n){n!==this._flowFrom$1&&(this._flowFrom$1=n,People.RecentActivity.UI.Core.AriaHelper.setFlowFrom(this.element,n))}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewItem.prototype,"flowTo",{get:function(){return this._flowTo$1},set:function(n){n!==this._flowTo$1&&(this._flowTo$1=n,People.RecentActivity.UI.Core.AriaHelper.setFlowTo(this.element,n))}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewItem.prototype,"setPosition",{get:function(){return this._setPosition$1},set:function(n){n!==this._setPosition$1&&(this._setPosition$1=n,People.RecentActivity.UI.Core.AriaHelper.setPositionInSet(this.element,n))}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewItem.prototype,"setSize",{get:function(){return this._setSize$1},set:function(n){n!==this._setSize$1&&(this._setSize$1=n,People.RecentActivity.UI.Core.AriaHelper.setSetSize(this.element,n))}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewItem.prototype,"widthOverride",{get:function(){return this._widthOverride$1},set:function(n){if(this._widthOverride$1=n,this._loaded$1||n!==-1){var t=this.element.style;t.width=n===-1?"":n+"px"}}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewItem.prototype,"index",{get:function(){return this._index$1},set:function(n){this._index$1=n}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewItem.prototype,"size",{get:function(){return this._size$1},set:function(n){this._size$1=n}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewItem.prototype,"offset",{get:function(){return this._offset$1},set:function(n){this._offset$1=n}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewItem.prototype,"isStateApplied",{get:function(){return this._isStateApplied$1},set:function(n){this._isStateApplied$1=n}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewItem.prototype,"isRepositioned",{get:function(){return this._isRepositioned$1},set:function(n){this._isRepositioned$1=n}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewItem.prototype,"positionState",{get:function(){return People.RecentActivity.UI.Feed.create_stackingListViewPositionState(this._column$1,this._row$1,this._rowSpan$1,this._widthOverride$1,this._size$1,this._offset$1,this._stackingState$1,this._isReadyForStacking$1?this.getState():null)},set:function(n){if(n!=null)this._stackingState$1=n.p,this.widthOverride=n.w,this._isRepositioned$1||(this.row=n.r,this._owner$1.orientation||(this.column=n.c,this.rowSpan=n.s),this._offset$1=n.o),this._size$1=n.z,n.i!=null&&(this._isReadyForStacking$1=true,this.setState(n.i)),this._isStateApplied$1=true;else{this._widthOverride$1=-1;var t=this.element.style;t.width="";t.height="";this._isStateApplied$1=false;this.setState(null)}}});People.RecentActivity.UI.Feed.StackingListViewItem.prototype.acceptsNeighbour=function(){return true};People.RecentActivity.UI.Feed.StackingListViewItem.prototype.loadElement=function(n){if(!this._loadedElement$1){this._loadedElement$1=true;this.onLoadElement(n)}};People.RecentActivity.UI.Feed.StackingListViewItem.prototype.load=function(){this._loaded$1||(this._loaded$1=true,this.onLoad())};People.RecentActivity.UI.Feed.StackingListViewItem.prototype.resize=function(){this.onResized()};People.RecentActivity.UI.Feed.StackingListViewItem.prototype.getState=function(){return null};People.RecentActivity.UI.Feed.StackingListViewItem.prototype.setState=function(){};People.RecentActivity.UI.Feed.StackingListViewItem.prototype.onLoad=function(){this._widthOverride$1===-1&&(this.element.style.width="")};People.RecentActivity.UI.Feed.StackingListViewItem.prototype.onLoadElement=function(){this.id=this.itemId};People.RecentActivity.UI.Feed.StackingListViewItem.prototype.onOrientationChanged=function(){};People.RecentActivity.UI.Feed.StackingListViewItem.prototype.onReadyForStacking=function(){this._isReadyForStacking$1=true};People.RecentActivity.UI.Feed.StackingListViewItem.prototype.onResized=function(){};People.RecentActivity.UI.Feed.StackingListViewInputHandler=function(n,t){this._control=n;this._data=t;People.RecentActivity.UI.Core.EventManager.events.addListener("documentkeydown",this._onKeyDown,this)};People.RecentActivity.UI.Feed.StackingListViewInputHandler.prototype._data=null;People.RecentActivity.UI.Feed.StackingListViewInputHandler.prototype._control=null;People.RecentActivity.UI.Feed.StackingListViewInputHandler.prototype._activeItem=null;People.RecentActivity.UI.Feed.StackingListViewInputHandler.prototype._disposed=false;Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewInputHandler.prototype,"activeItem",{get:function(){return this._activeItem},set:function(n){n!==this._activeItem&&(this._activeItem==null||this._activeItem.isDisposed||(this._activeItem.tabIndex=-1),this._activeItem=n,this._activeItem==null||this._activeItem.isDisposed||(this._activeItem.tabIndex=0))}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewInputHandler.prototype,"activeItemIndex",{get:function(){return this._data.items.indexOf(this._activeItem)},set:function(n){this.activeItem=n===-1?null:this._data.items[n]}});People.RecentActivity.UI.Feed.StackingListViewInputHandler.prototype.dispose=function(){this._disposed||(this._disposed=true,People.RecentActivity.UI.Core.EventManager.events.removeListenerSafe("documentkeydown",this._onKeyDown,this),this._detachEvents(this._data.items),this._control=null,this._activeItem=null)};People.RecentActivity.UI.Feed.StackingListViewInputHandler.prototype.add=function(n){var i=this,t;n.forEach(function(n){n.role="option";var t=function(){i.activeItem=n};n.attach("focus",t);n.attach("click",t)});this._activeItem==null&&(t=this._data.items,t.length>0&&(this.activeItem=t[0]))};People.RecentActivity.UI.Feed.StackingListViewInputHandler.prototype.remove=function(n){if(n.indexOf(this._activeItem)!==-1){var t=this._data.items;this.activeItem=t.length>0?t[0]:null}this._detachEvents(n)};People.RecentActivity.UI.Feed.StackingListViewInputHandler.prototype._detachEvents=function(n){for(var t=0,i=n.length;t<i;t++)n[t].detach("focus"),n[t].detach("click")};People.RecentActivity.UI.Feed.StackingListViewInputHandler.prototype._safeSetActiveItemIndex=function(n,t){var i,r;i=this._data.items;n=Math.min(Math.max(0,n),i.length-1);r=i[n];r.tabIndex=0;r.focus();t.preventDefault()};People.RecentActivity.UI.Feed.StackingListViewInputHandler.prototype._onKeyDown=function(n){var u,t,i,e,r,f;if(!n.defaultPrevented&&(u=this._data.items,u.length)&&!this._control._isClickEatingDivVisible()){switch(n.keyCode){case WinJS.Utilities.Key.home:this._safeSetActiveItemIndex(0,n);return;case WinJS.Utilities.Key.end:this._safeSetActiveItemIndex(this._control.lastItemIndex,n);return}t=null;i=null;this._activeItem!=null?this._activeItem.isActive?(t=this._control.getNextItem(this._activeItem),i=this._control.getPreviousItem(this._activeItem)):t=i=this._activeItem:t=i=u[0];t!==i&&People.RecentActivity.UI.Core.HtmlHelper.isRightToLeft&&(e=t,t=i,i=e);r=null;switch(n.keyCode){case WinJS.Utilities.Key.leftArrow:case WinJS.Utilities.Key.upArrow:r=i;break;case WinJS.Utilities.Key.rightArrow:case WinJS.Utilities.Key.downArrow:r=t;break;default:return}if(r!=null&&(f=r.index,f>=0)){this._safeSetActiveItemIndex(f,n);return}n.preventDefault()}};People.RecentActivity.UI.Feed.StackingListViewScheduler=function(){this._tasks=[]};Jx.mix(People.RecentActivity.UI.Feed.StackingListViewScheduler.prototype,Jx.Events);Jx.mix(People.RecentActivity.UI.Feed.StackingListViewScheduler.prototype,People.Social.Events);People.RecentActivity.UI.Feed.StackingListViewScheduler.prototype._tasks=null;People.RecentActivity.UI.Feed.StackingListViewScheduler.prototype._processing=false;People.RecentActivity.UI.Feed.StackingListViewScheduler.prototype._disposed=false;People.RecentActivity.UI.Feed.StackingListViewScheduler.prototype._paused=false;People.RecentActivity.UI.Feed.StackingListViewScheduler.prototype._frozen=false;Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewScheduler.prototype,"isEmpty",{get:function(){return!this._processing&&!this._tasks.length}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewScheduler.prototype,"isPaused",{get:function(){return this._paused}});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewScheduler.prototype,"isProcessing",{get:function(){return this._processing}});People.RecentActivity.UI.Feed.StackingListViewScheduler.prototype.empty=function(){Jx.log.write(4,"StackingListViewScheduler::Empty()");this._tasks.length=0;this._onEmptied()};People.RecentActivity.UI.Feed.StackingListViewScheduler.prototype.dispose=function(){Jx.log.write(4,"StackingListViewScheduler::Dispose()");this._tasks.length=0;this._disposed=true};People.RecentActivity.UI.Feed.StackingListViewScheduler.prototype.schedule=function(n,t){Jx.log.write(4,"StackingListViewScheduler::Schedule("+n+")");this._frozen||(this._tasks.push(People.RecentActivity.UI.Feed.create_stackingListViewSchedulerTask(n,t)),this._processing||this.onCompleted())};People.RecentActivity.UI.Feed.StackingListViewScheduler.prototype.pause=function(){this._paused||(Jx.log.write(4,"StackingListViewScheduler::Pause()"),this._paused=true)};People.RecentActivity.UI.Feed.StackingListViewScheduler.prototype.resume=function(){this._paused&&(Jx.log.write(4,"StackingListViewScheduler::Resume()"),this._paused=false,this._processing||this.onCompleted())};People.RecentActivity.UI.Feed.StackingListViewScheduler.prototype.freeze=function(){this._frozen||(Jx.log.write(4,"StackingListViewScheduler::Freeze()"),this._frozen=true)};People.RecentActivity.UI.Feed.StackingListViewScheduler.prototype.onCompleted=function(){var n=this;this._disposed||(this._processing=false,this._paused)||(this._tasks.length>0?(this._processing=true,window.msSetImmediate(function(){var t,i;!n._disposed&&!n._paused&&!n._frozen&&n._tasks.length>0?(Jx.log.write(4,"StackingListViewScheduler::OnCompleted(), executing task"),n._tasks.sort(function(n,t){return n.priority-t.priority}),t=n._tasks[0],Jx.log.write(4,"StackingListViewScheduler::OnCompleted:invoking "+t.priority),i=t.action,n._tasks.shift(),i()):n._processing=false})):this._onEmptied())};People.RecentActivity.UI.Feed.StackingListViewScheduler.prototype._onEmptied=function(){this.raiseEvent("emptied",new People.RecentActivity.EventArgs(this))};People.RecentActivity.UI.Feed.StackingListViewStateManager=function(){this._scrollPosition=-2;this._itemStateMap={}};People.RecentActivity.UI.Feed.StackingListViewStateManager.prototype._itemStateMap=null;People.RecentActivity.UI.Feed.StackingListViewStateManager.prototype._listviewState=null;People.RecentActivity.UI.Feed.StackingListViewStateManager.prototype._markupState=null;Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewStateManager.prototype,"hasMarkupState",{get:function(){return this._markupState!=null}});People.RecentActivity.UI.Feed.StackingListViewStateManager.prototype.setItemState=function(n){this._itemStateMap[n.l]=n};People.RecentActivity.UI.Feed.StackingListViewStateManager.prototype.getItemState=function(n){return this._itemStateMap[n]};People.RecentActivity.UI.Feed.StackingListViewStateManager.prototype.clearItemState=function(n){delete this._itemStateMap[n]};People.RecentActivity.UI.Feed.StackingListViewStateManager.prototype.setListViewState=function(n){this._scrollPosition=-2;this._listviewState=n};People.RecentActivity.UI.Feed.StackingListViewStateManager.prototype.getListViewState=function(){return this._listviewState};People.RecentActivity.UI.Feed.StackingListViewStateManager.prototype.getItemStates=function(){return this._itemStateMap};People.RecentActivity.UI.Feed.StackingListViewStateManager.prototype.setItemStates=function(n){var t,i;this.invalidate();for(t in n)i={key:t,value:n[t]},this._itemStateMap[i.key]=i.value};People.RecentActivity.UI.Feed.StackingListViewStateManager.prototype.getMarkupState=function(){return this._markupState};People.RecentActivity.UI.Feed.StackingListViewStateManager.prototype.setMarkupState=function(n){this._markupState=n};People.RecentActivity.UI.Feed.StackingListViewStateManager.prototype.invalidate=function(){People.Social.clearKeys(this._itemStateMap);this._scrollPosition=-2};People.RecentActivity.UI.Feed.StackingListViewStateManager.prototype.getScrollPosition=function(){if(this._scrollPosition===-2){var n=this.getItemState(Windows.UI.ViewManagement.ApplicationView.value);this._scrollPosition=n!=null&&this._listviewState!=null?this._listviewState.l===Windows.UI.ViewManagement.ApplicationView.value?this._listviewState.s:Jx.isUndefined(n.i[this._listviewState.d])?-1:n.i[this._listviewState.d].o:-1}return this._scrollPosition};People.RecentActivity.UI.Feed.StackingListViewVerticalLayoutEngine=function(n,t,i,r){People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.call(this,n,t,i,r)};Jx.inherit(People.RecentActivity.UI.Feed.StackingListViewVerticalLayoutEngine,People.RecentActivity.UI.Feed.StackingListViewLayoutEngine);Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewVerticalLayoutEngine.prototype,"viewportOffset",{get:function(){return this.element.scrollTop},set:function(n){Jx.log.write(4,"StackingListViewVerticalLayoutEngine::ViewportOffset::set: "+n);this.element.scrollTop=n},configurable:true});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewVerticalLayoutEngine.prototype,"viewportSize",{get:function(){return this.element.clientHeight},configurable:true});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewVerticalLayoutEngine.prototype,"rowHeight",{get:function(){return-1},configurable:true});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewVerticalLayoutEngine.prototype,"lastItemIndex",{get:function(){return this.items.length-1},configurable:true});Object.defineProperty(People.RecentActivity.UI.Feed.StackingListViewVerticalLayoutEngine.prototype,"scrollerSize",{get:function(){return this.element.scrollHeight},configurable:true});People.RecentActivity.UI.Feed.StackingListViewVerticalLayoutEngine.prototype.getFirstItemInView=function(n){var r,i,u,t;for((Jx.isNullOrUndefined(n)||n===-1)&&(n=this.viewportOffset),r=this.items,i=0,u=r.length;i<u;i++)if(t=r[i],t.isRendered&&t.offset+t.size>=n)return t;return null};People.RecentActivity.UI.Feed.StackingListViewVerticalLayoutEngine.prototype.getFirstItemInSection=function(n){return n};People.RecentActivity.UI.Feed.StackingListViewVerticalLayoutEngine.prototype.getPreviousItem=function(n){var t=n.index;return t?this.items[t-1]:null};People.RecentActivity.UI.Feed.StackingListViewVerticalLayoutEngine.prototype.getNextItem=function(n){var t=this.items,i=n.index;return i===t.length-1?null:t[i+1]};People.RecentActivity.UI.Feed.StackingListViewVerticalLayoutEngine.prototype.onUpdateScrollPoints=function(){var i,t,n,u,r;for(People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUIUpdateSnapListStart),i=this.items,t=new Array(i.length),n=0,u=t.length;n<u;n++)t[n]=i[n].offset;r=this.element;r.style.msScrollSnapPointsX="";r.style.msScrollSnapPointsY="snapList("+t.join("px, ")+"px)";People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUIUpdateSnapListStop)};People.RecentActivity.UI.Feed.StackingListViewVerticalLayoutEngine.prototype.onUpdateAriaAttributes=function(){var i,n,r,t;for(People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUIUpdateAriaStart),i=this.items,n=0,r=i.length;n<r;n++)if(t=i[n],t.isRendered)t.flowFrom=n?i[n-1].id:null,t.flowTo=n+1===r?null:i[n+1].id,t.setPosition=n+1,t.setSize=r;else break;People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUIUpdateAriaStop)};People.RecentActivity.UI.Feed.StackingListViewVerticalLayoutEngine.prototype.onOwnershipTaken=function(){this.setViewportStyle(-1);People.RecentActivity.UI.Feed.StackingListViewLayoutEngine.prototype.onOwnershipTaken.call(this)};People.RecentActivity.UI.Feed.StackingListViewVerticalLayoutEngine.prototype.getItemOffset=function(n){var t,i,r;return t=n.element,i=t.style.display,t.style.display="",r=n.element.offsetTop,t.style.display=i,r};People.RecentActivity.UI.Feed.StackingListViewVerticalLayoutEngine.prototype.repositionItemsWithoutStacking=function(){this.repositionItems(0,this.items.length-1)};People.RecentActivity.UI.Feed.StackingListViewVerticalLayoutEngine.prototype.repositionItems=function(n,t){var u,a,o,r,s,i,h,f;if(People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUIRepositionItemsStart),u=this.items,a=u.length,!a||!this.hasOwnership)return new Array(0);if(o=this.stateItems,r=n,o!=null)for(Jx.log.write(4,"RepositionItems: Using existing state to position items."),s=o.i;r<=t;r++)i=u[r],h=i.itemId,i.isStateApplied||Jx.isUndefined(s[h])||(i.positionState=s[h]);var v=[],c=0,l=-1;for(f=r+1;r<=t;r++,f++){var i=u[r],e=i.element,y=WinJS.Utilities.getContentHeight(e);l===-1?(l=WinJS.Utilities.getTotalHeight(e)-y,c=e.offsetTop):c+=u[r-1].size+l;i.size=y;i.offset=c;i.stackingState=2;i.widthOverride=-1;i.row!==f&&v.push(e);i.row=f}return People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUIRepositionItemsStop),v};People.RecentActivity.UI.Feed.StackingListViewVerticalLayoutEngine.prototype.onLayoutInitialized=function(){for(var u=this.stateManager.getScrollPosition(),n,r,t=0,i=this.items;t<i.length;t++)n=i[t],r=n.element.style,n.isStateApplied&&u!==-1?n.size!==0&&(r.height=n.size+"px"):r.display="none"};People.RecentActivity.UI.Feed.EntryControl=function(n){People.RecentActivity.UI.Feed.StackingListViewItem.call(this);this._contentHeight$2=-1;this._entry$2=n;this._network=n.network;this._itemId$2=n.sourceId+"_"+n.id};Jx.inherit(People.RecentActivity.UI.Feed.EntryControl,People.RecentActivity.UI.Feed.StackingListViewItem);Jx.mix(People.RecentActivity.UI.Feed.EntryControl.prototype,Jx.Events);Jx.mix(People.RecentActivity.UI.Feed.EntryControl.prototype,People.Social.Events);People.RecentActivity.UI.Feed.EntryControl._maximumStackingOffset$2=7884e6;People.RecentActivity.UI.Feed.EntryControl.prototype._entry$2=null;People.RecentActivity.UI.Feed.EntryControl.prototype._network=null;People.RecentActivity.UI.Feed.EntryControl.prototype._itemId$2=null;People.RecentActivity.UI.Feed.EntryControl.prototype._header$2=null;People.RecentActivity.UI.Feed.EntryControl.prototype._footer$2=null;People.RecentActivity.UI.Feed.EntryControl.prototype._content$2=null;People.RecentActivity.UI.Feed.EntryControl.prototype._contact$2=null;People.RecentActivity.UI.Feed.EntryControl.prototype._time$2=null;People.RecentActivity.UI.Feed.EntryControl.prototype._icon$2=null;People.RecentActivity.UI.Feed.EntryControl.prototype._iconButton$2=null;People.RecentActivity.UI.Feed.EntryControl.prototype._reactionsControl$2=null;People.RecentActivity.UI.Feed.EntryControl.prototype._annotations$2=null;People.RecentActivity.UI.Feed.EntryControl.prototype._isFixedWidth$2=false;People.RecentActivity.UI.Feed.EntryControl.prototype._isFixedHeight$2=false;People.RecentActivity.UI.Feed.EntryControl.prototype._isMarkupInitialized$2=false;People.RecentActivity.UI.Feed.EntryControl.prototype._isFrameRendered$2=false;People.RecentActivity.UI.Feed.EntryControl.prototype._contentWidth$2=0;People.RecentActivity.UI.Feed.EntryControl.prototype._contentWidthFinalized$2=false;People.RecentActivity.UI.Feed.EntryControl.prototype._state$2=null;Object.defineProperty(People.RecentActivity.UI.Feed.EntryControl.prototype,"entry",{get:function(){return this._entry$2}});Object.defineProperty(People.RecentActivity.UI.Feed.EntryControl.prototype,"network",{get:function(){return this._network}});Object.defineProperty(People.RecentActivity.UI.Feed.EntryControl.prototype,"isFixedWidth",{get:function(){return this._isFixedWidth$2},set:function(n){n!==this._isFixedWidth$2&&(this._isFixedWidth$2=n,n?this.addClass("ra-itemFixedWidth"):this.removeClass("ra-itemFixedWidth"),this.onFixedWidthChanged())}});Object.defineProperty(People.RecentActivity.UI.Feed.EntryControl.prototype,"isFixedHeight",{get:function(){return this._isFixedHeight$2},set:function(n){n!==this._isFixedHeight$2&&(this._isFixedHeight$2=n,this.onFixedHeightChanged())}});Object.defineProperty(People.RecentActivity.UI.Feed.EntryControl.prototype,"itemId",{get:function(){return this._itemId$2},configurable:true});Object.defineProperty(People.RecentActivity.UI.Feed.EntryControl.prototype,"contentHeight",{get:function(){var n=this.contentHeightPixels;return n?Math.ceil(n/this.owner.rowHeight):1},configurable:true});Object.defineProperty(People.RecentActivity.UI.Feed.EntryControl.prototype,"contentHeightPixels",{get:function(){var t,n;return this.orientation===1?-1:this._state$2!=null&&this._state$2.c>0?this._state$2.c:this._contentHeight$2!==-1?this._contentHeight$2:this.isLoaded&&(this.isRendered||this.isReadyForStacking)?(t=this.setTemporaryVisibility(),this.addClass("ra-itemFull"),n=this.element,this._contentHeight$2=0,this._contentHeight$2+=WinJS.Utilities.getTotalHeight(this._header$2),this._contentHeight$2+=WinJS.Utilities.getTotalHeight(this._footer$2),this._contentHeight$2+=People.RecentActivity.UI.Core.HtmlHelper.getVerticalMargin(n),this._contentHeight$2+=People.RecentActivity.UI.Core.HtmlHelper.getVerticalPadding(n),this._contentHeight$2+=this.getContentHeight(),this.removeClass("ra-itemFull"),this.restoreTemporaryVisibility(t),this._contentHeight$2):0},configurable:true});Object.defineProperty(People.RecentActivity.UI.Feed.EntryControl.prototype,"contentWidthPixels",{get:function(){return this._contentWidthFinalized$2||(this._contentWidth$2=WinJS.Utilities.getContentWidth(this.element),this.isReadyForStacking&&(this._contentWidthFinalized$2=true)),this._contentWidth$2},configurable:true});Object.defineProperty(People.RecentActivity.UI.Feed.EntryControl.prototype,"hasImplicitWidth",{get:function(){return true},configurable:true});Object.defineProperty(People.RecentActivity.UI.Feed.EntryControl.prototype,"content",{get:function(){return this._content$2}});Object.defineProperty(People.RecentActivity.UI.Feed.EntryControl.prototype,"isMarkupInitialized",{get:function(){return this._isMarkupInitialized$2}});People.RecentActivity.UI.Feed.EntryControl.prototype.acceptsNeighbour=function(n){if(this.network.identity.isWhatsNew)return true;var t=n,i=this._entry$2.timestamp.getTime(),r=t.entry.timestamp.getTime();return Math.abs(i-r)<=7884e6};People.RecentActivity.UI.Feed.EntryControl.prototype.openSelfPage=function(){this.onSelfPageOpened()};People.RecentActivity.UI.Feed.EntryControl.prototype.ensureFrameRendered=function(){var n=true;return this.element.children.length<=0?n=false:this._isFrameRendered$2||(this._isFrameRendered$2=true,this._renderPublisher$2(),this._renderAnnotation$2(),this._renderMetadata$2()),n};People.RecentActivity.UI.Feed.EntryControl.prototype.invalidateContentSize=function(){this._contentHeight$2=-1;this._contentWidth$2=-1};People.RecentActivity.UI.Feed.EntryControl.prototype.setTemporaryVisibility=function(){var n=this.element.style,t=n.display;return n.display="",t};People.RecentActivity.UI.Feed.EntryControl.prototype.restoreTemporaryVisibility=function(n){this.element.style.display=n};People.RecentActivity.UI.Feed.EntryControl.prototype.getState=function(){return People.RecentActivity.UI.Feed.create_baseEntryState(this.contentHeightPixels)};People.RecentActivity.UI.Feed.EntryControl.prototype.setState=function(n){this._state$2=n};People.RecentActivity.UI.Feed.EntryControl.prototype.onFixedWidthChanged=function(){this.onPropertyChanged("IsFixedWidth")};People.RecentActivity.UI.Feed.EntryControl.prototype.onFixedHeightChanged=function(){this.onPropertyChanged("IsFixedHeight")};People.RecentActivity.UI.Feed.EntryControl.prototype.onDisposed=function(){this._header$2=null;this._footer$2=null;this._content$2=null;this._time$2!=null&&(this._time$2.dispose(),this._time$2=null);this._disposePublisher$2();this._disposeAnnotation$2();this._disposeMetadata$2();this._content$2=null;this._footer$2=null;this._header$2=null;this._entry$2=null;this._network=null;People.RecentActivity.UI.Core.TimestampUpdateTimer.unsubscribe(this._onUpdateTimerElapsed$2,this);People.RecentActivity.UI.Feed.StackingListViewItem.prototype.onDisposed.call(this)};People.RecentActivity.UI.Feed.EntryControl.prototype.onRendered=function(){People.RecentActivity.Core.EtwHelper.writeFeedObjectEvent(People.RecentActivity.Core.EtwEventName.uiRenderEntryStart,this._entry$2.objectInfo);this.addClass("ra-network"+this._entry$2.sourceId);this.attach("keypress",this._onKeyPress$2.bind(this));this.attach("click",this._onClicked$2.bind(this));this.attach("MSPointerDown",this._onPointerDown$2.bind(this));this.attach("MSPointerCancel",this._onPointerUp$2.bind(this));this.attach("MSPointerOut",this._onPointerUp$2.bind(this));this.attach("MSPointerUp",this._onPointerUp$2.bind(this));this.ensureFrameRendered();People.RecentActivity.UI.Core.TimestampUpdateTimer.subscribe(this._onUpdateTimerElapsed$2,this);this.onContentRendered();this._updateAriaProperties$2()};People.RecentActivity.UI.Feed.EntryControl.prototype.onContentRendered=function(){};People.RecentActivity.UI.Feed.EntryControl.prototype.onSelfPageOpened=function(){Jx.log.write(4,"EntryControl::OnSelfPageOpened()");People.RecentActivity.UI.Core.SelfPageNavigationHelper.navigateToObject(this._entry$2)};People.RecentActivity.UI.Feed.EntryControl.prototype.onRenderingEnded=function(){People.RecentActivity.Core.EtwHelper.writeFeedObjectEvent(People.RecentActivity.Core.EtwEventName.uiRenderEntryEnd,this.entry.objectInfo)};People.RecentActivity.UI.Feed.EntryControl.prototype.onLoad=function(){var i,n,t;People.RecentActivity.UI.Feed.StackingListViewItem.prototype.onLoad.call(this);i=this.element;n=i.children;n.length>0?(this._header$2=n[0],this._content$2=n[1],this._footer$2=n[2]):(this._header$2=People.RecentActivity.UI.Core.HtmlHelper.createElement(People.RecentActivity.UI.Core.Html.feedEntryHeader),this._content$2=People.RecentActivity.UI.Core.HtmlHelper.createElement(People.RecentActivity.UI.Core.Html.feedEntryContent),this._footer$2=People.RecentActivity.UI.Core.HtmlHelper.createElement(People.RecentActivity.UI.Core.Html.feedEntryFooter),t=document.createDocumentFragment(),t.appendChild(this._header$2),t.appendChild(this._content$2),t.appendChild(this._footer$2),i.appendChild(t));this.onReadyForStacking()};People.RecentActivity.UI.Feed.EntryControl.prototype.onLoadElement=function(n){n!=null?(this.element=n,this._isMarkupInitialized$2=n.children.length>0):this.element=People.RecentActivity.UI.Core.HtmlHelper.createElement(People.RecentActivity.UI.Core.Html.feedEntry);People.RecentActivity.UI.Feed.StackingListViewItem.prototype.onLoadElement.call(this,n)};People.RecentActivity.UI.Feed.EntryControl.prototype._updateAriaProperties$2=function(){var i=this._header$2.children[1].children[0],n,t;document.body.offsetHeight;n=[];n.push(Jx.res.loadCompoundString("/strings/raItemBaseLabel",i.innerText));n.push.apply(n,this._annotations$2.getAriaLabels());People.RecentActivity.UI.Core.LocalizationHelper.isRelativeTimestamp(this._entry$2.timestamp)?n.push(this._time$2.text):n.push(Jx.res.loadCompoundString("/strings/raItemTimeLabel",this._time$2.text));t=this.getAriaContentLabel();Jx.isNonEmptyString(t)&&n.push(Jx.res.loadCompoundString("/strings/raItemContentLabel",t));n.push(Jx.res.loadCompoundString("/strings/raItemNetworkLabel",this.network.name));n.push.apply(n,this._reactionsControl$2.getAriaLabels());this.label=n.join("\r\n")};People.RecentActivity.UI.Feed.EntryControl.prototype._updateIcon$2=function(){var n=this.network.icon,t;Jx.isNonEmptyString(n)?(this._icon$2.isVisible=true,t=this._icon$2.element,t.src=n):this._icon$2.isVisible=false};People.RecentActivity.UI.Feed.EntryControl.prototype._updateTime$2=function(){var n=this._entry$2.timestamp;this._time$2.text=People.RecentActivity.UI.Core.LocalizationHelper.getTimeString(n)};People.RecentActivity.UI.Feed.EntryControl.prototype._renderPublisher$2=function(){var n,t,i;this._contact$2=new People.RecentActivity.UI.Core.ContactControl(this._entry$2.publisher.getDataContext());n=this._contact$2.getElement(People.RecentActivity.UI.Core.ContactControlType.tile,People.RecentActivity.Imports.create_identityElementTileOptions(60,null),-1);n.style.height="";n.style.width="";t=this._header$2.children[0];t.innerHTML="";t.appendChild(n);i=this._header$2.children[1].children[0];i.innerHTML="";i.appendChild(this._contact$2.getElement(People.RecentActivity.UI.Core.ContactControlType.name,People.RecentActivity.Imports.create_identityElementContextOptions(this._entry$2.sourceId),-1));this._contact$2.activate(this._header$2)};People.RecentActivity.UI.Feed.EntryControl.prototype._renderAnnotation$2=function(){this._annotations$2=new People.RecentActivity.UI.Core.AnnotationsControl(this._entry$2,this._footer$2.children[0],People.RecentActivity.UI.Core.AnnotationsControlPlacement.normal);this._annotations$2.hiddenEntities=true;this._annotations$2.render()};People.RecentActivity.UI.Feed.EntryControl.prototype._disposePublisher$2=function(){this._contact$2!=null&&(this._contact$2.dispose(),this._contact$2=null)};People.RecentActivity.UI.Feed.EntryControl.prototype._disposeAnnotation$2=function(){this._annotations$2!=null&&(this._annotations$2.dispose(),this._annotations$2=null)};People.RecentActivity.UI.Feed.EntryControl.prototype._renderMetadata$2=function(){var r=Jx.res,t=this._footer$2.children[1],i=this._footer$2.children[2],n=i.children;this._iconButton$2=People.RecentActivity.UI.Core.Control.fromElement(n[0]);this._iconButton$2.attach("click",this._onIconClicked$2.bind(this));People.Animation.addTapAnimation(this._iconButton$2.element);this._icon$2=People.RecentActivity.UI.Core.Control.fromElement(n[0].children[0]);this._updateIcon$2();this._reactionsControl$2=new People.RecentActivity.UI.Feed.MetadataControl(n[1],t,this._entry$2);this._reactionsControl$2.render();this._time$2=People.RecentActivity.UI.Core.Control.fromElement(this._header$2.children[1].children[1]);this._updateTime$2();this.network.addListener("propertychanged",this._onNetworkPropertyChanged$2,this)};People.RecentActivity.UI.Feed.EntryControl.prototype._disposeMetadata$2=function(){this._reactionsControl$2!=null&&(this._reactionsControl$2.dispose(),this._reactionsControl$2=null);this._icon$2!=null&&(this._icon$2.dispose(),this._icon$2=null);this._iconButton$2!=null&&(this._iconButton$2.dispose(),this._iconButton$2=null);this.network.removeListenerSafe("propertychanged",this._onNetworkPropertyChanged$2,this)};People.RecentActivity.UI.Feed.EntryControl.prototype._isHitTarget$2=function(n){for(var t=this.element;n!==t&&n!=null;){if(People.RecentActivity.UI.Core.HtmlHelper.isClickTarget(n))return true;n=n.parentNode}return false};People.RecentActivity.UI.Feed.EntryControl.prototype._onIconClicked$2=function(){People.RecentActivity.Core.BiciHelper.createClickThroughDatapoint(this._entry$2.sourceId,People.RecentActivity.Core.BiciClickthroughAction.feedEntryNetworkIcon);People.RecentActivity.UI.Core.UriHelper.launchUri(this._entry$2.url)};People.RecentActivity.UI.Feed.EntryControl.prototype._onClicked$2=function(n){if(!this._isHitTarget$2(n.srcElement)){var t=false,i=new People.RecentActivity.UI.Feed.EntryControlClickedEventArgs(this,this._entry$2);this.raiseEvent("clicked",i);t=i.preventDefault;t||this.openSelfPage()}};People.RecentActivity.UI.Feed.EntryControl.prototype._onPointerDown$2=function(n){n.button&&n.pointerType!==2||this._isHitTarget$2(n.srcElement)||People.Animation.pointerDown(this.element)};People.RecentActivity.UI.Feed.EntryControl.prototype._onPointerUp$2=function(){People.Animation.pointerUp(this.element)};People.RecentActivity.UI.Feed.EntryControl.prototype._onUpdateTimerElapsed$2=function(){this._updateTime$2();this._updateAriaProperties$2()};People.RecentActivity.UI.Feed.EntryControl.prototype._onKeyPress$2=function(n){if(!this._isHitTarget$2(n.srcElement))switch(n.keyCode){case WinJS.Utilities.Key.enter:case WinJS.Utilities.Key.space:this.openSelfPage()}};People.RecentActivity.UI.Feed.EntryControl.prototype._onNetworkPropertyChanged$2=function(n){n.propertyName==="Icon"&&this._updateIcon$2()};People.RecentActivity.UI.Feed.EntryControlClickedEventArgs=function(n,t){People.RecentActivity.EventArgs.call(this,n);this._entry$1=t};Jx.inherit(People.RecentActivity.UI.Feed.EntryControlClickedEventArgs,People.RecentActivity.EventArgs);People.RecentActivity.UI.Feed.EntryControlClickedEventArgs.prototype._entry$1=null;People.RecentActivity.UI.Feed.EntryControlClickedEventArgs.prototype._preventDefault$1=false;Object.defineProperty(People.RecentActivity.UI.Feed.EntryControlClickedEventArgs.prototype,"entry",{get:function(){return this._entry$1}});Object.defineProperty(People.RecentActivity.UI.Feed.EntryControlClickedEventArgs.prototype,"preventDefault",{get:function(){return this._preventDefault$1},set:function(n){this._preventDefault$1=n}});People.RecentActivity.UI.Feed.LinkEntryControl=function(n){People.RecentActivity.UI.Feed.EntryControl.call(this,n)};Jx.inherit(People.RecentActivity.UI.Feed.LinkEntryControl,People.RecentActivity.UI.Feed.EntryControl);People.RecentActivity.UI.Feed.LinkEntryControl._columnLayoutThreshold$3=180;People.RecentActivity.UI.Feed.LinkEntryControl._imageAssumedHeight$3=115;People.RecentActivity.UI.Feed.LinkEntryControl.prototype._element$3=null;People.RecentActivity.UI.Feed.LinkEntryControl.prototype._text$3=null;People.RecentActivity.UI.Feed.LinkEntryControl.prototype._image$3=null;People.RecentActivity.UI.Feed.LinkEntryControl.prototype._title$3=null;People.RecentActivity.UI.Feed.LinkEntryControl.prototype._caption$3=null;People.RecentActivity.UI.Feed.LinkEntryControl.prototype._description$3=null;People.RecentActivity.UI.Feed.LinkEntryControl.prototype._preview$3=null;People.RecentActivity.UI.Feed.LinkEntryControl.prototype._isUnwrapped$3=false;People.RecentActivity.UI.Feed.LinkEntryControl.prototype._isImageLoaded$3=false;People.RecentActivity.UI.Feed.LinkEntryControl.prototype._isColumnLayout$3=false;People.RecentActivity.UI.Feed.LinkEntryControl.prototype._state$3=null;People.RecentActivity.UI.Feed.LinkEntryControl.prototype.onDisposed=function(){this._element$3=null;this._preview$3=null;this._text$3!=null&&(this._text$3.dispose(),this._text$3=null);this._image$3!=null&&(this._image$3.removeListenerSafe("imagefailed",this._onImageFailed$3,this),this._image$3.removeListenerSafe("imageloaded",this._onImageLoaded$3,this),this._image$3.dispose(),this._image$3=null);this._title$3!=null&&(this._title$3.dispose(),this._title$3=null);this._caption$3!=null&&(this._caption$3.dispose(),this._caption$3=null);this._description$3!=null&&(this._description$3.dispose(),this._description$3=null);People.RecentActivity.UI.Feed.EntryControl.prototype.onDisposed.call(this)};People.RecentActivity.UI.Feed.LinkEntryControl.prototype.onContentRendered=function(){if(this._title$3.attach("click",this._onTitleClicked$3.bind(this)),!this.isMarkupInitialized){var t=this.entry,n=t.data;this._caption$3.text=n.caption;this._description$3.text=n.description;this._text$3.update(n.text,t.entities);this._title$3.text=n.title;this._adjustTextHeight$3()}(this._isImageLoaded$3||this._image$3.isDimensionsAvailable||this._state$3!=null)&&(this._image$3.isVisible&&this._applyColumnLayout$3(),this.onRenderingEnded());People.RecentActivity.UI.Feed.EntryControl.prototype.onContentRendered.call(this)};People.RecentActivity.UI.Feed.LinkEntryControl.prototype.onLoad=function(){var n,i,t,r;People.RecentActivity.UI.Feed.EntryControl.prototype.onLoad.call(this);this.isMarkupInitialized?this._element$3=this.content.children[0]:(this._element$3=People.RecentActivity.UI.Core.HtmlHelper.createElement(People.RecentActivity.UI.Core.Html.feedEntryLink),this.content.appendChild(this._element$3));n=this.entry;this._preview$3=this._element$3.children[1];i=this._preview$3.children;t=i[1].children;this._caption$3=People.RecentActivity.UI.Core.Control.fromElement(t[1]);this._description$3=People.RecentActivity.UI.Core.Control.fromElement(t[2]);this._title$3=People.RecentActivity.UI.Core.Control.fromElement(t[0]);this._text$3=this.isMarkupInitialized?People.RecentActivity.UI.Core.FormattedTextControl.fromExistingElement(this._element$3.children[0],n.sourceId,n.entities):new People.RecentActivity.UI.Core.FormattedTextControl(this._element$3.children[0],n.sourceId,true);this._image$3=new People.RecentActivity.UI.Core.ImageControl(i[0]);this._isImageLoaded$3?this._image$3.isVisible=!this.hasClass("ra-itemLinkNoImage"):(r=this._getTileUrl$3(),Jx.isNonEmptyString(r)?(People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUILoadLinkTileStart),this._image$3.isDelayed=true,this._image$3.isOneByOneError=true,this._image$3.addListener("imagefailed",this._onImageFailed$3,this),this._image$3.addListener("imageloaded",this._onImageLoaded$3,this),this._image$3.source=r,(this._image$3.isDimensionsAvailable||this._state$3!=null)&&this._applyColumnLayout$3()):(this.addClass("ra-itemLinkNoImage"),this._image$3.isVisible=false,this._setIsImageLoaded$3(true)))};People.RecentActivity.UI.Feed.LinkEntryControl.prototype.onLoadElement=function(n){People.RecentActivity.UI.Feed.EntryControl.prototype.onLoadElement.call(this,n);this.addClass("ra-itemLink");this._isImageLoaded$3=this.isMarkupInitialized&&this.hasClass("ra-itemLinkImageLoaded")};People.RecentActivity.UI.Feed.LinkEntryControl.prototype.onOrientationChanged=function(){this.isRendered&&(this._adjustTextHeight$3(),this._applyColumnLayout$3());People.RecentActivity.UI.Feed.EntryControl.prototype.onOrientationChanged.call(this)};People.RecentActivity.UI.Feed.LinkEntryControl.prototype.onFixedHeightChanged=function(){this.setState(null);this._adjustTextHeight$3();this._preview$3.offsetHeight>this._element$3.clientHeight&&(this._image$3.isVisible=false);People.RecentActivity.UI.Feed.EntryControl.prototype.onFixedHeightChanged.call(this)};People.RecentActivity.UI.Feed.LinkEntryControl.prototype.onFixedWidthChanged=function(){this._applyColumnLayout$3();People.RecentActivity.UI.Feed.EntryControl.prototype.onFixedWidthChanged.call(this)};People.RecentActivity.UI.Feed.LinkEntryControl.prototype.getAriaContentLabel=function(){var n=this.entry.data;return Jx.isNonEmptyString(n.text)?Jx.res.loadCompoundString("/strings/raItemContentLinkLabel",n.text,n.title,n.caption,n.description):n.title+" "+n.caption+" "+n.description};People.RecentActivity.UI.Feed.LinkEntryControl.prototype.getContentHeight=function(){var e=this._image$3.isVisible,f,i,n,t,r,u;return this._image$3.isVisible=true,f=People.RecentActivity.UI.Core.HtmlHelper.getTotalScrollHeight(this._text$3.element),i=People.RecentActivity.UI.Core.HtmlHelper.getTotalScrollHeight(this._preview$3),this._image$3.isVisible=e,n=f+i,this._isImageLoaded$3||this.isFixedWidth||(t=this._image$3.height,this._isColumnLayout$3?n+=Math.max(115,t-i):(r=this._image$3.width,u=WinJS.Utilities.getTotalWidth(this._preview$3),r>u&&(t*=u/r),n+=t)),n};People.RecentActivity.UI.Feed.LinkEntryControl.prototype.getState=function(){if(this.isLoaded){var n=People.RecentActivity.UI.Feed.EntryControl.prototype.getState.call(this);return n.s=this._state$3,n}return null};People.RecentActivity.UI.Feed.LinkEntryControl.prototype.setState=function(n){this._state$3=n!=null?n.s:null;People.RecentActivity.UI.Feed.EntryControl.prototype.setState.call(this,n)};People.RecentActivity.UI.Feed.LinkEntryControl.prototype._setIsColumnLayout$3=function(n){n!==this._isColumnLayout$3&&(this._isColumnLayout$3=n,this._isColumnLayout$3?this.addClass("ra-itemLinkColumns"):this.removeClass("ra-itemLinkColumns"))};People.RecentActivity.UI.Feed.LinkEntryControl.prototype._setIsImageLoaded$3=function(n){n!==this._isImageLoaded$3&&(this._isImageLoaded$3=n,this._isImageLoaded$3?this.addClass("ra-itemLinkImageLoaded"):this.removeClass("ra-itemLinkImageLoaded"))};People.RecentActivity.UI.Feed.LinkEntryControl.prototype._getTileUrl$3=function(){var f=this.entry,e=f.data,t=e.tile,i,n,u,r;if(Jx.isNonEmptyString(t))for(i=People.RecentActivity.Configuration.linkUrlTransforms,n=0,u=i.length;n<u;n++)if(r=i[n].createPreviewUrl(t),Jx.isNonEmptyString(r))return this._isUnwrapped$3=true,r;return t};People.RecentActivity.UI.Feed.LinkEntryControl.prototype._adjustTextHeight$3=function(){this.orientation===1?this._text$3.removeClass("ra-itemLinkTextFixed"):this._text$3.addClass("ra-itemLinkTextFixed")};People.RecentActivity.UI.Feed.LinkEntryControl.prototype._applyColumnLayout$3=function(){var n,t,i;if(this.ensureFrameRendered()){if(n=this._image$3.element.style,this._state$3!=null){this._setIsColumnLayout$3(this._state$3.i);n.maxHeight=this._state$3.s;return}t=this.setTemporaryVisibility();n.maxHeight=this.isFixedWidth?"":this._image$3.height+"px";this.isFixedWidth||this.orientation===1?this._setIsColumnLayout$3(false):this._image$3.width>180?(this._setIsColumnLayout$3(false),this._preview$3!=null&&this._title$3!=null&&(i=this._element$3.clientHeight-WinJS.Utilities.getTotalHeight(this._title$3.element)-WinJS.Utilities.getTotalHeight(this._text$3.element),n.maxHeight=i+"px")):this._setIsColumnLayout$3(true);this.restoreTemporaryVisibility(t);this._state$3=People.RecentActivity.UI.Feed.create_linkEntryState(this._isColumnLayout$3,n.maxHeight)}};People.RecentActivity.UI.Feed.LinkEntryControl.prototype._onImageFailed$3=function(){if(this._isUnwrapped$3){this._isUnwrapped$3=false;var n=this.entry,t=n.data;this._image$3.source=t.tile}else People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUILoadLinkTileStop),this._setIsImageLoaded$3(true),this._image$3.removeListenerSafe("imagefailed",this._onImageFailed$3,this),this._image$3.removeListenerSafe("imageloaded",this._onImageLoaded$3,this),this._image$3.isVisible=false,this.addClass("ra-itemLinkNoImage"),this.isRendered&&this.onRenderingEnded()};People.RecentActivity.UI.Feed.LinkEntryControl.prototype._onImageLoaded$3=function(){People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUILoadLinkTileStop);this._setIsImageLoaded$3(true);this._image$3.removeListenerSafe("imagefailed",this._onImageFailed$3,this);this._image$3.removeListenerSafe("imageloaded",this._onImageLoaded$3,this);this.isRendered&&(this._adjustTextHeight$3(),this._applyColumnLayout$3(),this.onRenderingEnded())};People.RecentActivity.UI.Feed.LinkEntryControl.prototype._onTitleClicked$3=function(n){var t=this.entry,i=t.data;People.RecentActivity.UI.Core.UriHelper.launchUri(i.url);n.cancelBubble=true};People.RecentActivity.UI.Feed.MetadataControl=function(n,t,i){People.RecentActivity.UI.Core.Control.call(this,n);this._reactions$1=[];this._entry$1=i;this._errors$1=new People.RecentActivity.UI.Core.ErrorMessageControl(this._entry$1.network.identity,People.RecentActivity.UI.Core.ErrorMessageContext.none,People.RecentActivity.UI.Core.ErrorMessageOperation.write,t);this._errors$1.location=People.RecentActivity.UI.Core.ErrorMessageLocation.inline;this._errors$1.render();this._errors$1.isVisible=false};Jx.inherit(People.RecentActivity.UI.Feed.MetadataControl,People.RecentActivity.UI.Core.Control);People.RecentActivity.UI.Feed.MetadataControl.prototype._entry$1=null;People.RecentActivity.UI.Feed.MetadataControl.prototype._reactions$1=null;People.RecentActivity.UI.Feed.MetadataControl.prototype._comments$1=null;People.RecentActivity.UI.Feed.MetadataControl.prototype._errors$1=null;People.RecentActivity.UI.Feed.MetadataControl.prototype.getAriaLabels=function(){for(var i=[],n,t=0,r=this._reactions$1.length;t<r;t++)n=this._reactions$1[t].getAriaLabel(),Jx.isNonEmptyString(n)&&i.push(n);return this._comments$1!=null&&(n=this._comments$1.getAriaLabel(),Jx.isNonEmptyString(n)&&i.push(n)),i};People.RecentActivity.UI.Feed.MetadataControl.prototype.onDisposed=function(){for(var n=0,t=this._reactions$1.length;n<t;n++)this._reactions$1[n].dispose();this._reactions$1.length=0;this._comments$1!=null&&(this._comments$1.dispose(),this._comments$1=null);this._errors$1!=null&&(this._errors$1.dispose(),this._errors$1=null);People.RecentActivity.UI.Core.Control.prototype.onDisposed.call(this)};People.RecentActivity.UI.Feed.MetadataControl.prototype.onRendered=function(){var t,i,n,r;for(this._renderReactions$1(),this._renderComments$1(),t=this._reactions$1.length,this._comments$1!=null&&(t+=1),i=100/t+"%",n=0,r=this._reactions$1.length;n<r;n++)this._reactions$1[n].element.style.maxWidth=i;this._comments$1!=null&&(this._comments$1.element.style.maxWidth=i);People.RecentActivity.UI.Core.Control.prototype.onRendered.call(this)};People.RecentActivity.UI.Feed.MetadataControl.prototype._renderReactions$1=function(){for(var f=this.element,i=this._entry$1.reactions,r,t,n=0,u=i.count;n<u;n++)r=People.RecentActivity.UI.Core.HtmlHelper.findElementByClass(f,i.item(n).type.iconClass),t=new People.RecentActivity.UI.Feed.MetadataReactionControl(r,this._errors$1,i.item(n)),t.render(),r==null&&this.appendControl(t),this._reactions$1.push(t)};People.RecentActivity.UI.Feed.MetadataControl.prototype._renderComments$1=function(){var t=this._entry$1.comments,i=this._entry$1.network.capabilities.commentsEnabled,r=(t.permissions&People.RecentActivity.Core.Permissions.add)===People.RecentActivity.Core.Permissions.add,n;i&&r&&(n=People.RecentActivity.UI.Core.HtmlHelper.findElementByClass(this.element,"ra-networkComments"+this._entry$1.sourceId),this._comments$1=new People.RecentActivity.UI.Feed.MetadataCommentControl(n,this._entry$1),this._comments$1.render(),n==null&&this.appendControl(this._comments$1))};People.RecentActivity.UI.Feed.MetadataCommentControl=function(n,t){People.RecentActivity.UI.Core.Control.call(this,n);this._entry$1=t};Jx.inherit(People.RecentActivity.UI.Feed.MetadataCommentControl,People.RecentActivity.UI.Core.Control);People.RecentActivity.UI.Feed.MetadataCommentControl.prototype._entry$1=null;People.RecentActivity.UI.Feed.MetadataCommentControl.prototype._countSection$1=null;People.RecentActivity.UI.Feed.MetadataCommentControl.prototype._count$1=null;People.RecentActivity.UI.Feed.MetadataCommentControl.prototype._countNext$1=null;People.RecentActivity.UI.Feed.MetadataCommentControl.prototype._icon$1=null;People.RecentActivity.UI.Feed.MetadataCommentControl.prototype._action$1=null;People.RecentActivity.UI.Feed.MetadataCommentControl.prototype._actionUndo$1=null;People.RecentActivity.UI.Feed.MetadataCommentControl.prototype.getAriaLabel=function(){return this._count$1.label};People.RecentActivity.UI.Feed.MetadataCommentControl.prototype.onDisposed=function(){this._entry$1.comments.removeListenerSafe("propertychanged",this._onCommentsPropertyChanged$1,this);this._count$1!=null&&(this._count$1.dispose(),this._count$1=null);this._countNext$1!=null&&(this._countNext$1.dispose(),this._countNext$1=null);this._countSection$1!=null&&(this._countSection$1.dispose(),this._countSection$1=null);this._icon$1!=null&&(this._icon$1.dispose(),this._icon$1=null);this._action$1!=null&&(this._action$1.dispose(),this._action$1=null);this._actionUndo$1!=null&&(this._actionUndo$1.dispose(),this._actionUndo$1=null);People.RecentActivity.UI.Core.Control.prototype.onDisposed.call(this)};People.RecentActivity.UI.Feed.MetadataCommentControl.prototype.onRendered=function(){var i=true,r=this._entry$1.comments,n,t;r.addListener("propertychanged",this._onCommentsPropertyChanged$1,this);n=this.element;n==null&&(n=this.element=People.RecentActivity.UI.Core.HtmlHelper.createElement(People.RecentActivity.UI.Core.Html.feedEntryReactionIcon),i=false);t=n.children[0].children;this.attach("click",this._onClicked$1.bind(this));People.Animation.addTapAnimation(n);this._countSection$1=People.RecentActivity.UI.Core.Control.fromElement(t[0]);this._count$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(t[0],"reaction-count");this._countNext$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(t[0],"reaction-count-next");this._icon$1=People.RecentActivity.UI.Core.Control.fromElement(t[1]);this._action$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(n,"reaction-action");this._actionUndo$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(n,"reaction-action-undo");i||(this.addClass("ra-networkComments"+this._entry$1.sourceId),this._countNext$1.isVisible=false,this._actionUndo$1.isVisible=false);this._update$1();People.RecentActivity.UI.Core.Control.prototype.onRendered.call(this)};People.RecentActivity.UI.Feed.MetadataCommentControl.prototype._canReact$1=function(){return(this._entry$1.comments.permissions&People.RecentActivity.Core.Permissions.add)===People.RecentActivity.Core.Permissions.add};People.RecentActivity.UI.Feed.MetadataCommentControl.prototype._update$1=function(){this._updateAction$1();this._updateCount$1();this._updateIcon$1();this._canReact$1()?(this.addClass("ra-itemReactionActionable"),this.isDisabled=false):(this.removeClass("ra-itemReactionActionable"),this.isDisabled=true)};People.RecentActivity.UI.Feed.MetadataCommentControl.prototype._updateAction$1=function(){this._canReact$1()?(this._action$1.isVisible=true,this._action$1.text=Jx.res.getString("/strings/raItemReaction-Comment-"+this._entry$1.sourceId)):this._action$1.isVisible=false;this._action$1.isHiddenFromScreenReader=true};People.RecentActivity.UI.Feed.MetadataCommentControl.prototype._updateCount$1=function(){var t=this._entry$1.sourceId,n=this._entry$1.comments.totalCount;n&&this._entry$1.comments.totalCountEnabled?(this.isVisible=true,this._countSection$1.isVisible=true,this._count$1.isVisible=true,this._count$1.isHiddenFromScreenReader=true,this._count$1.label=People.RecentActivity.UI.Core.LocalizationHelper.getCountString(null,"/strings/raItemReaction-Comment-"+t+"-label-countOne","/strings/raItemReaction-Comment-"+t+"-label-countMany",n),this._count$1.text=n>=100?Jx.res.getString("/strings/raItemReaction-99plus"):n.toString()):(this._count$1.label=Jx.res.getString("/strings/raItemReaction-Comment-"+t+"-label-countZero"),this._count$1.text="",this._count$1.isVisible=false,this._countSection$1.isVisible=false,this.isVisible=this._canReact$1());this.isHiddenFromScreenReader=true};People.RecentActivity.UI.Feed.MetadataCommentControl.prototype._updateIcon$1=function(){this._icon$1.text=this._entry$1.comments.icon};People.RecentActivity.UI.Feed.MetadataCommentControl.prototype._onCommentsPropertyChanged$1=function(n){n.propertyName==="TotalCount"&&this._update$1()};People.RecentActivity.UI.Feed.MetadataCommentControl.prototype._onClicked$1=function(n){People.RecentActivity.UI.Core.SelfPageNavigationHelper.navigateToObject(this._entry$1,null,true,false);n.cancelBubble=true};People.RecentActivity.UI.Feed.MetadataReactionControl=function(n,t,i){People.RecentActivity.UI.Core.Control.call(this,n);this._collection$1=i;this._errors$1=t};Jx.inherit(People.RecentActivity.UI.Feed.MetadataReactionControl,People.RecentActivity.UI.Core.Control);People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._collection$1=null;People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._errors$1=null;People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._countSection$1=null;People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._count$1=null;People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._countNext$1=null;People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._icon$1=null;People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._action$1=null;People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._actionUndo$1=null;People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._currentCount$1=0;People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._userReaction$1=false;People.RecentActivity.UI.Feed.MetadataReactionControl.prototype.getAriaLabel=function(){if(this._canReact$1()){var n=this._collection$1.type;return n.isToggle||!n.isCountShown?this._collection$1.containsUser()?Jx.res.getString(n.stringId+"label-active"):Jx.res.getString(n.stringId+"label-inactive"):this._count$1.label}return""};People.RecentActivity.UI.Feed.MetadataReactionControl.prototype.onDisposed=function(){this._errors$1=null;this._collection$1!=null&&(this._collection$1.removeListenerSafe("collectionchanged",this._onCollectionChanged$1,this),this._collection$1.removeListenerSafe("propertychanged",this._onCollectionPropertyChanged$1,this),this._collection$1.removeListenerSafe("addreactioncompleted",this._onReactionActionCompleted$1,this),this._collection$1.removeListenerSafe("removereactioncompleted",this._onReactionActionCompleted$1,this),this._collection$1=null);this._count$1!=null&&(this._count$1.dispose(),this._count$1=null);this._countNext$1!=null&&(this._countNext$1.dispose(),this._countNext$1=null);this._countSection$1!=null&&(this._countSection$1.dispose(),this._countSection$1=null);this._icon$1!=null&&(this._icon$1.dispose(),this._icon$1=null);this._action$1!=null&&(this._action$1.dispose(),this._action$1=null);People.RecentActivity.UI.Core.Control.prototype.onDisposed.call(this)};People.RecentActivity.UI.Feed.MetadataReactionControl.prototype.onRendered=function(){var i=true,n,t;this._collection$1.addListener("collectionchanged",this._onCollectionChanged$1,this);this._collection$1.addListener("propertychanged",this._onCollectionPropertyChanged$1,this);this._collection$1.addListener("addreactioncompleted",this._onReactionActionCompleted$1,this);this._collection$1.addListener("removereactioncompleted",this._onReactionActionCompleted$1,this);n=this.element;n==null&&(n=this.element=People.RecentActivity.UI.Core.HtmlHelper.createElement(People.RecentActivity.UI.Core.Html.feedEntryReactionIcon),i=false);t=n.children[0].children;this.attach("click",this._onClicked$1.bind(this));People.Animation.addTapAnimation(n);this._countSection$1=People.RecentActivity.UI.Core.Control.fromElement(t[0]);this._count$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(t[0],"reaction-count");this._countNext$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(t[0],"reaction-count-next");this._icon$1=People.RecentActivity.UI.Core.Control.fromElement(t[1]);this._action$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(n,"reaction-action");this._actionUndo$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(n,"reaction-action-undo");i?this._userReaction$1=this.hasClass("ra-itemReactionActive"):(this.addClass(this._collection$1.type.iconClass),this._action$1.text=Jx.res.getString(this._collection$1.type.stringId+"react"),this._actionUndo$1.text=Jx.res.getString(this._collection$1.type.stringId+(this._canRemoveReaction$1()?"unreact":"user-reacted")));this._update$1(!i);People.RecentActivity.UI.Core.Control.prototype.onRendered.call(this)};People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._canAddReaction$1=function(){return(this._collection$1.permissions&People.RecentActivity.Core.Permissions.add)===People.RecentActivity.Core.Permissions.add};People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._canRemoveReaction$1=function(){return(this._collection$1.permissions&People.RecentActivity.Core.Permissions.remove)===People.RecentActivity.Core.Permissions.remove};People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._canReact$1=function(){var n=this._collection$1.containsUser();return n&&this._canRemoveReaction$1()||!n&&this._canAddReaction$1()};People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._updateAction$1=function(n){var f=this,e=this._userReaction$1,r,u,t,i;this._userReaction$1=this._collection$1.containsUser();n?this._updateActionControls$1():e!==this._userReaction$1&&(r=this._userReaction$1?this._actionUndo$1:this._action$1,u=this._userReaction$1?this._action$1:this._actionUndo$1,r.isHidden=false,r.isHiddenFromScreenReader=true,u.isHidden=false,u.isHiddenFromScreenReader=true,t=r.element,t.style.opacity="0",t.style.zIndex=1,i=u.element,i.style.opacity="1",i.style.zIndex=0,People.Animation.crossFade(t,i).done(function(){return f.isDisposed||(t.style.opacity="",i.style.opacity="",f._updateActionControls$1()),null}))};People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._updateActionControls$1=function(){this._userReaction$1?(this.addClass("ra-itemReactionActive"),this._actionUndo$1.isHidden=false,this._action$1.isHidden=true):(this.removeClass("ra-itemReactionActive"),this._actionUndo$1.isHidden=true,this._action$1.isHidden=false);this._action$1.isHiddenFromScreenReader=true;this._actionUndo$1.isHiddenFromScreenReader=true};People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._updateCount$1=function(n){var t=this,e=this._currentCount$1,u,f,i,r;if(this._currentCount$1=this._collection$1.totalCount,u=this._collection$1.type,n)this._updateCountControls$1(this._currentCount$1);else if(this._countSection$1.isVisible&&e!==this._currentCount$1){if(f=u.stringId,this._updateCountControl$1(this._countNext$1,f,this._currentCount$1),this._countNext$1.text===this._count$1.text)return;this._countNext$1.isHidden=false;this._countNext$1.isHiddenFromScreenReader=true;i=this._countNext$1.element;i.style.opacity="0";i.style.zIndex=1;r=this._count$1.element;r.style.opacity="1";r.style.zIndex=0;People.Animation.crossFade(i,r).done(function(){if(!t.isDisposed){i.style.opacity="";r.style.opacity="";var n=t._count$1;t._count$1=t._countNext$1;t._countNext$1=n;t._updateCountControls$1(t._currentCount$1)}return null})}};People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._updateCountControls$1=function(n){var t=this._collection$1.type,i,r;t.isToggle||!t.isCountShown?(this._count$1.isVisible=false,this._countNext$1.isVisible=false,this._countSection$1.isVisible=false,this.isVisible=this._collection$1.containsUser()||this._canReact$1()):(i=t.stringId,this._countSection$1.isVisible=true,this._count$1.isVisible=true,this._updateCountControl$1(this._count$1,i,n),this._canReact$1()?(r=this._collection$1.containsUser()&&this._canRemoveReaction$1()?Math.max(0,n-1):n+1,this._updateCountControl$1(this._countNext$1,i,r),this._countNext$1.isVisible=true,this._countNext$1.isHidden=true):(this._countNext$1.isVisible=false,this._countNext$1.isHidden=true),this.isVisible=n>0||this._canReact$1());this.isHiddenFromScreenReader=true;this._countSection$1.isHiddenFromScreenReader=true;this._count$1.isHiddenFromScreenReader=true;this._countNext$1.isHiddenFromScreenReader=true};People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._updateCountControl$1=function(n,t,i){n.label=People.RecentActivity.UI.Core.LocalizationHelper.getCountString(t+"label-countZero",t+"label-countOne",t+"label-countMany",i);n.text=i?i>=100?Jx.res.getString("/strings/raItemReaction-99plus"):i.toString():""};People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._updateIcon$1=function(){Jx.isNonEmptyString(this._icon$1.text)||(this._icon$1.text=this._collection$1.type.iconFeed)};People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._update$1=function(n){this._updateAction$1(n);this._updateCount$1(n);this._updateIcon$1();this._canReact$1()?(this.addClass("ra-itemReactionActionable"),this.isDisabled=false):(this.removeClass("ra-itemReactionActionable"),this.isDisabled=true)};People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._onReactionActionCompleted$1=function(n){this.isDisabled=false;var t=n.result;t.code!==People.RecentActivity.Core.ResultCode.success&&(this._errors$1.isVisible=true,this._errors$1.show(t))};People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._onCollectionChanged$1=function(){this._update$1(false)};People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._onCollectionPropertyChanged$1=function(n){n.propertyName==="TotalCount"&&this._update$1(false)};People.RecentActivity.UI.Feed.MetadataReactionControl.prototype._onClicked$1=function(){if(this._errors$1.isVisible=false,this.isDisabled=true,this._collection$1.containsUser()){if(this._canRemoveReaction$1()){this._collection$1.remove();return}}else if(this._canAddReaction$1()){this._collection$1.add();return}this.isDisabled=false};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl=function(n){People.RecentActivity.UI.Feed.EntryControl.call(this,n)};Jx.inherit(People.RecentActivity.UI.Feed.PhotoAlbumEntryControl,People.RecentActivity.UI.Feed.EntryControl);People.RecentActivity.UI.Feed.PhotoAlbumEntryControl._defaultMaximumWidth$3=833;People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._content$3=null;People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._contentGrid$3=null;People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._imageHero$3=null;People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._imageThumb1$3=null;People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._imageThumb2$3=null;People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._containerHero$3=null;People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._containerThumb1$3=null;People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._containerThumb2$3=null;People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._caption$3=null;People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._captionButton$3=null;People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._photoHero$3=null;People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._photoThumb1$3=null;People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._photoThumb2$3=null;People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._photoCount$3=0;Object.defineProperty(People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype,"hasImplicitWidth",{get:function(){return false},configurable:true});People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype.getAriaContentLabel=function(){var n=this.entry.data;return n.text};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype.getContentHeight=function(){var n=this.setTemporaryVisibility(),t=WinJS.Utilities.getTotalHeight(this._content$3);return this.restoreTemporaryVisibility(n),t};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype.onDisposed=function(){this._content$3=null;this._disposeControls$3(this._containerHero$3,this._imageHero$3);this._disposeControls$3(this._containerThumb1$3,this._imageThumb1$3);this._disposeControls$3(this._containerThumb2$3,this._imageThumb2$3);this._containerHero$3=null;this._containerThumb1$3=null;this._containerThumb2$3=null;this._imageHero$3=null;this._imageThumb1$3=null;this._imageThumb2$3=null;this._caption$3!=null&&(this._caption$3.dispose(),this._caption$3=null);this._captionButton$3!=null&&(this._captionButton$3.dispose(),this._captionButton$3=null);People.RecentActivity.UI.Feed.EntryControl.prototype.onDisposed.call(this)};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype.onContentRendered=function(){People.RecentActivity.UI.Feed.EntryControl.prototype.onContentRendered.call(this);this._updateCaption$3();this.isMarkupInitialized||this._updatePhotoSizes$3();this._onReady$3()};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype.onLoad=function(){People.RecentActivity.UI.Feed.EntryControl.prototype.onLoad.call(this);this.isMarkupInitialized?(this._content$3=this.content.children[0],this._contentGrid$3=this._content$3.children[0]):(this._content$3=People.RecentActivity.UI.Core.HtmlHelper.createElement(People.RecentActivity.UI.Core.Html.feedEntryPhotoAlbum),this._contentGrid$3=this._content$3.children[0],this.content.appendChild(this._content$3));this._caption$3=People.RecentActivity.UI.Core.Control.fromElement(this._content$3.children[1]);var t=this._content$3.children[0],n=t.children;this._containerHero$3=People.RecentActivity.UI.Core.Control.fromElement(n[0]);this._containerThumb1$3=People.RecentActivity.UI.Core.Control.fromElement(n[1]);this._containerThumb2$3=People.RecentActivity.UI.Core.Control.fromElement(n[2]);this._imageHero$3=new People.RecentActivity.UI.Core.ImageControl(n[0].children[0]);this._imageThumb1$3=new People.RecentActivity.UI.Core.ImageControl(n[1].children[0]);this._imageThumb2$3=new People.RecentActivity.UI.Core.ImageControl(n[2].children[0]);this._selectPhotos$3();this.isMarkupInitialized?(this._imageHero$3.isVisible=!this._imageHero$3.hasClass("ra-photoAlbumImageFailed"),this._imageHero$3.isHiddenFromScreenReader=true,this._imageThumb1$3.isVisible=!this._imageHero$3.hasClass("ra-photoAlbumImageFailed"),this._imageThumb1$3.isHiddenFromScreenReader=true,this._imageThumb2$3.isVisible=!this._imageHero$3.hasClass("ra-photoAlbumImageFailed"),this._imageThumb2$3.isHiddenFromScreenReader=true):(this._setImageSource$3(this._imageHero$3,this._photoHero$3),this._setImageSource$3(this._imageThumb1$3,this._photoThumb1$3),this._setImageSource$3(this._imageThumb2$3,this._photoThumb2$3));this._setImageClickHandler$3(this._imageHero$3,this._photoHero$3);this._setImageClickHandler$3(this._imageThumb1$3,this._photoThumb1$3);this._setImageClickHandler$3(this._imageThumb2$3,this._photoThumb2$3)};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype.onLoadElement=function(n){People.RecentActivity.UI.Feed.EntryControl.prototype.onLoadElement.call(this,n);this.addClass("ra-itemPhotoAlbum")};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype.onOrientationChanged=function(){this._resizePhotos$3();People.RecentActivity.UI.Feed.EntryControl.prototype.onOrientationChanged.call(this)};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype.onResized=function(){this.invalidateContentSize();this.setState(null);this._resizePhotos$3();People.RecentActivity.UI.Feed.EntryControl.prototype.onResized.call(this)};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype.onFixedHeightChanged=function(){this._updatePhotoSizes$3();People.RecentActivity.UI.Feed.EntryControl.prototype.onFixedHeightChanged.call(this)};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype.getState=function(){return this.isLoaded?People.RecentActivity.UI.Feed.EntryControl.prototype.getState.call(this):null};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._getImageState$3=function(n,t){var i=n.element.style,r=t.element.style;return People.RecentActivity.UI.Feed.create_photoAlbumEntryImageState(i.height,i.width,r.left,r.top)};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._onReady$3=function(){this.isRendered&&!this._photoCount$3&&People.RecentActivity.UI.Feed.EntryControl.prototype.onRenderingEnded.call(this)};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._disposeControls$3=function(n,t){n!=null&&n.dispose();t!=null&&(t.removeListenerSafe("imagefailed",this._onImageFailed$3,this),t.removeListenerSafe("imageloaded",this._onImageLoaded$3,this),t.dispose())};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._selectPhotos$3=function(){for(var u=this.entry.data,r=u.displayPhotos,t,n=0,i=r.length;n<i;n++)if(t=r[n],this._photoHero$3==null&&t.isLandscape){this._photoHero$3=t;break}for(n=0,i=r.length;n<i;n++)if(t=r[n],t!==this._photoHero$3)if(this._photoHero$3==null)this._photoHero$3=t;else if(this._photoThumb1$3==null)this._photoThumb1$3=t;else if(this._photoThumb2$3==null)this._photoThumb2$3=t;else break};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._setImageSource$3=function(n,t){t==null?n.isVisible=false:(this._photoCount$3++,n.isBackground=true,n.addListener("imagefailed",this._onImageFailed$3,this),n.addListener("imageloaded",this._onImageLoaded$3,this),n.source=t.source)};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._setImageClickHandler$3=function(n,t){var i=this;t!=null&&(n.attach("click",function(n){People.RecentActivity.UI.Core.SelfPageNavigationHelper.navigateToObject(i.entry,People.RecentActivity.UI.Core.create_selfPageAlbumData(false,t.id));n.cancelBubble=true}),People.Animation.addTapAnimation(n.element))};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._updateCaption$3=function(){var t=this.entry,i=t.data,n;i.isTagged||t.isShared||(n=new People.RecentActivity.UI.Core.Control(People.RecentActivity.UI.Core.HtmlHelper.createElement(People.RecentActivity.UI.Core.Html.feedEntryPhotoAlbumName)),n.attach("click",this._onNameClicked$3.bind(this)),n.text=i.album.name,n.isHiddenFromScreenReader=true,People.Animation.addTapAnimation(n.element),this._captionButton$3=n,this._caption$3.element.innerHTML="",this._caption$3.appendChild(People.RecentActivity.UI.Core.LocalizationHelper.loadCompoundElement("/strings/ra-itemPhotoAlbumCaption",[n.element])))};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._updatePhotoSizes$3=function(){this.ensureFrameRendered();var e=this.isFixedHeight,f=this.isFixedWidth||this.orientation===1,o=this._containerThumb1$3.isVisible||this._containerThumb2$3.isVisible,t=Math.min(833,window.screen.width-40);o||(t*=.7,this._contentGrid$3.style.msGridColumns="100%");this._content$3.style.width=f?"100%":t+"px";this._contentGrid$3.style.width="";var i=f?WinJS.Utilities.getContentWidth(this._contentGrid$3):t,r=WinJS.Utilities.getContentHeight(this._contentGrid$3),n=i/1.5*.7,u=n/2;e&&n>r&&(n=r,u=n/2,i=r/(10/15)*(10/7),this._contentGrid$3.style.width=i+"px");this._contentGrid$3.style.msGridRows=u+"px "+u+"px"};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._resizePhotos$3=function(){this.isRendered&&this._updatePhotoSizes$3()};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._onImageFailed$3=function(n){var t=n.sender;t.addClass("ra-photoAlbumImageFailed");t.isVisible=false;Jx.addClass(t.element.parentNode,"ra-itemPhotoAlbumImageBoxFailed");this._photoCount$3--;this._onReady$3()};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._onImageLoaded$3=function(){this._photoCount$3--;this._onReady$3()};People.RecentActivity.UI.Feed.PhotoAlbumEntryControl.prototype._onNameClicked$3=function(n){var t=this.entry.data;People.RecentActivity.UI.Core.SelfPageNavigationHelper.navigateToObject(t.album);n.cancelBubble=true};People.RecentActivity.UI.Feed.PhotoEntryControl=function(n){People.RecentActivity.UI.Feed.EntryControl.call(this,n)};Jx.inherit(People.RecentActivity.UI.Feed.PhotoEntryControl,People.RecentActivity.UI.Feed.EntryControl);People.RecentActivity.UI.Feed.PhotoEntryControl._maximumHeightFixedMode$3=200;People.RecentActivity.UI.Feed.PhotoEntryControl._maximumWidth$3=700;People.RecentActivity.UI.Feed.PhotoEntryControl._initialHeightGuess$3=400;People.RecentActivity.UI.Feed.PhotoEntryControl.prototype._content$3=null;People.RecentActivity.UI.Feed.PhotoEntryControl.prototype._image$3=null;People.RecentActivity.UI.Feed.PhotoEntryControl.prototype._caption$3=null;People.RecentActivity.UI.Feed.PhotoEntryControl.prototype._container$3=null;People.RecentActivity.UI.Feed.PhotoEntryControl.prototype._isReady$3=false;People.RecentActivity.UI.Feed.PhotoEntryControl.prototype._isLoaded$3=false;People.RecentActivity.UI.Feed.PhotoEntryControl.prototype._isSized$3=false;People.RecentActivity.UI.Feed.PhotoEntryControl.prototype._isImplicitFixedWidth$3=false;People.RecentActivity.UI.Feed.PhotoEntryControl.prototype._state$3=null;Object.defineProperty(People.RecentActivity.UI.Feed.PhotoEntryControl.prototype,"hasImplicitWidth",{get:function(){return false},configurable:true});People.RecentActivity.UI.Feed.PhotoEntryControl.prototype.getAriaContentLabel=function(){var t=this.entry.data,n=(t.text||"").trim();return Jx.isNonEmptyString(n)||(n=t.photo.caption),n};People.RecentActivity.UI.Feed.PhotoEntryControl.prototype.getContentHeight=function(){var t=this.setTemporaryVisibility(),n=WinJS.Utilities.getTotalHeight(this._content$3);return this._isSized$3||(n+=400),this.restoreTemporaryVisibility(t),n};People.RecentActivity.UI.Feed.PhotoEntryControl.prototype.onDisposed=function(){this._content$3=null;this._caption$3!=null&&(this._caption$3.dispose(),this._caption$3=null);this._container$3!=null&&(this._container$3.dispose(),this._container$3=null);this._image$3!=null&&(this._image$3.removeListenerSafe("imagefailed",this._onImageFailed$3,this),this._image$3.removeListenerSafe("imageloaded",this._onImageLoaded$3,this),this._image$3.dispose(),this._image$3=null);People.RecentActivity.UI.Feed.EntryControl.prototype.onDisposed.call(this)};People.RecentActivity.UI.Feed.PhotoEntryControl.prototype.onContentRendered=function(){this.isMarkupInitialized||this._updateCaption$3();this._updateLayout$3();this._isReady$3=true;this._onReady$3();People.RecentActivity.UI.Feed.EntryControl.prototype.onContentRendered.call(this)};People.RecentActivity.UI.Feed.PhotoEntryControl.prototype.onLoad=function(){People.RecentActivity.UI.Feed.EntryControl.prototype.onLoad.call(this);var n=this._getPhoto$3();this.isMarkupInitialized?(this._content$3=this.content.children[0],this._caption$3=People.RecentActivity.UI.Core.FormattedTextControl.fromExistingElement(this._content$3.children[1],n.sourceId,this._getCaptionEntities$3())):(this._content$3=People.RecentActivity.UI.Core.HtmlHelper.createElement(People.RecentActivity.UI.Core.Html.feedEntryPhoto),this.content.appendChild(this._content$3),this._caption$3=new People.RecentActivity.UI.Core.FormattedTextControl(this._content$3.children[1],n.sourceId,true));this._container$3=People.RecentActivity.UI.Core.Control.fromElement(this._content$3.children[0]);People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUILoadPhotoStart);this._image$3=new People.RecentActivity.UI.Core.ImageControl(this._content$3.children[0].children[0]);this._image$3.isVisible=false;Jx.isNonEmptyString(n.source)?(this._image$3.addListener("imagefailed",this._onImageFailed$3,this),this._image$3.addListener("imageloaded",this._onImageLoaded$3,this),this._image$3.source=n.source,(this._image$3.isDimensionsAvailable||this._isKnownImageSize$3())&&this._updateLayout$3()):this._isLoaded$3=true};People.RecentActivity.UI.Feed.PhotoEntryControl.prototype.onLoadElement=function(n){People.RecentActivity.UI.Feed.EntryControl.prototype.onLoadElement.call(this,n);this.addClass("ra-itemPhoto")};People.RecentActivity.UI.Feed.PhotoEntryControl.prototype.onOrientationChanged=function(){this.isRendered&&(this._isReady$3&&this._isLoaded$3||this._isKnownImageSize$3())&&this._updatePhotoSizeAndPosition$3();People.RecentActivity.UI.Feed.EntryControl.prototype.onOrientationChanged.call(this)};People.RecentActivity.UI.Feed.PhotoEntryControl.prototype.onFixedHeightChanged=function(){this.setState(null);this._updatePhotoSizeAndPosition$3();People.RecentActivity.UI.Feed.EntryControl.prototype.onFixedHeightChanged.call(this)};People.RecentActivity.UI.Feed.PhotoEntryControl.prototype.getState=function(){if(this.isLoaded){var n=People.RecentActivity.UI.Feed.EntryControl.prototype.getState.call(this);return n.s=this._state$3,n}return null};People.RecentActivity.UI.Feed.PhotoEntryControl.prototype.setState=function(n){this._state$3=n!=null?n.s:null;People.RecentActivity.UI.Feed.EntryControl.prototype.setState.call(this,n)};People.RecentActivity.UI.Feed.PhotoEntryControl.prototype._isKnownImageSize$3=function(){if(this._state$3!=null)return true;var n=this._getPhoto$3();return!!n.sourceHeight&&!!n.sourceWidth};People.RecentActivity.UI.Feed.PhotoEntryControl.prototype._getCaptionText$3=function(){var i=this.entry,n=i.data,t=(n.text||"").trim();return Jx.isNonEmptyString(t)?t:(n.photo.caption||"").trim()};People.RecentActivity.UI.Feed.PhotoEntryControl.prototype._getCaptionEntities$3=function(){var t=this.entry,i=t.data,r=(i.text||"").trim(),n;return Jx.isNonEmptyString(r)?t.entities:(n=i.photo,Jx.isNonEmptyString((n.caption||"").trim()))?n.entities:new Array(0)};People.RecentActivity.UI.Feed.PhotoEntryControl.prototype._onReady$3=function(){this._isReady$3&&this._isLoaded$3&&(this._isKnownImageSize$3()||this._updatePhotoSizeAndPosition$3(),People.RecentActivity.UI.Feed.EntryControl.prototype.onRenderingEnded.call(this))};People.RecentActivity.UI.Feed.PhotoEntryControl.prototype._updateLayout$3=function(){this._isKnownImageSize$3()||this._image$3.isDimensionsAvailable?this._updatePhotoSizeAndPosition$3():(this.isFixedWidth&&this._updatePhotoSizeAndPosition$3(),this._isImplicitFixedWidth$3=true,this.addClass("ra-itemPhotoFixed"))};People.RecentActivity.UI.Feed.PhotoEntryControl.prototype._updateCaption$3=function(){var n=this._getCaptionText$3();Jx.isNonEmptyString(n)?(this._caption$3.update(n,this._getCaptionEntities$3()),this._updateCaptionSize$3()):this._caption$3.isVisible=false};People.RecentActivity.UI.Feed.PhotoEntryControl.prototype._updateCaptionSize$3=function(){this.orientation||(this._isSized$3?Jx.addClass(this._content$3,"ra-itemPhotoContentAuto"):Jx.removeClass(this._content$3,"ra-itemPhotoContentAuto"))};People.RecentActivity.UI.Feed.PhotoEntryControl.prototype._updatePhotoSizeAndPosition$3=function(){var v,c,l,a,t,i;this.ensureFrameRendered();var s=this._container$3.element,y=this._image$3.element,e=this._content$3.style,f=s.style,n=y.style;if(this._state$3!=null){n.position="relative";n.height=this._state$3.h;n.left=this._state$3.x;n.top=this._state$3.y;n.width=this._state$3.w;f.height=this._state$3.h;f.width=e.width=this._state$3.c;this._isSized$3=true;this._updateCaptionSize$3();return}v=this.setTemporaryVisibility();Jx.addClass(this._content$3,"ra-itemPhotoContentTemp");e.height="";e.width="";f.height="";f.width="";var u=-1,r=-1,h=WinJS.Utilities.getContentHeight(s),o=WinJS.Utilities.getContentWidth(s);h||(h=o*(7/10));c=this._isImplicitFixedWidth$3||this.isFixedWidth;l=this._isKnownImageSize$3()||this._image$3.isDimensionsAvailable;this.orientation?(u=16777215,r=o):(r=c||!l?o:700,u=c&&!l?200:h);a=this._getPhoto$3();t=Math.max(a.sourceHeight,this._image$3.height);t||(t=400);i=Math.max(a.sourceWidth,this._image$3.width);i||(i=o);t>u&&(i=u/t*i,t=u);i>r&&(t=r/i*t,i=r);n.height=t+"px";n.width=i+"px";t>u&&(n.position="relative",n.top=(u-t)/2+"px");i>r&&(n.position="relative",n.left=(r-i)/2+"px");f.height=t+"px";f.width=e.width=Math.min(i,r)+"px";Jx.removeClass(this._content$3,"ra-itemPhotoContentTemp");this._isSized$3=true;this._updateCaptionSize$3();this.restoreTemporaryVisibility(v);this._state$3=People.RecentActivity.UI.Feed.create_photoEntryState(e.width,n.width,n.height,n.left,n.top)};People.RecentActivity.UI.Feed.PhotoEntryControl.prototype._getPhoto$3=function(){var n=this.entry,t=n.data;return t.photo};People.RecentActivity.UI.Feed.PhotoEntryControl.prototype._onImageFailed$3=function(){People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUILoadPhotoStop);this._container$3.addClass("image-failed");this._image$3.removeListenerSafe("imagefailed",this._onImageFailed$3,this);this._image$3.removeListenerSafe("imageloaded",this._onImageLoaded$3,this);this._isLoaded$3=true;this._onReady$3()};People.RecentActivity.UI.Feed.PhotoEntryControl.prototype._onImageLoaded$3=function(){People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUILoadPhotoStop);this._image$3.removeListenerSafe("imagefailed",this._onImageFailed$3,this);this._image$3.removeListenerSafe("imageloaded",this._onImageLoaded$3,this);this._isLoaded$3=true;this._onReady$3()};People.RecentActivity.UI.Feed.TextEntryControl=function(n){People.RecentActivity.UI.Feed.EntryControl.call(this,n)};Jx.inherit(People.RecentActivity.UI.Feed.TextEntryControl,People.RecentActivity.UI.Feed.EntryControl);People.RecentActivity.UI.Feed.TextEntryControl.prototype._text$3=null;People.RecentActivity.UI.Feed.TextEntryControl.prototype._container$3=null;People.RecentActivity.UI.Feed.TextEntryControl.prototype.onDisposed=function(){this._container$3=null;this._text$3!=null&&(this._text$3.dispose(),this._text$3=null);People.RecentActivity.UI.Feed.EntryControl.prototype.onDisposed.call(this)};People.RecentActivity.UI.Feed.TextEntryControl.prototype.onContentRendered=function(){this.onRenderingEnded();People.RecentActivity.UI.Feed.EntryControl.prototype.onContentRendered.call(this)};People.RecentActivity.UI.Feed.TextEntryControl.prototype.onLoad=function(){People.RecentActivity.UI.Feed.EntryControl.prototype.onLoad.call(this);var n=this.entry,t=n.data;this.isMarkupInitialized?(this._container$3=this.content.children[0],this._text$3=People.RecentActivity.UI.Core.FormattedTextControl.fromExistingElement(this._container$3.children[0],n.sourceId,n.entities)):(this._container$3=People.RecentActivity.UI.Core.HtmlHelper.createElement(People.RecentActivity.UI.Core.Html.feedEntryText),this._text$3=new People.RecentActivity.UI.Core.FormattedTextControl(this._container$3.children[0],n.sourceId,true),this._text$3.update(t.text,n.entities),this.content.appendChild(this._container$3),this._updateTextSize$3())};People.RecentActivity.UI.Feed.TextEntryControl.prototype.onLoadElement=function(n){People.RecentActivity.UI.Feed.EntryControl.prototype.onLoadElement.call(this,n);this.addClass("ra-itemText")};People.RecentActivity.UI.Feed.TextEntryControl.prototype.onOrientationChanged=function(){this.isRendered&&this._updateTextSize$3();People.RecentActivity.UI.Feed.EntryControl.prototype.onOrientationChanged.call(this)};People.RecentActivity.UI.Feed.TextEntryControl.prototype.onFixedHeightChanged=function(){this._updateTextSize$3();People.RecentActivity.UI.Feed.EntryControl.prototype.onFixedHeightChanged.call(this)};People.RecentActivity.UI.Feed.TextEntryControl.prototype.getAriaContentLabel=function(){return this.entry.data.text};People.RecentActivity.UI.Feed.TextEntryControl.prototype.getContentHeight=function(){return People.RecentActivity.UI.Core.HtmlHelper.getTotalScrollHeight(this._text$3.element)};People.RecentActivity.UI.Feed.TextEntryControl.prototype._updateTextSize$3=function(){this._text$3!=null&&(this.isFixedWidth&&!this.isFixedHeight||this.orientation===1?this._text$3.removeClass("ra-itemTextContentInnerFixed"):this._text$3.addClass("ra-itemTextContentInnerFixed"))};People.RecentActivity.UI.Feed.VideoEntryControl=function(n){People.RecentActivity.UI.Feed.EntryControl.call(this,n)};Jx.inherit(People.RecentActivity.UI.Feed.VideoEntryControl,People.RecentActivity.UI.Feed.EntryControl);People.RecentActivity.UI.Feed.VideoEntryControl.prototype._element$3=null;People.RecentActivity.UI.Feed.VideoEntryControl.prototype._text$3=null;People.RecentActivity.UI.Feed.VideoEntryControl.prototype._image$3=null;People.RecentActivity.UI.Feed.VideoEntryControl.prototype._imageOverlay$3=null;People.RecentActivity.UI.Feed.VideoEntryControl.prototype._title$3=null;People.RecentActivity.UI.Feed.VideoEntryControl.prototype._caption$3=null;People.RecentActivity.UI.Feed.VideoEntryControl.prototype._description$3=null;People.RecentActivity.UI.Feed.VideoEntryControl.prototype._preview$3=null;People.RecentActivity.UI.Feed.VideoEntryControl.prototype._isTransformed$3=false;People.RecentActivity.UI.Feed.VideoEntryControl.prototype._isTileLoaded$3=false;People.RecentActivity.UI.Feed.VideoEntryControl.prototype._isColumnLayout$3=false;People.RecentActivity.UI.Feed.VideoEntryControl.prototype._state$3=null;People.RecentActivity.UI.Feed.VideoEntryControl.prototype.onDisposed=function(){this._element$3=null;this._preview$3=null;this._text$3!=null&&(this._text$3.dispose(),this._text$3=null);this._image$3!=null&&(this._image$3.removeListenerSafe("imageloaded",this._onImageLoaded$3,this),this._image$3.removeListenerSafe("imagefailed",this._onImageFailed$3,this),this._image$3.dispose(),this._image$3=null);this._imageOverlay$3!=null&&(this._imageOverlay$3.dispose(),this._imageOverlay$3=null);this._title$3!=null&&(this._title$3.dispose(),this._title$3=null);this._caption$3!=null&&(this._caption$3.dispose(),this._caption$3=null);this._description$3!=null&&(this._description$3.dispose(),this._description$3=null);People.RecentActivity.UI.Feed.EntryControl.prototype.onDisposed.call(this)};People.RecentActivity.UI.Feed.VideoEntryControl.prototype.onContentRendered=function(){if(this._title$3.attach("click",this._onTitleClicked$3.bind(this)),!this.isMarkupInitialized){var t=this.entry,n=t.data;this._caption$3.text=n.caption;this._description$3.text=n.description;this._text$3.update(n.text,t.entities);this._title$3.text=n.title;this._adjustTextHeight$3()}(this._isTileLoaded$3||this._image$3.isDimensionsAvailable||this._state$3!=null)&&(this._image$3.isVisible&&this._applyColumnLayout$3(),this.onRenderingEnded());People.RecentActivity.UI.Feed.EntryControl.prototype.onContentRendered.call(this)};People.RecentActivity.UI.Feed.VideoEntryControl.prototype.onLoad=function(){var n,t,i,r;People.RecentActivity.UI.Feed.EntryControl.prototype.onLoad.call(this);this.isMarkupInitialized?this._element$3=this.content.children[0]:(this._element$3=People.RecentActivity.UI.Core.HtmlHelper.createElement(People.RecentActivity.UI.Core.Html.feedEntryVideo),this.content.appendChild(this._element$3));n=this.entry;this._preview$3=this._element$3.children[1];t=this._preview$3.children;i=t[2].children;this._caption$3=People.RecentActivity.UI.Core.Control.fromElement(i[1]);this._description$3=People.RecentActivity.UI.Core.Control.fromElement(i[2]);this._title$3=People.RecentActivity.UI.Core.Control.fromElement(i[0]);this._text$3=this.isMarkupInitialized?People.RecentActivity.UI.Core.FormattedTextControl.fromExistingElement(this._element$3.children[0],n.sourceId,n.entities):new People.RecentActivity.UI.Core.FormattedTextControl(this._element$3.children[0],n.sourceId,true);this._image$3=new People.RecentActivity.UI.Core.ImageControl(t[0]);this._imageOverlay$3=People.RecentActivity.UI.Core.Control.fromElement(t[1]);this._isTileLoaded$3?this._image$3.isVisible=this._imageOverlay$3.isVisible=!this.hasClass("ra-itemVideoNoTile"):(r=this._getPreviewTile$3(),Jx.isNonEmptyString(r)?(People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUILoadVideoTileStart),this._image$3.isDelayed=true,this._image$3.isOneByOneError=true,this._image$3.addListener("imagefailed",this._onImageFailed$3,this),this._image$3.addListener("imageloaded",this._onImageLoaded$3,this),this._image$3.source=r,(this._image$3.isDimensionsAvailable||this._state$3!=null)&&(this._applyColumnLayout$3(),this._setImageSize$3(),this._adjustTextHeight$3())):(this._image$3.isVisible=false,this._imageOverlay$3.isVisible=false,this.addClass("ra-itemVideoNoTile"),this._setIsTileLoaded$3(true)))};People.RecentActivity.UI.Feed.VideoEntryControl.prototype.onLoadElement=function(n){People.RecentActivity.UI.Feed.EntryControl.prototype.onLoadElement.call(this,n);this.addClass("ra-itemVideo");this._isTileLoaded$3=this.isMarkupInitialized&&this.hasClass("ra-itemVideoTileLoaded")};People.RecentActivity.UI.Feed.VideoEntryControl.prototype.onOrientationChanged=function(){this.isRendered&&(this._applyColumnLayout$3(),this._setImageSize$3(),this._adjustTextHeight$3());People.RecentActivity.UI.Feed.EntryControl.prototype.onOrientationChanged.call(this)};People.RecentActivity.UI.Feed.VideoEntryControl.prototype.onFixedHeightChanged=function(){var n=this.setTemporaryVisibility();this._adjustTextHeight$3();this._preview$3.offsetHeight>this._element$3.clientHeight&&(this._image$3.isVisible=false,this._imageOverlay$3.isVisible=false);People.RecentActivity.UI.Feed.EntryControl.prototype.onFixedHeightChanged.call(this);this.restoreTemporaryVisibility(n)};People.RecentActivity.UI.Feed.VideoEntryControl.prototype.onFixedWidthChanged=function(){this._applyColumnLayout$3();People.RecentActivity.UI.Feed.EntryControl.prototype.onFixedWidthChanged.call(this)};People.RecentActivity.UI.Feed.VideoEntryControl.prototype.getAriaContentLabel=function(){var n=this.entry.data;return Jx.isNonEmptyString(n.text)?Jx.res.loadCompoundString("/strings/raItemContentVideoLabel",n.text,n.title,n.caption,n.description):n.tile+" "+n.caption+" "+n.description};People.RecentActivity.UI.Feed.VideoEntryControl.prototype.getContentHeight=function(){var i=this.setTemporaryVisibility(),r=this._image$3.isVisible,n,t;return this._image$3.isVisible=true,n=WinJS.Utilities.getTotalHeight(this._element$3),this._image$3.isVisible=r,this._isTileLoaded$3||this.isFixedWidth||(t=this._image$3.height,n+=t<=1?325:t),this.restoreTemporaryVisibility(i),n};People.RecentActivity.UI.Feed.VideoEntryControl.prototype.getState=function(){if(this.isLoaded){var n=People.RecentActivity.UI.Feed.EntryControl.prototype.getState.call(this);return n.s=this._state$3,n}return null};People.RecentActivity.UI.Feed.VideoEntryControl.prototype.setState=function(n){this._state$3=n!=null?n.s:null;People.RecentActivity.UI.Feed.EntryControl.prototype.setState.call(this,n)};People.RecentActivity.UI.Feed.VideoEntryControl.prototype._setIsColumnLayout$3=function(n){n!==this._isColumnLayout$3&&(this._isColumnLayout$3=n,this._isColumnLayout$3?this.addClass("ra-itemVideoColumns"):this.removeClass("ra-itemVideoColumns"))};People.RecentActivity.UI.Feed.VideoEntryControl.prototype._setIsTileLoaded$3=function(n){n!==this._isTileLoaded$3&&(this._isTileLoaded$3=n,this._isTileLoaded$3?this.addClass("ra-itemVideoTileLoaded"):this.removeClass("ra-itemVideoTileLoaded"))};People.RecentActivity.UI.Feed.VideoEntryControl.prototype._getPreviewTile$3=function(){for(var s=this.entry,i=s.data,u=People.RecentActivity.Configuration.videoUrlTransforms,f=[i.displayUrl,i.sourceUrl],t,o,r,n=0,e=f.length;n<e;n++)for(t=0,o=u.length;t<o;t++)if(r=u[n].createPreviewUrl(f[t]),Jx.isNonEmptyString(r))return this._isTransformed$3=true,r;return i.tile};People.RecentActivity.UI.Feed.VideoEntryControl.prototype._setImageSize$3=function(){var r;this.ensureFrameRendered();var u=this._image$3.element,n=u.style,f=this._imageOverlay$3.element.style,e=this._imageOverlay$3.element.getComputedStyle().direction==="ltr"?"left":"right";if(this._state$3!=null){n.height=this._state$3.h;n.width=this._state$3.w;f[e]="calc("+this._state$3.w+" - 68px)";f.top="calc("+this._state$3.h+" - 68px)";return}var o=this.setTemporaryVisibility(),i=this._image$3.height,t=this._image$3.width;this.isFixedWidth?(t=u.clientHeight/i*t,i=u.clientHeight,n.width=t+"px"):(n.height=i+"px",n.width=t+"px",r=u.offsetWidth,r!==0&&r<t&&(i=r/t*i,t=r,n.height=i+"px",n.width=t+"px"));f[e]=t-68+"px";f.top=i-68+"px";this.restoreTemporaryVisibility(o);this._state$3=People.RecentActivity.UI.Feed.create_videoEntryState(this._isColumnLayout$3,n.width,n.height)};People.RecentActivity.UI.Feed.VideoEntryControl.prototype._adjustTextHeight$3=function(){this.orientation===1?this._text$3.removeClass("ra-itemVideoTextFixed"):this._text$3.addClass("ra-itemVideoTextFixed")};People.RecentActivity.UI.Feed.VideoEntryControl.prototype._applyColumnLayout$3=function(){this._state$3!=null&&this._state$3.i||this.isFixedWidth||this.orientation===1||this._image$3.width>180?this._setIsColumnLayout$3(false):this._setIsColumnLayout$3(true)};People.RecentActivity.UI.Feed.VideoEntryControl.prototype._onImageFailed$3=function(){if(this._isTransformed$3){this._isTransformed$3=false;var n=this.entry,t=n.data;this._image$3.source=t.tile}else People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUILoadVideoTileStop),this._setIsTileLoaded$3(true),this._image$3.removeListenerSafe("imagefailed",this._onImageFailed$3,this),this._image$3.removeListenerSafe("imageloaded",this._onImageLoaded$3,this),this._image$3.isVisible=false,this._imageOverlay$3.isVisible=false,this.addClass("ra-itemVideoNoTile"),this.isRendered&&this.onRenderingEnded()};People.RecentActivity.UI.Feed.VideoEntryControl.prototype._onImageLoaded$3=function(){People.RecentActivity.Core.EtwHelper.writeUnofficialEvent(People.RecentActivity.Core.EtwEventName.unofficialUILoadVideoTileStop);this._setIsTileLoaded$3(true);this._image$3.removeListenerSafe("imagefailed",this._onImageFailed$3,this);this._image$3.removeListenerSafe("imageloaded",this._onImageLoaded$3,this);this._applyColumnLayout$3();this._state$3=null;this._setImageSize$3();this.isRendered&&(this._adjustTextHeight$3(),this.onRenderingEnded())};People.RecentActivity.UI.Feed.VideoEntryControl.prototype._onTitleClicked$3=function(n){var i=this.entry,t=i.data;People.RecentActivity.UI.Core.UriHelper.launchUri(t.displayUrl||t.sourceUrl);n.cancelBubble=true};People.RecentActivity.UI.Feed.FeedLayout=function(n,t){this._lastResult$1=new People.RecentActivity.Core.ResultInfo(People.RecentActivity.Core.ResultCode.success);this._lastItemIndex$1=-1;People.RecentActivity.UI.Core.Control.call(this,t);this._identity$1=n;var i=People.RecentActivity.UI.Core.HtmlHelper.createElement(People.RecentActivity.UI.Core.Html.feedLayout);this.appendChild(i);this._errors$1=new People.RecentActivity.UI.Core.ErrorMessageControl(this._identity$1,People.RecentActivity.UI.Core.ErrorMessageContext.whatsNew,People.RecentActivity.UI.Core.ErrorMessageOperation.read);this._errors$1.render();this._contentErrors$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(i,"layout-errors");this._contentErrors$1.isVisible=false;this._contentErrors$1.appendControl(this._errors$1);this._psa$1=new People.RecentActivity.UI.Core.PsaUpsellControl;this._psa$1.render();this._contentPsa$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(i,"layout-psa");this._contentPsa$1.isVisible=false;this._contentPsa$1.appendControl(this._psa$1)};Jx.inherit(People.RecentActivity.UI.Feed.FeedLayout,People.RecentActivity.UI.Core.Control);People.RecentActivity.UI.Feed.FeedLayout._hydrationVersion$1=8;People.RecentActivity.UI.Feed.FeedLayout._hydrationRefreshTimeout$1=36e5;People.RecentActivity.UI.Feed.FeedLayout._settingKey$1="whatsNewPreferredNetwork";People.RecentActivity.UI.Feed.FeedLayout.prototype._identity$1=null;People.RecentActivity.UI.Feed.FeedLayout.prototype._content$1=null;People.RecentActivity.UI.Feed.FeedLayout.prototype._contentList$1=null;People.RecentActivity.UI.Feed.FeedLayout.prototype._seeMoreStatus$1=null;People.RecentActivity.UI.Feed.FeedLayout.prototype._contentPsa$1=null;People.RecentActivity.UI.Feed.FeedLayout.prototype._contentErrors$1=null;People.RecentActivity.UI.Feed.FeedLayout.prototype._listview$1=null;People.RecentActivity.UI.Feed.FeedLayout.prototype._listviewMap$1=null;People.RecentActivity.UI.Feed.FeedLayout.prototype._commandRefresh$1=null;People.RecentActivity.UI.Feed.FeedLayout.prototype._commandPost$1=null;People.RecentActivity.UI.Feed.FeedLayout.prototype._network$1=null;People.RecentActivity.UI.Feed.FeedLayout.prototype._feed$1=null;People.RecentActivity.UI.Feed.FeedLayout.prototype._hydrationData$1=null;People.RecentActivity.UI.Feed.FeedLayout.prototype._hydrationItemId$1=null;People.RecentActivity.UI.Feed.FeedLayout.prototype._hydrationMarkupId$1=null;People.RecentActivity.UI.Feed.FeedLayout.prototype._psa$1=null;People.RecentActivity.UI.Feed.FeedLayout.prototype._errors$1=null;People.RecentActivity.UI.Feed.FeedLayout.prototype._initialized$1=false;People.RecentActivity.UI.Feed.FeedLayout.prototype._refreshing$1=false;People.RecentActivity.UI.Feed.FeedLayout.prototype._commandsRendered$1=false;People.RecentActivity.UI.Feed.FeedLayout.prototype._hasSeeMoreFailed$1=false;People.RecentActivity.UI.Feed.FeedLayout.prototype._isSeeMoreScenario$1=false;People.RecentActivity.UI.Feed.FeedLayout.prototype._latestState$1=null;People.RecentActivity.UI.Feed.FeedLayout.prototype._addEntriesRequested$1=false;Object.defineProperty(People.RecentActivity.UI.Feed.FeedLayout.prototype,"feed",{get:function(){return this._feed$1}});Object.defineProperty(People.RecentActivity.UI.Feed.FeedLayout.prototype,"listView",{get:function(){return this._listview$1}});Object.defineProperty(People.RecentActivity.UI.Feed.FeedLayout.prototype,"canRequestMoreEntries",{get:function(){return Jx.log.write(4,People.Social.format("FeedLayout::CanRequestMoreEntries(feed!= null: {0}, initialized: {1}, isRefreshing: {2}, hasMoreEntries: {3}, isGettingMoreEntries: {4}, hasSeeMOreFailed: {5})",this._feed$1!=null,this._feed$1!=null&&this._feed$1.initialized,this._feed$1!=null&&this._feed$1.isRefreshing,this._feed$1!=null&&this._feed$1.hasMoreEntries,this._feed$1!=null&&this._feed$1.isGettingMoreEntries,this._hasSeeMoreFailed$1)),this._feed$1!=null&&this._feed$1.initialized&&!this._feed$1.isRefreshing&&this._feed$1.hasMoreEntries&&!this._feed$1.isGettingMoreEntries&&!this._hasSeeMoreFailed$1}});People.RecentActivity.UI.Feed.FeedLayout.prototype.getAnimationData=function(){return People.RecentActivity.Imports.create_contentAnimationData([[this._psa$1.element,this._errors$1.element]],null)};People.RecentActivity.UI.Feed.FeedLayout.prototype.hasFilter=function(){return this._identity$1.isWhatsNew&&this._identity$1.capabilities.canShowWhatsNew&&this._network$1!=null&&this._identity$1.networks.count>2};People.RecentActivity.UI.Feed.FeedLayout.prototype.getCurrentFilterName=function(){return this._network$1.name};People.RecentActivity.UI.Feed.FeedLayout.prototype.getFilterItems=function(){var i,n;var r=[],u=this._identity$1.networks,t=u.aggregatedNetwork;for(t!=null&&r.push(People.RecentActivity.Core.create_flyoutItemDescriptor(t.id,t.name,t.id===this._network$1.id,this._createFilterCallback$1(t))),i=0;i<u.count;i++)n=u.item(i),n.isAggregatedNetwork||r.push(People.RecentActivity.Core.create_flyoutItemDescriptor(n.id,n.name,n.id===this._network$1.id,this._createFilterCallback$1(n)));return r};People.RecentActivity.UI.Feed.FeedLayout.prototype.initialize=function(n,t,i){var r=n,u;r!=null&&r.v!==8&&(r=null);this._hydrationData$1=r;this._hydrationItemId$1=t;this._hydrationMarkupId$1=i;u=this._identity$1.capabilities;u.addListener("propertychanged",this._onCapabilitiesPropertyChanged$1,this);u.canShowWhatsNew&&this._initializeInternal$1()};People.RecentActivity.UI.Feed.FeedLayout.prototype.getState=function(){var n=this._latestState$1;return this._listview$1!=null&&n==null&&(n=this._listview$1.getState()),People.RecentActivity.UI.Feed.create_feedLayoutHydrationData(8,n,(new Date).getTime())};People.RecentActivity.UI.Feed.FeedLayout.prototype.getItemState=function(n){if(this._listview$1!=null){var i=this._listview$1.getItemStates(n),t=this._getStateId$1();try{return window.localStorage.setItem(t,JSON.stringify(i)),t}catch(r){Jx.log.write(2,"Failed to save state to local storage: "+r.toString());try{window.localStorage.removeItem(t)}catch(u){Jx.log.write(2,"Failed to remove old state too! "+u.toString())}}}return null};People.RecentActivity.UI.Feed.FeedLayout.prototype.getMarkupState=function(){if(this._listview$1!=null){var n=this._getStateId$1();return window.sessionStorage.setItem(n,JSON.stringify(this._listview$1.getMarkupState())),n}return null};People.RecentActivity.UI.Feed.FeedLayout.prototype.resetScrollPosition=function(){this._listview$1!=null&&(this._listview$1.scrollPosition=0)};People.RecentActivity.UI.Feed.FeedLayout.prototype.refresh=function(){this._onRefreshClicked$1(null)};People.RecentActivity.UI.Feed.FeedLayout.prototype.onLayoutChanged=function(n){this._listview$1!=null&&(this._listview$1.orientation=this._getListViewOrientation$1(n))};People.RecentActivity.UI.Feed.FeedLayout.prototype.onDisposed=function(){var n,i,t;if(People.RecentActivity.UI.Core.SnapManager.removeControl(this),People.RecentActivity.UI.Core.KeyboardRefresher.removeControl(this),People.RecentActivity.UI.Core.EventManager.events.removeListenerSafe("windowresized",this._onWindowResized$1,this),this._network$1=null,this._commandRefresh$1=null,this._commandPost$1=null,this._lastResult$1=null,this._identity$1!=null&&this._identity$1.capabilities.removeListenerSafe("propertychanged",this._onCapabilitiesPropertyChanged$1,this),this._disposeFeed$1(),this._content$1!=null&&(this._content$1.dispose(),this._content$1=null),this._contentErrors$1!=null&&(this._contentErrors$1.dispose(),this._contentErrors$1=null),this._contentList$1!=null&&(this._contentList$1.dispose(),this._contentList$1=null),this._seeMoreStatus$1!=null&&(this._seeMoreStatus$1.dispose(),this._seeMoreStatus$1=null),this._listview$1!=null&&(this._listview$1.removeListenerSafe("editscompleted",this._onListEditsCompleted$1,this),this._listview$1.removeListenerSafe("moreitemsrequested",this._onMoreItemsRequested$1,this),this._listview$1.dispose(),this._listview$1=null),this._listviewMap$1!=null){for(n in this._listviewMap$1)i={key:n,value:this._listviewMap$1[n]},t=i.value,t.removeListenerSafe("clicked",this._onEntryClicked$1,this),t.dispose();People.Social.clearKeys(this._listviewMap$1);this._listviewMap$1=null}this._contentPsa$1!=null&&(this._contentPsa$1.dispose(),this._contentPsa$1=null);this._psa$1!=null&&(this._psa$1.dispose(),this._psa$1=null);this._errors$1!=null&&(this._errors$1.dispose(),this._errors$1=null);People.RecentActivity.UI.Core.Control.prototype.onDisposed.call(this)};People.RecentActivity.UI.Feed.FeedLayout.prototype.onRendered=function(){var n=this.element;this._content$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(n,"layout-content");this._contentList$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(n,"layout-list");this._initializeListView$1();this._seeMoreStatus$1=new People.RecentActivity.UI.Feed.SeeMoreStatusPanel(People.RecentActivity.UI.Core.HtmlHelper.findElementById(n,"layout-seemore"),this);this._seeMoreStatus$1.render();this._seeMoreStatus$1.isVisible=false;this._listview$1.render();this._checkReadyState$1();People.RecentActivity.UI.Core.KeyboardRefresher.addControl(this);this._addEntriesRequested$1&&(this._addEntries$1(this._feed$1.entries.toArray(),0),this._addEntriesRequested$1=false);People.RecentActivity.UI.Core.Control.prototype.onRendered.call(this)};People.RecentActivity.UI.Feed.FeedLayout.prototype._detachFeedEvents$1=function(){this._feed$1!=null&&(this._feed$1.entries.removeListenerSafe("collectionchanged",this._onEntryCollectionChanged$1,this),this._feed$1.removeListenerSafe("ensureuptodatecompleted",this._onEnsureUpToDateCompleted$1,this),this._feed$1.removeListenerSafe("initializecompleted",this._onInitializeCompleted$1,this),this._feed$1.removeListenerSafe("refreshcompleted",this._onRefreshCompleted$1,this),this._feed$1.removeListenerSafe("getmoreentriescompleted",this._onGetMoreEntriesCompleted$1,this))};People.RecentActivity.UI.Feed.FeedLayout.prototype._disposeFeed$1=function(){this._detachFeedEvents$1();this._feed$1=null};People.RecentActivity.UI.Feed.FeedLayout.prototype._initializeListView$1=function(){var i=this._contentList$1.element,t,n;if(this._listviewMap$1={},this._listview$1=new People.RecentActivity.UI.Feed.StackingListViewControl(i,this._getListViewOrientation$1(People.RecentActivity.UI.Core.SnapManager.currentLayout)),this._listview$1.addListener("editscompleted",this._onListEditsCompleted$1,this),this._listview$1.addListener("moreitemsrequested",this._onMoreItemsRequested$1,this),this._hydrationData$1!=null&&this._listview$1.setState(this._hydrationData$1.s),Jx.isNonEmptyString(this._hydrationItemId$1))try{t=window.localStorage.getItem(this._hydrationItemId$1);n=JSON.parse(t);n!=null&&this._listview$1.setItemStates(n)}catch(r){}if(Jx.isNonEmptyString(this._hydrationMarkupId$1))try{t=window.sessionStorage.getItem(this._hydrationMarkupId$1);n=JSON.parse(t);n!=null&&this._listview$1.setMarkupState(n)}catch(r){}People.RecentActivity.UI.Core.SnapManager.addControl(this);People.RecentActivity.UI.Core.EventManager.events.addListener("windowresized",this._onWindowResized$1,this)};People.RecentActivity.UI.Feed.FeedLayout.prototype._renderCommands$1=function(){var n=Jx.root.getCommandBar();this._commandRefresh$1=new People.Command("ra-refresh","/strings/raRefresh","/strings/raRefreshTooltip","",true,this._feed$1!=null&&this._feed$1.initialized,null,this._onRefreshClicked$1.bind(this));n.addCommand(this._commandRefresh$1);this._identity$1.isWhatsNew&&this._identity$1.capabilities.canShare&&(this._commandPost$1=new People.Command("ra-post","/strings/raPost","/strings/raPostTooltip","",true,this._feed$1!=null&&this._feed$1.initialized,null,this._onPostClicked$1.bind(this)),n.addCommand(this._commandPost$1))};People.RecentActivity.UI.Feed.FeedLayout.prototype._setContentVisibility$1=function(){if(this.isRendered&&!this._isSeeMoreScenario$1)if(this._contentErrors$1.isVisible=false,this._contentPsa$1.isVisible=false,this._identity$1.capabilities.canShowWhatsNew){var n=this._feed$1.initialized;n&&!this._feed$1.entries.count?(this._contentErrors$1.isVisible=true,this._contentList$1.isVisible=false,this._errors$1.location=People.RecentActivity.UI.Core.ErrorMessageLocation.inline,this._lastResult$1.code===People.RecentActivity.Core.ResultCode.success?this._errors$1.showType(People.RecentActivity.UI.Core.ErrorMessageType.empty):this._errors$1.show(this._lastResult$1)):(this._contentList$1.isVisible||(this._contentList$1.isVisible=true),this._errors$1.location=People.RecentActivity.UI.Core.ErrorMessageLocation.messageBar,this._errors$1.show(this._lastResult$1))}else this._contentPsa$1.isVisible=true,this._contentList$1.isVisible=false};People.RecentActivity.UI.Feed.FeedLayout.prototype._setCommandButtonsVisibility$1=function(){if(this.isRendered&&this._initialized$1){this._commandsRendered$1||(this._renderCommands$1(),this._commandsRendered$1=true);var n=Jx.root.getCommandBar();this._feed$1.initialized&&this._identity$1.capabilities.canShowWhatsNew?(n.showCommand(this._commandRefresh$1.commandId),this._commandPost$1!=null&&n.showCommand(this._commandPost$1.commandId)):(n.hideCommand(this._commandRefresh$1.commandId),this._commandPost$1!=null&&n.hideCommand(this._commandPost$1.commandId));n.refresh()}};People.RecentActivity.UI.Feed.FeedLayout.prototype._addEntries$1=function(n,t){this._listview$1.beginEdits();for(var i=0,r=n.length;i<r;i++)this._addEntry$1(n[i],t++);this._listview$1.endEdits()};People.RecentActivity.UI.Feed.FeedLayout.prototype._addEntry$1=function(n,t){if(Jx.isUndefined(this._listviewMap$1[n.id])){var i=null;switch(n.entryType){case People.RecentActivity.FeedEntryType.text:i=new People.RecentActivity.UI.Feed.TextEntryControl(n);break;case People.RecentActivity.FeedEntryType.link:i=new People.RecentActivity.UI.Feed.LinkEntryControl(n);break;case People.RecentActivity.FeedEntryType.photo:i=new People.RecentActivity.UI.Feed.PhotoEntryControl(n);break;case People.RecentActivity.FeedEntryType.photoAlbum:i=new People.RecentActivity.UI.Feed.PhotoAlbumEntryControl(n);break;case People.RecentActivity.FeedEntryType.video:i=new People.RecentActivity.UI.Feed.VideoEntryControl(n)}i.addListener("clicked",this._onEntryClicked$1,this);this._listviewMap$1[n.id]=i;this._listview$1.insert(i,t)}};People.RecentActivity.UI.Feed.FeedLayout.prototype._removeEntries$1=function(n){var t,u,i,r;for(this._listview$1.beginEdits(),t=0,u=n.length;t<u;t++)i=n[t],Jx.isUndefined(this._listviewMap$1[i.id])||(r=this._listviewMap$1[i.id],r.removeListenerSafe("clicked",this._onEntryClicked$1,this),this._listview$1.remove(r),delete this._listviewMap$1[i.id]);this._listview$1.endEdits()};People.RecentActivity.UI.Feed.FeedLayout.prototype._checkReadyState$1=function(){this.isRendered&&(People.RecentActivity.Core.EtwHelper.writeFeedEvent(this._hydrationData$1!=null?People.RecentActivity.Core.EtwEventName.uiGetCachedFeedEnd:People.RecentActivity.Core.EtwEventName.uiGetFeedEnd,this._network$1!=null?this._network$1.id:"null",this._network$1!=null?this._network$1.identity.id:"null"),this._setContentVisibility$1(),this._setCommandButtonsVisibility$1())};People.RecentActivity.UI.Feed.FeedLayout.prototype._initializeInternal$1=function(){var n=this._identity$1.networks,t;this._identity$1.isWhatsNew?(t=Jx.appData.localSettings().get("whatsNewPreferredNetwork"),this._network$1=n.findById(t)||n.aggregatedNetwork):this._network$1=n.aggregatedNetwork;this._network$1==null&&(this._network$1=this._identity$1.networks.item(0));this._initializeFeed$1()};People.RecentActivity.UI.Feed.FeedLayout.prototype._initializeFeed$1=function(){var n=this;(this._disposeFeed$1(),this.isDisposed)||(this._feed$1=this._network$1.feed,this._feed$1.entries.addListener("collectionchanged",this._onEntryCollectionChanged$1,this),this._feed$1.addListener("getmoreentriescompleted",this._onGetMoreEntriesCompleted$1,this),People.RecentActivity.Core.BiciHelper.setCurrentPageName(this._identity$1.isWhatsNew?People.RecentActivity.Core.BiciPageNames.whatsNew:People.RecentActivity.Core.BiciPageNames.recentActivity),People.RecentActivity.Core.BiciHelper.createPageViewDatapoint(this._network$1.id),this._initialized$1=true,this._feed$1.initialized?window.msSetImmediate(function(){n.isDisposed||(Jx.log.write(4,"FeedLayout::InitializeFeed: EnsureUpToDate"),n._feed$1.addListener("ensureuptodatecompleted",n._onEnsureUpToDateCompleted$1,n),n._feed$1.ensureUpToDate(n._hydrationData$1==null),n._checkReadyState$1())}):(People.RecentActivity.UI.Core.GlobalProgressControl.add(this),People.RecentActivity.Core.EtwHelper.writeFeedEvent(this._hydrationData$1!=null?People.RecentActivity.Core.EtwEventName.uiGetCachedFeedStart:People.RecentActivity.Core.EtwEventName.uiGetFeedStart,this._network$1.id,this._network$1.identity.id),this._feed$1.entries.count>0&&(this._addEntriesRequested$1=true),window.msSetImmediate(function(){n.isDisposed||(n._feed$1.addListener("initializecompleted",n._onInitializeCompleted$1,n),n._hydrationData$1!=null&&(new Date).getTime()-n._hydrationData$1.t<People.RecentActivity.UI.Feed.FeedLayout._hydrationRefreshTimeout$1?n._feed$1.initializeFromHydration():n._feed$1.initialize())})))};People.RecentActivity.UI.Feed.FeedLayout.prototype._getStateId$1=function(){return this._identity$1.isWhatsNew?"FeedUxState_WN":"FeedUxState_"+this._identity$1.id};People.RecentActivity.UI.Feed.FeedLayout.prototype._createFilterCallback$1=function(n){var t=this;return function(){t._onFilterChanged$1(n)}};People.RecentActivity.UI.Feed.FeedLayout.prototype._onEntryClicked$1=function(){this._latestState$1=this._listview$1.getState();this._listview$1.freeze();this._detachFeedEvents$1()};People.RecentActivity.UI.Feed.FeedLayout.prototype._onWindowResized$1=function(){Jx.log.write(4,"FeedLayout::OnWindowResized()");this._listview$1!=null&&this._listview$1.forceLayout()};People.RecentActivity.UI.Feed.FeedLayout.prototype._onListEditsCompleted$1=function(){var n;this._isClickEatingDivVisible()||(this._listview$1.count>0&&!this._isSeeMoreScenario$1?this._hydrationData$1==null?(Jx.log.write(4,"FeedLayout::OnListEditsCompleted: no hydration data, setting first item active."),this._listview$1.item(0).setActive()):(n=this._listview$1.activeItem,n!=null?(Jx.log.write(4,"FeedLayout::OnListEditsCompleted: setting item active: "+n.index),n.setActive()):(Jx.log.write(4,"FeedLayout::OnListEditsCompleted: setting first item active."),this._listview$1.item(0).setActive())):this._isSeeMoreScenario$1&&(this._lastItemIndex$1!==-1&&(n=this._listview$1.item(this._lastItemIndex$1),this._listview$1.activeItemIndex=this._listview$1.getNextItem(n).index,Jx.log.write(4,"FeedLayout::OnListEditsCompleted(see more case): setting item active: "+this._listview$1.activeItemIndex),this._listview$1.activeItem.setActive(),this._lastItemIndex$1=-1),this._listview$1.resumeScrollListener(),this._seeMoreStatus$1.isVisible=false,this._isSeeMoreScenario$1=false))};People.RecentActivity.UI.Feed.FeedLayout.prototype._onMoreItemsRequested$1=function(){this.canRequestMoreEntries&&(this._seeMoreStatus$1.isVisible=true,this._seeMoreStatus$1.element.style.opacity="",this._seeMoreStatus$1.showProgress(),People.Animation.fadeIn(this._seeMoreStatus$1.element).done(),this._isSeeMoreScenario$1=true,this._feed$1.getMoreEntries())};People.RecentActivity.UI.Feed.FeedLayout.prototype._onGetMoreEntriesCompleted$1=function(n){if(n.count>0||n.result.code===People.RecentActivity.Core.ResultCode.success){if(n.count>0&&this._listview$1.stopScrollListener(),this._seeMoreStatus$1.isActive){var t=this._listview$1.lastItemIndex;n.count?this._lastItemIndex$1=t:(this._listview$1.activeItemIndex=t,this._listview$1.activeItem.setActive())}this._seeMoreStatus$1.element.style.opacity="0";n.count||(this._seeMoreStatus$1.isVisible=false);this._seeMoreStatus$1.showError(n.result,People.RecentActivity.UI.Core.ErrorMessageLocation.messageBar)}else this._hasSeeMoreFailed$1=true,this._seeMoreStatus$1.showError(n.result,People.RecentActivity.UI.Core.ErrorMessageLocation.inline)};People.RecentActivity.UI.Feed.FeedLayout.prototype._onEnsureUpToDateCompleted$1=function(n){this._lastResult$1=n.result;this._feed$1.removeListenerSafe("ensureuptodatecompleted",this._onEnsureUpToDateCompleted$1,this);this._lastResult$1.code===People.RecentActivity.Core.ResultCode.success?(Jx.log.write(4,"FeedLayout::OnEnsureUpToDateCompleted: success"),this._hydrationData$1==null&&this._onRefreshClicked$1(null)):this._checkReadyState$1()};People.RecentActivity.UI.Feed.FeedLayout.prototype._onInitializeCompleted$1=function(n){this._feed$1.removeListenerSafe("initializecompleted",this._onInitializeCompleted$1,this);People.RecentActivity.UI.Core.GlobalProgressControl.remove(this);this._lastResult$1=n.result;this._checkReadyState$1()};People.RecentActivity.UI.Feed.FeedLayout.prototype._onEntryCollectionChanged$1=function(n){if(this.isRendered){switch(n.action){case People.RecentActivity.NotifyCollectionChangedAction.replace:case People.RecentActivity.NotifyCollectionChangedAction.reset:return}this._setContentVisibility$1();switch(n.action){case People.RecentActivity.NotifyCollectionChangedAction.add:this._addEntries$1(n.newItems,n.newItemIndex);break;case People.RecentActivity.NotifyCollectionChangedAction.remove:this._removeEntries$1(n.oldItems)}}};People.RecentActivity.UI.Feed.FeedLayout.prototype._onRefreshCompleted$1=function(n){this._refreshing$1=false;this._feed$1.removeListenerSafe("refreshcompleted",this._onRefreshCompleted$1,this);this._lastResult$1=n.result;People.RecentActivity.UI.Core.GlobalProgressControl.remove(this);n.isUpdated&&(this._listview$1.invalidateStates(),this._lastResult$1.isSuccessOrPartialFailure&&(this._listview$1.scrollPosition=0),this._listview$1.count>0&&this._listview$1.item(0).setActive());this._setContentVisibility$1();People.RecentActivity.Core.EtwHelper.writeFeedEvent(People.RecentActivity.Core.EtwEventName.uiRefreshFeedEnd,this._network$1.id,this._network$1.identity.id)};People.RecentActivity.UI.Feed.FeedLayout.prototype._onPostClicked$1=function(){var n=People.RecentActivity.UI.Core.create_landingPageNavigationData();n.isPostScenario=true;People.Nav.navigate(People.Nav.getMeUri(n))};People.RecentActivity.UI.Feed.FeedLayout.prototype._onRefreshClicked$1=function(){Jx.log.write(4,People.Social.format("FeedLayout::OnRefreshClicked({0},{1},{2})",this.isRendered,this._initialized$1,this._refreshing$1));this.isRendered&&this._initialized$1&&this._feed$1.initialized&&!this._refreshing$1&&(People.RecentActivity.Core.EtwHelper.writeFeedEvent(People.RecentActivity.Core.EtwEventName.uiRefreshFeedStart,this._network$1.id,this._network$1.identity.id),People.RecentActivity.UI.Core.GlobalProgressControl.add(this),this._refreshing$1=true,this._feed$1.addListener("refreshcompleted",this._onRefreshCompleted$1,this),this._feed$1.refresh())};People.RecentActivity.UI.Feed.FeedLayout.prototype._getListViewOrientation$1=function(n){return n==="snapped"?1:0};People.RecentActivity.UI.Feed.FeedLayout.prototype._onCapabilitiesPropertyChanged$1=function(n){var t=n.sender;n.propertyName==="CanShowWhatsNew"&&(t.canShowWhatsNew&&this._initializeInternal$1(),this._setContentVisibility$1(),this._setCommandButtonsVisibility$1())};People.RecentActivity.UI.Feed.FeedLayout.prototype._onFilterChanged$1=function(n){n!==this._network$1&&(this._feed$1!=null&&this._removeEntries$1(this._feed$1.entries.toArray()),this._network$1=n,Jx.appData.localSettings().set("whatsNewPreferredNetwork",n.id),this._initializeFeed$1())},function(){var n=250;People.RecentActivity.UI.Feed.FeedPanel=function(n,t,i){if(People.RecentActivity.Imports.Panel.call(this,null,"ra-feedPanelOuter panelView-snapActivePanel",People.PanelView.PanelPosition.feedPanel),this._controls$1=[],this._hydrationData$1=i,this._identity$1=n,this._lastResult$1=new People.RecentActivity.Core.ResultInfo(People.RecentActivity.Core.ResultCode.success),t!=null){var r=t;this._isPostScenario$1=r.isPostScenario;this._postNetworkSelection$1=this._identity$1.networks.findById(r.postNetworkSelection)}};Jx.inherit(People.RecentActivity.UI.Feed.FeedPanel,People.RecentActivity.Imports.Panel);People.RecentActivity.UI.Feed.FeedPanel.prototype._identity$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._title$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._titleName$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._titleMore$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._content$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._contentShare$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._contentContainer$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._contentEntries$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._contentProgress$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._contentEntriesContainer$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._errors$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._share$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._feed$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._isReady$1=false;People.RecentActivity.UI.Feed.FeedPanel.prototype._isEntriesRendered$1=false;People.RecentActivity.UI.Feed.FeedPanel.prototype._isDisposed$1=false;People.RecentActivity.UI.Feed.FeedPanel.prototype._controls$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._controlsToDispose$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._isInitialized$1=false;People.RecentActivity.UI.Feed.FeedPanel.prototype._hydrationData$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._activeIndex$1=0;People.RecentActivity.UI.Feed.FeedPanel.prototype._activeItem$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._isPostScenario$1=false;People.RecentActivity.UI.Feed.FeedPanel.prototype._postNetworkSelection$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._isAnimating$1=false;People.RecentActivity.UI.Feed.FeedPanel.prototype._isRenderingEntries=false;People.RecentActivity.UI.Feed.FeedPanel.prototype._isUpdatedRequested$1=false;People.RecentActivity.UI.Feed.FeedPanel.prototype._shareHasRichLink$1=false;People.RecentActivity.UI.Feed.FeedPanel.prototype._shareHeight$1=0;People.RecentActivity.UI.Feed.FeedPanel.prototype._currentShareAnimation$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._inputPane$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._inputPaneRect$1=null;People.RecentActivity.UI.Feed.FeedPanel.prototype._focusFirstItem$1=false;People.RecentActivity.UI.Feed.FeedPanel.prototype.activateUI=function(n){var i,t;this._title$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(n,"panel-title");this._title$1.attach("keypress",this._onTitleKeyPress$1.bind(this));this._title$1.attach("click",this._onTitleClicked$1.bind(this));this._titleName$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(n,"panel-title-name");this._titleName$1.id=this._titleName$1.uniqueId;this._titleName$1.text=Jx.res.getString("/strings/raFeedPanelTitle");this._titleMore$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(n,"panel-title-more");this._titleMore$1.id=this._titleMore$1.uniqueId;this._titleMore$1.text=People.RecentActivity.UI.Core.HtmlHelper.isRightToLeft?"":"";People.Animation.addPressStyling(this._title$1.element);this._content$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(n,"panel-content");this._content$1.labelledBy=this._titleName$1.id+" "+this._titleMore$1.id;this._contentContainer$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(n,"panel-content-container");this._contentProgress$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(n,"panel-progress");this._contentEntries$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(n,"panel-entries");this._contentEntriesContainer$1=this._contentProgress$1;this._errors$1=new People.RecentActivity.UI.Core.ErrorMessageControl(this._identity$1,People.RecentActivity.UI.Core.ErrorMessageContext.whatsNew,People.RecentActivity.UI.Core.ErrorMessageOperation.read,People.RecentActivity.UI.Core.HtmlHelper.findElementById(n,"panel-errors"));this._errors$1.render();this._errors$1.isVisible=false;this._contentEntries$1.attach("keydown",this._onKeyDown$1.bind(this));i=this._identity$1.networks.aggregatedNetwork;i==null&&(i=this._identity$1.networks.item(0));this._feed$1=i.feed;this._contentShare$1=People.RecentActivity.UI.Core.HtmlHelper.findOrCreateControlById(n,"panel-share");this._contentShare$1.isVisible=false;this._feed$1.entries.addListener("collectionchanged",this._onEntriesCollectionChanged$1,this);t=this;window.msSetImmediate(function(){t._isDisposed$1||(t._feed$1.initialized?(t._hydrationData$1==null&&(t._feed$1.addListener("refreshcompleted",t._onRefreshCompleted$1,t),t._feed$1.refresh()),t._onReady$1()):(t._feed$1.addListener("initializecompleted",t._onInitializeCompleted$1,t),t._hydrationData$1!=null?t._feed$1.initializeFromHydration():t._feed$1.initialize()))})};People.RecentActivity.UI.Feed.FeedPanel.prototype.deactivateUI=function(){if(this._isDisposed$1=true,People.RecentActivity.UI.Core.EventManager.events.removeListenerSafe("windowresized",this._onWindowResized$1,this),this._identity$1=null,this._activeItem$1=null,this._lastResult$1=null,this._currentShareAnimation$1!=null&&(this._currentShareAnimation$1.cancel(),this._currentShareAnimation$1=null),this._inputPane$1!=null){this._inputPane$1.removeListenerSafe("showing",this._onInputPaneShowing$1,this);this._inputPane$1.removeListenerSafe("hiding",this._onInputPaneHiding$1,this);this._inputPane$1.dispose();this._inputPane$1=null;this._inputPaneRect$1=null;var n=document.querySelector(".panelView-viewport");n&&(n.style.marginTop=null)}this._feed$1!=null&&(this._feed$1.removeListenerSafe("initializecompleted",this._onInitializeCompleted$1,this),this._feed$1.removeListenerSafe("refreshcompleted",this._onRefreshCompleted$1,this),this._feed$1.entries.removeListenerSafe("collectionchanged",this._onEntriesCollectionChanged$1,this),this._feed$1=null);this._controls$1!=null&&(this._disposeControls$1(this._controls$1),this._controls$1=null);this._controlsToDispose$1!=null&&(this._disposeControls$1(this._controlsToDispose$1),this._controlsToDispose$1=null);this._share$1!=null&&(this._share$1.removeListenerSafe("propertychanged",this._onSharePropertyChanged$1,this),this._share$1.removeListenerSafe("completed",this._onShareCompleted$1,this),this._share$1.dispose(),this._share$1=null);this._contentShare$1!=null&&(this._contentShare$1.dispose(),this._contentShare$1=null);this._content$1!=null&&(this._content$1.dispose(),this._content$1=null);this._contentEntriesContainer$1!=null&&(this._contentEntriesContainer$1.dispose(),this._contentEntriesContainer$1=null);this._contentEntries$1!=null&&(this._contentEntries$1.dispose(),this._contentEntries$1=null);this._contentProgress$1!=null&&(this._contentProgress$1.dispose(),this._contentProgress$1=null);this._errors$1!=null&&(this._errors$1.dispose(),this._errors$1=null);this._contentContainer$1!=null&&(this._contentContainer$1.dispose(),this._contentContainer$1=null);this._title$1!=null&&(this._title$1.dispose(),this._title$1=null);this._titleName$1!=null&&(this._titleName$1.dispose(),this._titleName$1=null);this._titleMore$1!=null&&(this._titleMore$1.dispose(),this._titleMore$1=null)};People.RecentActivity.UI.Feed.FeedPanel.prototype.getUI=function(){return People.RecentActivity.UI.Core.Html.feedPanel};People.RecentActivity.UI.Feed.FeedPanel.prototype.ready=function(){this._isReady$1=true;this._onReady$1();People.RecentActivity.UI.Core.EventManager.events.addListener("windowresized",this._onWindowResized$1,this)};People.RecentActivity.UI.Feed.FeedPanel.prototype.suspend=function(){return{}};People.RecentActivity.UI.Feed.FeedPanel.prototype.onLayoutChanged=function(n){Jx.log.write(4,"FeedPanel.OnLayoutchanged: "+n);this._onReady$1()};People.RecentActivity.UI.Feed.FeedPanel.prototype._disposeControls$1=function(n){for(var t=0,i=n.length;t<i;t++)n[t].dispose();n.length=0};People.RecentActivity.UI.Feed.FeedPanel.prototype._renderEntries$1=function(){var f,u,e,o,s,h,t;if(!this._isEntriesRendered$1&&this._contentContainer$1.isVisible){if(this._isAnimating$1||this._isRenderingEntries){this._isUpdatedRequested$1=true;return}this._isRenderingEntries=true;var c=this._feed$1.entries,i=null,r=null,l=c.count;if(l>0){for(this._isEntriesRendered$1=true,this._controlsToDispose$1=Array.apply(null,this._controls$1),this._controls$1.length=0,i=People.RecentActivity.UI.Core.HtmlHelper.createElement(People.RecentActivity.UI.Core.Html.feedPanelEntries),i.style.opacity="0",r=new People.RecentActivity.UI.Core.Control(i),r.appendChild(document.createElement("div")),this._contentEntries$1.appendControl(r),f=WinJS.Utilities.getContentHeight(i),u=[],e=0,o=1;!this._controls$1.length||e<l&&f>=n;e++,o++)s=this._renderEntry$1(r,c.item(e),o),s.role="option",h=s.contentHeightPixels,u.push(h+"px"),f-=h;t=this._controls$1.length;f<0&&t>1&&(this._controls$1[t-1].removeFromParent(),this._controls$1[t-1].dispose(),this._controls$1.splice(t-1,1),u.splice(t-1,1),t--);u.splice(t-1,1);u.push("1fr");i.style.msGridRows=u.join(" ");i.removeChild(i.lastChild);this._controls$1[t-1].isFixedHeight=true}else if(this._isInitialized$1)this._errors$1.location=People.RecentActivity.UI.Core.ErrorMessageLocation.inline,this._lastResult$1.code===People.RecentActivity.Core.ResultCode.success?this._errors$1.showType(People.RecentActivity.UI.Core.ErrorMessageType.empty):this._errors$1.show(this._lastResult$1),r=this._errors$1;else{this._isRenderingEntries=false;return}this._animateEntries$1(r)}};People.RecentActivity.UI.Feed.FeedPanel.prototype._animateEntries$1=function(n){this._isAnimating$1=true;var i=null,t=this;i=this._contentEntriesContainer$1.isVisible?People.Animation.fadeOut(this._contentEntriesContainer$1.element):WinJS.Promise.wrap(null);i.then(function(){return t._isDisposed$1?null:(t._contentEntriesContainer$1.removeFromParent(),t._contentEntriesContainer$1=n,t._contentEntries$1.appendControl(n),t._contentEntriesContainer$1.isVisible=true,People.Animation.fadeIn(t._contentEntriesContainer$1.element))});i.done(function(){return t._isAnimating$1=false,t._isRenderingEntries=false,t._isDisposed$1||(t._controlsToDispose$1!=null&&t._disposeControls$1(t._controlsToDispose$1),t._focusFirstItem$1&&(t._activeItem$1.focus(),t._focusFirstItem$1=false),t._isUpdatedRequested$1&&(t._isEntriesRendered$1=false,t._isUpdatedRequested$1=false,t._renderEntries$1())),null})};People.RecentActivity.UI.Feed.FeedPanel.prototype._renderEntry$1=function(n,t,i){var r,u;r=null;switch(t.entryType){case People.RecentActivity.FeedEntryType.link:r=new People.RecentActivity.UI.Feed.LinkEntryControl(t);break;case People.RecentActivity.FeedEntryType.photo:r=new People.RecentActivity.UI.Feed.PhotoEntryControl(t);break;case People.RecentActivity.FeedEntryType.text:r=new People.RecentActivity.UI.Feed.TextEntryControl(t);break;case People.RecentActivity.FeedEntryType.video:r=new People.RecentActivity.UI.Feed.VideoEntryControl(t);break;case People.RecentActivity.FeedEntryType.photoAlbum:r=new People.RecentActivity.UI.Feed.PhotoAlbumEntryControl(t)}return this._controls$1.push(r),r.loadElement(),n.insertControlBeforeChild(r,n.element.lastChild),r.isFixedWidth=true,r.load(),r.render(),u=r.element,u.style.msGridRow=i.toString(),i===1&&(u.tabIndex=0,this._activeIndex$1=0,this._activeItem$1=r),r};People.RecentActivity.UI.Feed.FeedPanel.prototype._onReady$1=function(){if(this._isReady$1){if(this._identity$1.capabilities.canShare&&this._share$1==null){this._contentShare$1.isVisible=true;this._share$1=new People.RecentActivity.UI.Share.ShareControl(this._identity$1,this._feed$1);this._share$1.addListener("propertychanged",this._onSharePropertyChanged$1,this);this._share$1.addListener("completed",this._onShareCompleted$1,this);this._contentShare$1.appendControl(this._share$1);var n=this;this._share$1.render().then(function(){n._isPostScenario$1&&n._hydrationData$1==null&&(n._share$1.focus(),n._postNetworkSelection$1&&n._share$1.selectNetwork$1(n._postNetworkSelection$1))});this._shareHeight$1=WinJS.Utilities.getContentHeight(this._contentShare$1.element);this._inputPane$1=new People.RecentActivity.UI.Core.InputManager;this._inputPane$1.addListener("showing",this._onInputPaneShowing$1,this);this._inputPane$1.addListener("hiding",this._onInputPaneHiding$1,this)}this._renderEntries$1();this._errors$1.isVisible=false;this._controls$1.length>0&&(this._errors$1.location=People.RecentActivity.UI.Core.ErrorMessageLocation.messageBar,this._errors$1.show(this._lastResult$1))}};People.RecentActivity.UI.Feed.FeedPanel.prototype._navigateToFull$1=function(){this._identity$1.isTemporary?People.Nav.navigate(People.Nav.getViewRAUri(null,this._identity$1.getDataContext())):People.Nav.navigate(People.Nav.getViewRAUri(this._identity$1.id,null))};People.RecentActivity.UI.Feed.FeedPanel.prototype._resizeShareControl$1=function(){if(this._share$1!=null){if(this._shareHasRichLink$1&&this._contentContainer$1.isVisible){var n=this,t=this._contentContainer$1.element;this._currentShareAnimation$1=People.Animation.fadeOut(t);this._currentShareAnimation$1.done(function(){return n._currentShareAnimation$1=null,n._isDisposed$1||(t.style.opacity="",n._contentEntriesContainer$1.isVisible=false,n._contentContainer$1.isVisible=false,n._content$1.addClass("ra-panelContentExpandShare"),n._adjustForInputPane$1()),null})}else this._shareHasRichLink$1||this._contentContainer$1.isVisible||(this._content$1.removeClass("ra-panelContentExpandShare"),this._adjustForInputPane$1(),this._contentContainer$1.isVisible=true,this._isEntriesRendered$1=false,this._onReady$1());this._adjustForInputPane$1()}};People.RecentActivity.UI.Feed.FeedPanel.prototype._adjustForInputPane$1=function(){if(this._share$1!=null){var r=this._contentShare$1.element,n=r.style,e=document.querySelector(".panelView-viewport"),t=e.style;if(this._inputPaneRect$1!=null){n.height=null;t.marginTop=null;var u=WinJS.Utilities.getPosition(r),f=window.screen.height-this._inputPaneRect$1.height,o=u.top+this._shareHeight$1,i=f-o;i>0&&(i<=100||this._shareHasRichLink$1)?(n.height=f-u.top+"px",t.marginTop=null):i<0&&(t.marginTop=i+"px",n.height=this._shareHeight$1+"px")}else this._inputPaneRect$1==null&&(n.height=null,t.marginTop=null);this._share$1.refreshSize()}};People.RecentActivity.UI.Feed.FeedPanel.prototype._onTitleKeyPress$1=function(n){(n.keyCode===WinJS.Utilities.Key.enter||n.keyCode===WinJS.Utilities.Key.space)&&this._navigateToFull$1()};People.RecentActivity.UI.Feed.FeedPanel.prototype._onTitleClicked$1=function(){this._navigateToFull$1()};People.RecentActivity.UI.Feed.FeedPanel.prototype._onInitializeCompleted$1=function(n){this._isInitialized$1=true;this._lastResult$1=n.result;this._onReady$1()};People.RecentActivity.UI.Feed.FeedPanel.prototype._onRefreshCompleted$1=function(n){this._lastResult$1=n.result;this._isInitialized$1=true;this._onReady$1()};People.RecentActivity.UI.Feed.FeedPanel.prototype._onEntriesCollectionChanged$1=function(n){(n.newItemIndex>-1&&n.newItemIndex<this._controls$1.length||n.oldItemIndex>-1&&n.oldItemIndex<this._controls$1.length||n.action===People.RecentActivity.NotifyCollectionChangedAction.reset)&&(this._isEntriesRendered$1=false,this._onReady$1())};People.RecentActivity.UI.Feed.FeedPanel.prototype._onKeyDown$1=function(n){var i,t;if(i=this._controls$1.length,i){switch(n.keyCode){case WinJS.Utilities.Key.downArrow:this._activeIndex$1++;break;case WinJS.Utilities.Key.upArrow:this._activeIndex$1--;break;default:return}this._activeItem$1.element.tabIndex=-1;this._activeIndex$1=Math.min(Math.max(0,this._activeIndex$1),this._controls$1.length-1);this._activeItem$1=this._controls$1[this._activeIndex$1];t=this._activeItem$1.element;t.tabIndex=0;t.focus();n.preventDefault()}};People.RecentActivity.UI.Feed.FeedPanel.prototype._onSharePropertyChanged$1=function(n){var t=n.sender;switch(n.propertyName){case"HasRichLink":this._shareHasRichLink$1=t.hasRichLink;this._resizeShareControl$1()}};People.RecentActivity.UI.Feed.FeedPanel.prototype._onShareCompleted$1=function(n){n===People.RecentActivity.Core.ResultCode.success&&this._activeItem$1!=null&&(this._focusFirstItem$1=true)};People.RecentActivity.UI.Feed.FeedPanel.prototype._onInputPaneShowing$1=function(n){n.ensuredFocusedElementInView=true;this._inputPaneRect$1=n.occludedRect;this._resizeShareControl$1()};People.RecentActivity.UI.Feed.FeedPanel.prototype._onInputPaneHiding$1=function(n){n.ensuredFocusedElementInView=true;this._inputPaneRect$1=null;this._resizeShareControl$1()};People.RecentActivity.UI.Feed.FeedPanel.prototype._onWindowResized$1=function(){this._isEntriesRendered$1=false;this._resizeShareControl$1();this._onReady$1()}}()})