(function(){"use strict";function n(n){Jx.mark("WorkerWindow."+n+",StartTA,WorkerWindow")}function t(n){Jx.mark("WorkerWindow."+n+",StopTA,WorkerWindow")}var r=Mail.Worker,i;window.addEventListener("DOMContentLoaded",function(){n("DOMContentLoaded");window.workerWindow=new i;t("DOMContentLoaded")},false);window.addEventListener("beforeunload",function(){n("beforeunload");window.workerWindow.dispose();t("beforeunload")},false);i=function(){var u,i,r;n("ctor");Jx.init({bici:false,launch:false,loc:false,perfTools:false});Jx.initGlomManager();this._initialized=false;this._scrubber=null;this._selection=null;this._platform=null;Mail.Globals.appSettings=new Mail.AppSettings;u=this._disposer=new Mail.Disposer;i=Jx.glomManager.getParentGlom();u.addMany(new Mail.EventHook(i,"shutdown",this._onShutdown,this),new Mail.EventHook(i,"start",this._onStart,this),new Mail.EventHook(i,"pause",this._onPause,this),new Mail.EventHook(i,"resume",this._onUnPause,this),new Mail.EventHook(i,"accountChanged",this._onSelectionChanged,this),new Mail.EventHook(i,"viewChanged",this._onSelectionChanged,this),new Mail.EventHook(i,"messageChanged",this._onSelectionChanged,this));r=Jx.activation;u.addMany(new Mail.EventHook(r,r.suspending,this._onSuspend,this),new Mail.EventHook(r,r.resuming,this._onResume,this));this._initialize();t("ctor")};i.prototype={dispose:function(){n("dispose");this._disposer.dispose();t("dispose")},_initialize:function(){if(!this._initialized){var i=getMailPlatform();this._platform=this._disposer.add(i);n("_onInit");i.mailManager.setMailVisible(false);this._initialized=true;this._selection=this._disposer.add(new r.Selection(i));t("_onInit")}},_onShutdown:function(){n("_onShutdown");this.dispose();t("_onShutdown");window.close()},_onStart:function(){n("_onStart");this._scrubber||(this._scrubber=this._disposer.add(new r.PreemptiveScrubber(this._platform,this._selection)));this._scrubber.resume();t("_onStart")},_onPause:function(){n("_onPause");this._scrubber&&this._scrubber.pause();t("_onPause")},_onUnPause:function(){n("_onUnPause");this._scrubber&&this._scrubber.resume();t("_onUnPause")},_onSelectionChanged:function(n){this._selection.onSelectionChanged(n)},_onSuspend:function(){n("_onSuspend");this._platform.suspend();Jx.glomManager.pauseMessages();t("_onSuspend")},_onResume:function(){n("_onResume");this._platform.resume();Jx.glomManager.resumeMessages();t("_onResume")}}})()