(function(){"use strict";window.addEventListener("beforeunload",function(){Mail.errorOccurred||(Mail.log("Mail_beforeunload",Mail.LogEvent.start),Jx.app.shutdownUI(),Mail.log("Mail_beforeunload",Mail.LogEvent.stop),Jx.app.shutdown())},false);window.addEventListener("error",function(n){Jx.log&&(Jx.log.info("Mail.errorOccurred set to true."),Jx.log.error("Unhandled exception: "+n.message+"\n  file: "+n.filename+"\n  line: "+n.lineno+"\n  column: "+n.colno));Jx.app.shutdownLog();Mail.errorOccurred=true},false)})();Jx.delayDefine(Mail,"BaseApp",function(){"use strict";var t=Mail.BaseApp=function(n){Mail.log("App_Ctor",Mail.LogEvent.start);this._name="Mail.BaseApp";this.initComponent();this._platform=Mail.Globals.platform=n;this._appState=null;this._shareHandler=null;Object.defineProperty(Mail.Globals,"appState",{get:this._getAppState.bind(this),enumerable:true});this._settings=Mail.Globals.appSettings=new Mail.AppSettings;this._postStartupQueue=null;Mail.log("App_Ctor",Mail.LogEvent.stop)},n;Jx.augment(t,Jx.Component);n=t.prototype;n._getAppState=function(){return this._appState};n._buildFrame=function(n){Mail.log("App_Ctor_Children",Mail.LogEvent.start);this._appState=n;this._frame=new Mail.CompFrame(this._platform,n);this.appendChild(this._frame);Mail.log("App_Ctor_Children",Mail.LogEvent.stop);Jx.app.initUI(document.getElementById(Mail.CompApp.rootElementId))};n.getUI=function(n){Mail.log("App_getUI",Mail.LogEvent.start);var t=Jx.getUI(this.getChild(0));n.html=t.html;Mail.log("App_getUI",Mail.LogEvent.stop)};n._onCommandsRequested=function(n){this._settingsPane=new Mail.CompSettingsPane;this.appendChild(this._settingsPane);var t=n.target;this._settingsPane.activateUI(t);this._settingsPane.appendCommands(n.request.applicationCommands);this._commandRequestedHook.dispose()};n.activateUI=function(){Jx.Component.prototype.activateUI.call(this);Jx.res.processAll(document.documentElement);Mail.log("Mail_Register_Settings_Command",Mail.LogEvent.start);this._commandRequestedHook=new Mail.EventHook(Windows.UI.ApplicationSettings.SettingsPane.getForCurrentView(),"commandsrequested",this._onCommandsRequested,this);Mail.log("Mail_Register_Settings_Command",Mail.LogEvent.stop)};n.deactivateUI=function(){Jx.Component.prototype.deactivateUI.call(this);Jx.dispose(this._commandRequestedHook);Jx.dispose(this._postStartupQueue)};n.shutdownComponent=function(){Jx.Component.prototype.shutdownComponent.call(this);Jx.dispose(this._platform);this._platform=null;Jx.dispose(this._appState);this._appState=null;Jx.dispose(this._shareHandler);this._shareHandler=null;Jx.dispose(Mail.Globals.appSettings)}})