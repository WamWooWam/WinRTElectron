Jx.delayDefine(Mail,"StartupHelper",function(){"use strict";function i(n){Jx.mark("Mail.StartupHelper:"+n)}function u(n){Jx.mark("Mail.StartupHelper."+n+",StartTA,Mail,StartupHelper")}function r(n){Jx.mark("Mail.StartupHelper."+n+",StopTA,Mail,StartupHelper")}var t=Mail.StartupHelper=function(){this._localSettings=Jx.appData.localSettings().container("Mail.StartupHelper");this._restartAppOnDialogDismissed=false;this._isAccountDialogOpened=false;this._isOAuthFlowOpened=false;this.clearFirstRunFlag=this.clearFirstRunFlag.bind(this)},n;t._StorageName={firstRunFlag:"mail-firstRunFlag"};n=t.prototype;n.clearFirstRunFlag=function(){this._localSettings.set(Mail.StartupHelper._StorageName.firstRunFlag,"0")};n.dispose=function(){this.clearFirstRunFlag()};n.restart=function(){if(u("restart"),this._isAccountDialogOpened||this._isOAuthFlowOpened){this._restartAppOnDialogDismissed=true;i("restart - skipped because account dialog is open");r("restart");return}var n=Mail.Globals.splashScreen;n.prepareForRestart();requestAnimationFrame(function(){i("restart-callback");window.location.reload()});r("restart")};n.onAccountDialogOpened=function(){this._isAccountDialogOpened=true};n.onAccountDialogClosed=function(n){if(this._isAccountDialogOpened=false,!n&&this._restartAppOnDialogDismissed){this.restart();return}this._restartAppOnDialogDismissed=false};n.onOAuthFlowOpened=function(){this._isOAuthFlowOpened=true};n.onOAuthFlowClosed=function(n){if(this._isOAuthFlowOpened=false,!this._isAccountDialogOpened&&!n&&this._restartAppOnDialogDismissed){this.restart();return}this._restartAppOnDialogDismissed=false};Object.defineProperty(n,"isFirstRun",{get:function(){var n=this._localSettings.get(Mail.StartupHelper._StorageName.firstRunFlag);return!Jx.isNonEmptyString(n)},enumerable:true})})