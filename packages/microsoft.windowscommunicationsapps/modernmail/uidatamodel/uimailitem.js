Jx.delayDefine(Mail.UIDataModel,"MailItem",function(){"use strict";function i(n){t.innerText=n;return t.innerHTML}var n=Mail.UIDataModel,t;n.MailItem=function(){};Jx.inherit(n.MailItem,Mail.PlatformEventForwarder);n.MailItem.prototype._initMailItem=function(t){this._platformObject=t;this._propertyCache=new n.CachedProperties(this._platformObject);this._propertyCache.add("subject","subjectHTML",this._generateSubjectHTML,this);this.initForwarder(t)};n.MailItem.prototype._getHeaderRecipientStringHelper=function(n,t){Mail.writeProfilerMark("MailItem.getHeaderRecipientString - "+n,Mail.LogEvent.start);var i="";if(t.length>0)try{i=t.map(function(t){return t[n]}).join("; ")}catch(r){Jx.fault("UIMailItem.js","_getHeaderRecipientStringHelper:"+n,r);Jx.terminateApp(r)}else i=this.headerNoRecipientsString;return Mail.writeProfilerMark("MailItem.getHeaderRecipientString - "+n,Mail.LogEvent.stop),i};n.MailItem.prototype._getHeaderRecipientString=function(n){return this._getHeaderRecipientStringHelper(n,this.headerRecipients)};n.MailItem.prototype._getFromRecipientString=function(n){return this._getHeaderRecipientStringHelper(n,this.fromRecipientArray)};Object.defineProperty(n.MailItem.prototype,"headerRecipients",{get:function(){Mail.writeProfilerMark("MailItem.headerRecipients",Mail.LogEvent.start);var n=[];return n=this.isOutboundFolder?this.to:this.fromRecipientArray,Mail.writeProfilerMark("MailItem.headerRecipients",Mail.LogEvent.stop),n},enumerable:true});Object.defineProperty(n.MailItem.prototype,"fromRecipientArray",{get:function(){Mail.writeProfilerMark("MailItem.fromRecipient",Mail.LogEvent.start);var n=[],t=this.from;return Jx.isObject(t)&&n.push(t),Mail.writeProfilerMark("MailItem.fromRecipient",Mail.LogEvent.stop),n},enumerable:true});Object.defineProperty(n.MailItem.prototype,"fastHeaderRecipientsString",{get:function(){return this._getHeaderRecipientString("fastName")},enumerable:true});Object.defineProperty(n.MailItem.prototype,"fastFromRecipientsString",{get:function(){return this._getFromRecipientString("fastName")},enumerable:true});Object.defineProperty(n.MailItem.prototype,"slowHeaderRecipientsString",{get:function(){return this.isOutboundFolder?this.toRecipientString:this.fromRecipientString},enumerable:true});n.MailItem.prototype._getSubjectString=function(){var r=this._platformObject,n=r.subject.trim(),t,i;return Jx.isNonEmptyString(n)||(n=Jx.res.getString("mailUIMailMessageNoSubject")),this.calendarRequest&&!this.isOutboundFolder&&(t=Jx.res.getString("mailUIMailMessageCalendarInvitePrefix"),i=Jx.res.getString("mailUIMailMessageCalendarInvitationPrefix"),n.substring(0,i.length)!==i&&(n.substring(0,t.length)===t&&(n=n.slice(t.length,n.length)),n=i+" "+n)),n};Object.defineProperty(n.MailItem.prototype,"subject",{get:function(){return this._getSubjectString()},enumerable:true});Object.defineProperty(n.MailItem.prototype,"objectId",{get:function(){return this._platformObject.objectId},enumerable:true});Object.defineProperty(n.MailItem.prototype,"instanceNumber",{get:function(){return this._platformObject.instanceNumber},enumerable:true});t=document.createElement("div");n.MailItem.prototype._generateSubjectHTML=function(){var n=this.subject;return Jx.isNonEmptyString(n)&&(n=i(n.trim().replace(/[\n\r]+/g,function(){return" "}))),n};Object.defineProperty(n.MailItem.prototype,"subjectHTML",{get:function(){return this._propertyCache.get("subjectHTML")},enumerable:true});Object.defineProperty(n.MailItem.prototype,"bestDateShortString",{get:function(){return Mail.Utilities.getShortDateString(this.bestDate)},enumerable:true});Object.defineProperty(n.MailItem.prototype,"bestDateLongString",{get:function(){return Mail.Utilities.getAbbreviatedDateString(this.bestDate)},enumerable:true});Object.defineProperty(n.MailItem.prototype,"lastVerb",{get:function(){return this._platformObject.lastVerb},enumerable:true});Object.defineProperty(n.MailItem.prototype,"importance",{get:function(){return this._platformObject.importance},enumerable:true});Object.defineProperty(n.MailItem.prototype,"hasOrdinaryAttachments",{get:function(){return this._platformObject.hasOrdinaryAttachments},enumerable:true});Object.defineProperty(n.MailItem.prototype,"irmHasTemplate",{get:function(){return this._platformObject.irmHasTemplate},enumerable:true});n.MailItem.convertVectorToArray=function(n){return n.slice()};Object.defineProperty(n.MailItem.prototype,"to",{get:function(){return n.MailItem.convertVectorToArray(this._platformObject.toRecipients)},enumerable:true});Object.defineProperty(n.MailItem.prototype,"from",{get:function(){return this._platformObject.fromRecipient},enumerable:true});Object.defineProperty(n.MailItem.prototype,"pendingRemoval",{get:function(){return!this._platformObject.isObjectValid},enumerable:true});Object.defineProperty(n.MailItem.prototype,"headerNoRecipientsString",{get:function(){return Jx.res.getString(this.isOutboundFolder?"mailUIMailMessageNoRecipients":"mailUIMailMessageNoSender")},enumerable:true});Object.defineProperty(n.MailItem.prototype,"selectable",{get:function(){return true},enumerable:true});Object.defineProperty(n.MailItem.prototype,"isOutboundFolder",{get:function(){return false},enumerable:true});Object.defineProperty(n.MailItem.prototype,"read",{get:function(){return false},set:function(){},enumerable:true});Object.defineProperty(n.MailItem.prototype,"flagged",{get:function(){return false},set:function(){},enumerable:true});Object.defineProperty(n.MailItem.prototype,"totalCount",{get:function(){return 0},enumerable:true});Object.defineProperty(n.MailItem.prototype,"preview",{get:function(){return""},enumerable:true});Object.defineProperty(n.MailItem.prototype,"previewHTML",{get:function(){return""},enumerable:true});Object.defineProperty(n.MailItem.prototype,"bestDate",{get:function(){return Date.now()},enumerable:true});Object.defineProperty(n.MailItem.prototype,"calendarInvite",{get:function(){return false},enumerable:true});Object.defineProperty(n.MailItem.prototype,"calendarRequest",{get:function(){return false},enumerable:true});Object.defineProperty(n.MailItem.prototype,"folderName",{get:function(){return""},enumerable:true});Object.defineProperty(n.MailItem.prototype,"canFlag",{get:function(){return false},enumerable:true});Object.defineProperty(n.MailItem.prototype,"canDelete",{get:function(){return false},enumerable:true});Object.defineProperty(n.MailItem.prototype,"canMarkRead",{get:function(){return false},enumerable:true});Object.defineProperty(n.MailItem.prototype,"isLocalMessage",{get:function(){return false},enumerable:true});Object.defineProperty(n.MailItem.prototype,"isDraft",{get:function(){return false},enumerable:true});Object.defineProperty(n.MailItem.prototype,"hasDraft",{get:function(){return false},enumerable:true})})