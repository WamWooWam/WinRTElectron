Jx.delayDefine(Mail,"ConcatenatedCollection",function(){"use strict";Mail.ConcatenatedCollection=function(n,t){Mail.Collection.call(this,t||"<concat>");this._collections=n;this.locked=n.every(function(n){return n.locked});this._hook("collectionchanged",this._onCollectionChanged);this.locked&&this._hook("unlocked",this._onCollectionUnlocked)};Jx.inherit(Mail.ConcatenatedCollection,Mail.Collection);Mail.ConcatenatedCollection.prototype.dispose=function(){this._collections&&(this.locked&&this._unhook("unlocked",this._onCollectionUnlocked),this._unhook("collectionchanged",this._onCollectionChanged),this._collections.forEach(Jx.dispose),this._collections=null)};Object.defineProperty(Mail.ConcatenatedCollection.prototype,"count",{get:function(){return this._collections.reduce(function(n,t){return n+t.count},0)}});Mail.ConcatenatedCollection.prototype.item=function(n){for(var i,t=0,r=this._collections.length;t<r;t++){if(i=this._collections[t],n<i.count)return i.item(n);n-=i.count}return null};Mail.ConcatenatedCollection.prototype.unlock=function(){this._collections.forEach(function(n){n.unlock()})};Mail.ConcatenatedCollection.prototype._onCollectionChanged=function(n){n.eType===Microsoft.WindowsLive.Platform.CollectionChangeType.reset?this._handleReset(n):this._handleChange(n)};Mail.ConcatenatedCollection.prototype._handleChange=function(n){for(var i=0,r,t=0,u=this._collections.length;t<u;t++){if(r=this._collections[t],n.target===r)break;i+=r.count}this._raiseChange({eType:n.eType,objectId:n.objectId,previousIndex:n.previousIndex+i,index:n.index+i,removed:n.removed})};Mail.ConcatenatedCollection.prototype._handleReset=function(n){var t=this._collections.reduce(function(t,i){return i===n.target?t.concat(n.removed):t.concat(i.map(function(n){return n}))},[]);this._raiseChange({eType:n.eType,removed:t})};Mail.ConcatenatedCollection.prototype._onCollectionUnlocked=function(){this._unhook("unlocked",this._onCollectionUnlocked);Mail.Collection.prototype.unlock.call(this)};Mail.ConcatenatedCollection.prototype._hook=function(n,t){this._collections.forEach(function(i){i.addListener(n,t,this)},this)};Mail.ConcatenatedCollection.prototype._unhook=function(n,t){this._collections.forEach(function(i){i.removeListener(n,t,this)},this)}})