Jx.delayDefine(Mail,"PlatformEventForwarder",function(){"use strict";var n=Mail.PlatformEventForwarder={};Jx.mix(n,Jx.Events);n.initForwarder=function(t){this.initEvents();this._eventSource=t;this._changedHooks=null;this._deletedHooks=null};n.addListener=function(n,t,i){n!=="changed"||this.hasListener("changed")?n!=="deleted"||this.hasListener("deleted")||this._createDeletedHook():this._createChangedHook();Jx.addListener(this,n,t,i)};n._createChangedHook=function(){this._changedHooks=new Mail.Disposer(new Mail.EventHook(this._eventSource,"changed",this._onPlatformChanged,this))};n._clearChangedHook=function(){Jx.dispose(this._changedHooks);this._changedHooks=null};n._createDeletedHook=function(){this._deletedHooks=new Mail.Disposer(new Mail.EventHook(this._eventSource,"deleted",this._onDeleted,this))};n._clearDeletedHook=function(){Jx.dispose(this._deletedHooks);this._deletedHooks=null};n.removeListener=function(n,t,i){Jx.removeListener(this,n,t,i);n!=="changed"||this.hasListener("changed")?n!=="deleted"||this.hasListener("deleted")||this._clearDeletedHook():this._clearChangedHook()};n._onPlatformChanged=function(n){var t=Array.prototype.slice.call(n);t.target=n.target;this._onChanged(t)};n._onChanged=function(n){this.raiseChanged(n)};n.raiseChanged=function(n){n=n.filter(function(n,t,i){return i.indexOf(n)===t});n.length>0&&(n.target=this,this.raiseEvent("changed",n))};n._onDeleted=function(){this.raiseEvent("deleted",{target:this})}})