Jx.delayDefine(Mail,"BoundElements",function(){"use strict";function n(n,t){this.initComponent();this._view=n;this._properties=t;this._originals=t.map(function(t){return n[t]});this._element=null;this._hook=null;this._job=null;this._active=false}function s(n){return n?"":""}function c(n){var t=o[n];return t||(t=o[n]=Jx.res.getString(n)),t}function l(n){Jx.mark("Mail.ViewFlyout."+n+",StartTA,Mail")}function a(n){Jx.mark("Mail.ViewFlyout."+n+",StopTA,Mail")}var h=Mail.UIDataModel.MailView,u=Mail.BoundElements={},f,r,e,t,i,o;Jx.augment(n,Jx.Component);n.prototype.activateUI=function(){this._active=true;this._job=Jx.scheduler.addJob(null,Mail.Priority.updateView,null,this._subscribe,this)};n.prototype.deactivateUI=function(){Jx.dispose(this._hook);Jx.dispose(this._job);this._element=null;this._active=false};n.prototype.getElement=function(){var n=this._element;return n||(n=this._element=document.getElementById(this._id)),n};n.prototype._subscribe=function(){this._job=null;this._hook=new Mail.EventHook(this._view,"changed",this._onChange,this);this._properties.some(function(n,t){return this._originals[t]!==this._view[n]},this)&&this._updateDisplay()};n.prototype._onChange=function(n){this._job||Mail.Validators.havePropertiesChanged(n,this._properties)&&(this._job=Jx.scheduler.addJob(null,Mail.Priority.updateView,null,function(){this._job=null;this._updateDisplay()},this))};n.prototype._updateDisplay=function(){this._active&&this.getParent().updateLabel()};f=u.ViewName=function(t){n.call(this,t,["name"])};Jx.inherit(f,n);f.prototype.getUI=function(n){n.html="<div id='"+this._id+"' class='name'>"+Jx.escapeHtml(this._view.name)+"<\/div>"};f.prototype._updateDisplay=function(){n.prototype._updateDisplay.call(this);this.getElement().innerText=this._view.name};r=u.ViewCount=function(t){n.call(this,t,["notificationCount"]);this._text="";this._overflow="";this._hidden=false};Jx.inherit(r,n);r.prototype.getUI=function(n){this._updateState();n.html="<div id='"+this._id+"' class='count "+(this._hidden?"hidden":"")+"'><span>"+Jx.escapeHtml(this._text)+"<\/span><span class='plus'>"+Jx.escapeHtml(this._overflow)+"<\/span><\/div>"};r.prototype._updateDisplay=function(){var i,r,u;n.prototype._updateDisplay.call(this);var f=this._text,e=this._overflow,o=this._hidden,t=this.getElement();this._updateState();i=this._hidden;o!==i&&Jx.setClass(t,"hidden",i);r=this._text;f!==r&&(t.firstChild.innerText=r);u=this._overflow;e!==u&&(t.lastChild.innerText=u)};e=999;r.prototype._updateState=function(){var n=this._view.notificationCount;n>0?(this._hidden=false,this._overflow=n>e?"⁺":"",this._text=Math.min(n,e).toString()):(this._hidden=true,this._overflow=this._text="")};t=u.ViewPinner=function(t,i,r){n.call(this,t,["isPinnedToNavPane","name"]);this._lastRenderedState=false;this._pinLabelStringId=i;this._unpinLabelStringId=r};Jx.inherit(t,n);t.prototype.getUI=function(n){var i=this._view,t;i.canChangePinState&&(t=this._lastRenderedState=i.isPinnedToNavPane,n.html="<div id='"+this._id+"' class='star"+(t?" pinned":"")+"' tabIndex='-1' aria-label='"+Jx.escapeHtml(this._getLabel())+"' aria-checked='"+t.toString()+"' title='"+Jx.escapeHtml(this._getTitle())+"' role='checkbox'>"+Jx.escapeHtml(s(t))+"<\/div>")};t.prototype._updateDisplay=function(){var t=this.getElement(),i;t&&(i=this._lastRenderedState=this._view.isPinnedToNavPane,t.innerText=s(i),Mail.setAttribute(t,"aria-label",this._getLabel()),Mail.setAttribute(t,"title",this._getTitle()),Jx.setClass(t,"pinned",i),Mail.setAttribute(t,"aria-checked",i.toString()));n.prototype._updateDisplay.call(this)};t.prototype._getLabel=function(){var n=this._view,t=n.isPinnedToNavPane?this._unpinLabelStringId:this._pinLabelStringId;return Jx.res.loadCompoundString(t,n.name)};t.prototype._getTitle=function(){return c(this._view.isPinnedToNavPane?"mailUnpinViewTitle":"mailPinViewTitle")};t.prototype.onClick=function(n){var t=this.getElement();return n.target===t?(this._pin(!this._view.isPinnedToNavPane),n.stopPropagation(),n.preventDefault(),true):false};t.prototype.onAttributeChange=function(n){var i=this.getElement(),t;n.target===i&&(t=i.getAttribute("aria-checked")==="true",t!==this._lastRenderedState&&this._pin(t))};t.prototype._pin=function(n){var i,t;l("ViewPinner._pin:pin="+n);i=this._view;i.pinToNavPane(n);this._updateDisplay();n&&(t=i.sourceObject,t&&t.objectType==="Folder"&&t.startSyncFolderContents(false));a("ViewPinner._pin:pin="+n)};i=u.ViewTile=function(t){n.call(this,t,["sourceObject"]);this._identityControl=new People.IdentityControl(t.sourceObject,null,{interactive:false})};Jx.inherit(i,n);i.prototype.getUI=function(n){n.html=this._identityControl.getUI(People.IdentityElements.Tile,{className:"tile",size:40,statusIndicator:null})};i.prototype.activateUI=function(){n.prototype.activateUI.call(this);this._identityControl.activateUI()};i.prototype._updateDisplay=function(){this._identityControl.updateDataSource(this._view.sourceObject)};i.prototype.deactivateUI=function(){n.prototype.deactivateUI.call(this);this._identityControl.shutdownUI()};o={}})