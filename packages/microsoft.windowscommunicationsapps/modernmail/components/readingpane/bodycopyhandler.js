Jx.delayDefine(Mail,"BodyCopyHandler",function(){"use strict";var n=Mail.BodyCopyHandler=function(n,t){this._message=n;this._element=t;this._disposer=new Mail.Disposer(new Mail.EventHook(t,"contextmenu",this._onContextMenu,this,true),new Mail.EventHook(t,"copy",this._onCopy,this,true))};n._getClipboard=function(){return Windows.ApplicationModel.DataTransfer.Clipboard};n.prototype={dispose:function(){this._disposer.dispose();this._message=null},_onContextMenu:function(n){if(this._message.irmCanExtractContent)Mail.BodyLinkFlyout.onContextMenu(n)},_onCopy:function(t){var i,r;if(Mail.writeProfilerMark("BodyCopyHandler._onCopy",Mail.LogEvent.start),i=ModernCanvas.Component.prototype.createDataPackageFromSelection(this._element.ownerDocument),i)try{r=n._getClipboard();r.setContent(i)}catch(u){Jx.log.info("Copy failed "+u.toString())}t.preventDefault();Mail.writeProfilerMark("BodyCopyHandler._onCopy",Mail.LogEvent.stop)}}})