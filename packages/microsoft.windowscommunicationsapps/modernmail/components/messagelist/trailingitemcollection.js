Jx.delayDefine(Mail,"TrailingItemCollection",function(){"use strict";var i=Microsoft.WindowsLive.Platform,t=i.CollectionChangeType,n=Mail.TrailingItemCollection=function(n,t){this._collection=n;this._trailingItem=t;this._isTrailingItemVisible=t.visible;this._isProcessingEvents=false;this._hook=new Mail.Disposer(new Mail.EventHook(n,"beginChanges",this._beginChanges,this),new Mail.EventHook(n,"itemAdded",this._forwardEvent.bind(this,"itemAdded"),this),new Mail.EventHook(n,"itemRemoved",this._forwardEvent.bind(this,"itemRemoved"),this),new Mail.EventHook(n,"itemMoved",this._forwardEvent.bind(this,"itemMoved"),this),new Mail.EventHook(n,"reset",this._forwardEvent.bind(this,"reset"),this),new Mail.EventHook(n,"endChanges",this._endChanges,this),new Mail.EventHook(t,"visibilityChanged",this._onTrailingItemVisibilityChanged,this))};Jx.augment(Mail.TrailingItemCollection,Jx.Events);n.prototype.item=function(n){return n===this._collection.count?(Mail.writeProfilerMark("TrailingItemCollection.item - accessing the end of list item"),this._trailingItem):this._collection.item(n)};n.prototype.findIndexByMessageId=function(n,t){return this._collection.findIndexByMessageId(n,t)};n.prototype.dispose=function(){this._trailingItem.dispose();this._trailingItem=null;this._collection.dispose();this._collection=null;this._hook.dispose();this._hook=null};n.prototype.lock=function(){this._collection.lock()};n.prototype.unlock=function(){this._collection.unlock()};n.prototype.getTreeView=function(){return this._collection.getTreeView()};Object.defineProperty(n.prototype,"count",{get:function(){var n=this._isTrailingItemVisible?1:0;return this._collection.count+n},enumerable:true});Object.defineProperty(n.prototype,"mailItems",{get:function(){return this._collection},enumerable:true});n.prototype._beginChanges=function(n){this._isProcessingEvents=true;this.raiseEvent("beginChanges",n)};n.prototype._endChanges=function(n){this._isProcessingEvents=false;this.raiseEvent("endChanges",n)};n.prototype._forwardEvent=function(n,t){this.raiseEvent(n,t)};n.prototype._raiseEvent=function(n,t){this._isProcessingEvents?this.raiseEvent(n,t):(this.raiseEvent("beginChanges"),this.raiseEvent(n,t),this.raiseEvent("endChanges"))};n.prototype._showTrailingItem=function(){if(!this._isTrailingItemVisible){var n={eType:t.itemAdded,index:this._collection.count,previousIndex:0,objectId:this._trailingItem.objectId,data:this._trailingItem};this._raiseEvent("itemAdded",n);this._isTrailingItemVisible=true}};n.prototype._hideTrailingItem=function(){if(this._isTrailingItemVisible){var n={eType:t.itemRemoved,index:this._collection.count,previousIndex:0,objectId:this._trailingItem.objectId,data:this._trailingItem};this._raiseEvent("itemRemoved",n);this._isTrailingItemVisible=false}};n.prototype._onTrailingItemVisibilityChanged=function(){this._trailingItem.visible?this._showTrailingItem():this._hideTrailingItem()}})