Jx.delayDefine(Mail,["EmptyTextControl","SearchEmptyTextControl"],function(){"use strict";function u(n){var r="";switch(n.getSyncStatus()){case i.failed:r="mailMessageListFailedToSync";break;case i.completed:r=t[n.getSyncWindow()];break;case i.offline:r="mailMessageListOfflineStatusText"}return r?Jx.res.getString(r):""}function e(n){return n.getSyncStatus()===i.completed&&f.indexOf(n.getSyncWindow())!==-1?Jx.res.getString("mailMessageListGetOlderMessages"):""}function o(n){return function(t){Mail.AppSettings.openAccountUI(n);t.preventDefault()}}var r=Microsoft.WindowsLive.Platform,n=r.SyncWindowSize,i=Mail.ViewSyncMonitor.SyncStatus,t,f;Mail.EmptyTextControl=function(n,t,i){this._host=n;this._syncMonitor=t;this._lastSyncStatus=null;this._view=i;this._linkHook=null;this._disposer=new Mail.Disposer(new Mail.EventHook(this._syncMonitor,"syncWindowChanged",this._updateEmptyText,this))};Mail.EmptyTextControl.create=function(n,t,i){return i.type===r.MailViewType.allPinnedPeople?new Mail.AllPinnedEmptyTextControl(n,t,i):new Mail.EmptyTextControl(n,t,i)};t=[];t[n.all]="mailMessageListNoMessagesAnyTime";t[n.oneDay]="mailMessageListNoMessagesOneDay";t[n.threeDays]="mailMessageListNoMessagesThreeDays";t[n.oneWeek]="mailMessageListNoMessagesOneWeek";t[n.twoWeeks]="mailMessageListNoMessagesTwoWeeks";t[n.oneMonth]="mailMessageListNoMessagesOneMonth";t[n.threeMonths]="mailMessageListNoMessagesThreeMonths";t[n.sixMonths]="mailMessageListNoMessagesSixMonths";f=[n.oneDay,n.threeDays,n.oneWeek,n.twoWeeks,n.oneMonth,n.threeMonths,n.sixMonths];Mail.EmptyTextControl.prototype.setVisibility=function(n){if(n){var t=this._syncMonitor.getSyncStatus();t!==this._lastSyncStatus&&(this._lastSyncStatus=t,this._updateEmptyText())}Jx.setClass(this._host,"hidden",!n)};Mail.EmptyTextControl.prototype.dispose=function(){this._disposer.dispose();this._disposer=null;this._linkHook=null};Mail.EmptyTextControl.prototype._updateEmptyText=function(){var n,t,i,r;this._disposer.disposeNow(this._linkHook);this._linkHook=null;n=e(this._syncMonitor);t=n?"<a class='mailMessageListSettingsLink' href='' tabIndex='0' role='button'>"+Jx.escapeHtml(n)+"<\/a>":"";this._host.innerHTML="<div><span>"+Jx.escapeHtml(u(this._syncMonitor))+"<\/span>&nbsp;"+t+"<\/div>";n&&(i=this._host.querySelector("a"),r=this._view.account.platformObject,this._linkHook=this._disposer.add(new Mail.EventHook(i,"click",o(r),this)))};Mail.AllPinnedEmptyTextControl=function(n,t,i){this._host=n;this._syncMonitor=t;this._textElement=this._linkElement=null;this._collection=null;this._account=i.account;this._disposer=new Mail.Disposer(new Mail.EventHook(this._syncMonitor,"syncWindowChanged",this._updateEmptyText,this));this._linkHandler=null};Mail.AllPinnedEmptyTextControl.prototype.dispose=function(){Jx.dispose(this._disposer)};Mail.AllPinnedEmptyTextControl.prototype.setVisibility=function(n,t){var u=this._host,f,o,s,e;n||t?(u.classList.remove("hidden"),f=this._textElement,o=this._linkElement,f||(u.innerHTML="<span class='text'><\/span> <a class='mailMessageListSettingsLink' href='' tabIndex='0' role='button'><\/a>",f=this._textElement=u.querySelector(".text"),o=this._linkElement=u.querySelector("a")),Jx.setClass(o,"hidden",t),t?f.innerText=Jx.res.getString("mailMessageListAllPinnedFirstRun"):(s=this._syncMonitor.getSyncStatus(),s!==i.completed||this._collection||(e=this._collection=this._account.queryViews(r.MailViewScenario.navPane),this._disposer.addMany(e,new Mail.EventHook(e,"collectionchanged",this._onCollectionChange,this)),e.unlock()),this._updateEmptyText())):u.classList.add("hidden")};Mail.AllPinnedEmptyTextControl.prototype._onClick=function(n){Mail.PeopleFlyout.pickPeople(this._account);n.stopPropagation();n.preventDefault()};Mail.AllPinnedEmptyTextControl.prototype._onCollectionChange=function(){this._updateEmptyText()};Mail.AllPinnedEmptyTextControl.prototype._updateEmptyText=function(){var n=this._collection,s=false,i=false,t,h,f;if(n)for(t=0,h=n.count;t<h;++t)if(n.item(t).type===r.MailViewType.person){s=true;break}n&&!s?(this._textElement.innerText=Jx.res.getString("mailMessageListAllPinnedEmpty"),this._linkElement.innerText=Jx.res.getString("mailMessageListAllPinnedEmptyLink"),this._linkHandler=this._disposer.replace(this._linkHandler,new Mail.EventHook(this._linkElement,"click",this._onClick,this)),i=true):(this._textElement.innerText=u(this._syncMonitor),f=e(this._syncMonitor),f&&(this._linkElement.innerText=f,this._linkHandler=this._disposer.replace(this._linkHandler,new Mail.EventHook(this._linkElement,"click",o(this._account.platformObject),this)),i=true));Jx.setClass(this._linkElement,"hidden",!i)};Mail.SearchEmptyTextControl=function(n,t,i){this._host=n;this._scopeSwitcher=i;this._account=t.account;this._hook=null};Mail.SearchEmptyTextControl.prototype.setVisibility=function(n){n&&this._activateUI();Jx.setClass(this._host,"hidden",!n)};Mail.SearchEmptyTextControl.prototype.dispose=function(){Jx.dispose(this._hook)};Mail.SearchEmptyTextControl.prototype._getUpsellUI=function(){return this._scopeSwitcher.canUpsell()?"<div><a class='mailMessageListSettingsLink' href='' tabIndex='0'>"+this._scopeSwitcher.upsell.description+"<\/a><\/div>":""};Mail.SearchEmptyTextControl.prototype._activateUI=function(){var n,t;this._activateUI=Jx.fnEmpty;n=this._getUpsellUI();this._host.innerHTML="<div>"+Jx.escapeHtml(Jx.res.getString("mailMessageListEmptySearch"))+"<\/div>"+n;n&&(t=this._host.querySelector("a"),this._hook=new Mail.EventHook(t,"click",this._onInvoke,this))};Mail.SearchEmptyTextControl.prototype._onInvoke=function(n){this._scopeSwitcher.rescopeToUpsell();n.preventDefault()}})