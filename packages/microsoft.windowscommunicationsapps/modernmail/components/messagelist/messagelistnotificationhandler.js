Jx.delayDefine(Mail,"MessageListNotificationHandler",function(){"use strict";var t=Microsoft.WindowsLive.Platform,n=t.CollectionChangeType;Mail.MessageListNotificationHandler=function(n,t,i){this._collection=n;this._notificationHandler=new Mail.ListViewVDSMonitor(n,t,i);n.addListener("beginChanges",this._beginChanges,this);n.addListener("endChanges",this._endChanges,this);n.addListener("itemAdded",this._itemAdded,this);n.addListener("itemRemoved",this._itemRemoved,this);n.addListener("itemMoved",this._itemMoved,this)};Mail.MessageListNotificationHandler.prototype.dispose=function(){this._collection.removeListener("beginChanges",this._beginChanges,this);this._collection.removeListener("endChanges",this._endChanges,this);this._collection.removeListener("itemAdded",this._itemAdded,this);this._collection.removeListener("itemRemoved",this._itemRemoved,this);this._collection.removeListener("itemMoved",this._itemMoved,this);this._collection=null;Jx.dispose(this._notificationHandler);this._notificationHandler=null};Mail.MessageListNotificationHandler.prototype._beginChanges=function(){this._notificationHandler.beginNotifications()};Mail.MessageListNotificationHandler.prototype._endChanges=function(){this._notificationHandler.endNotifications()};Mail.MessageListNotificationHandler.prototype._itemAdded=function(n){var t=this._prepareNotificationParameters(n);this._notificationHandler.inserted(t.item,t.prevKey,t.nextKey,n.index)};Mail.MessageListNotificationHandler.prototype._itemRemoved=function(n){this._notificationHandler.removed(n.objectId)};Mail.MessageListNotificationHandler.prototype._itemMoved=function(n){var t=this._prepareNotificationParameters(n);this._notificationHandler.moved(t.item,t.prevKey,t.nextKey,n.previousIndex,n.index)};Mail.MessageListNotificationHandler.prototype._prepareNotificationParameters=function(t){var r,u,i;return r=null,u=null,t.prevId||t.nextId?t.prevId?r=t.prevId:t.nextId&&(u=t.nextId):(i=t.index,i>0?r=this._collection.item(i-1).objectId:i+1<this._collection.count&&(u=this._collection.item(i+1).objectId)),t.data||(t.data=this._collection.item(t.index)),{item:{key:t.objectId,data:t.data},prevKey:r,nextKey:u}}})