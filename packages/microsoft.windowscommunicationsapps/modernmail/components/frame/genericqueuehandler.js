Jx.delayDefine(Mail,"GenericQueueHandler",function(){"use strict";function t(n){return"mail_genericQueue_"+n}var i=Microsoft.WindowsLive.Platform,r=i.Result,n;Mail.GenericQueueHandler=function(n,t){this._queueType=i.OutboxQueue.sendMail;this._subscribedProperties=["syncStatus"];this._pendingErrorMessages={};this._closeClicked=this._closeClicked.bind(this);this._selection=n;this._platform=t};Jx.inherit(Mail.GenericQueueHandler,Mail.OutboxQueueHandlerBase);n=Mail.GenericQueueHandler.prototype;n.checkForError=function(n,t){if(n.syncStatus!==r.success&&!Mail.Utilities.ConnectivityMonitor.hasNoInternetConnection()){var i=t.objectId,u=this._pendingErrorMessages[i];this._dispatchErrorMessage(n,t);u?u.push(n.objectId):this._pendingErrorMessages[i]=[n.objectId]}};n.removeAccount=function(n){this._removePendingMessages(n,false)};n.removeMessage=function(n){this._messageBar.removeMessage(t(n))};n.dispose=function(){this._baseDispose();this._pendingErrorMessages=null};n._dispatchErrorMessage=function(n,i){var r=t(n.objectId),u={messageText:Mail.Utilities.getSendErrorString(n.syncStatus,i),button1:{text:Jx.res.getString("mailSendErrorGoToMessage"),callback:this._viewInOutbox.bind(this,n.objectId,i)},button2:{text:Jx.res.getString("mailSendErrorClose"),callback:this._closeClicked},cssClass:this._className};this._messageBar.addErrorMessage(r,2,u)};n._removePendingMessages=function(n,i){var r=this._pendingErrorMessages[n];r&&(this._messageBar.removeMessages(r.map(t),i),this._pendingErrorMessages[n]=null)};n._viewInOutbox=function(n,t){var e,u;var f=t.objectId,i=null,r=this._messages[n];r&&(e=r.message,i=n);this._removePendingMessages(f,true);u=new Mail.Account(t,this._platform).outboxView;this._selection.selectMessage(u,i)};n._closeClicked=function(n,t){this._messageBar.removeMessage(t)}})