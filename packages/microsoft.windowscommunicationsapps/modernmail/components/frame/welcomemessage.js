Jx.delayDefine(Mail,"WelcomeMessage",function(){"use strict";var t=Microsoft.WindowsLive.Platform,i=Mail.WelcomeMessage=function(n,t,i,r,u,f){this.initComponent();this._host=n;this._selection=t;this._animator=i;this._settings=r;this._componentsToDisable=u;this._commandManager=f;this._disposer=null;this._content=null},n;Jx.augment(i,Jx.Component);n=i.prototype;n.hasUI=function(){return true};n.onActivateUI=function(){var n=this._selection;this._disposer=new Mail.Disposer(new Mail.EventHook(n,"navChanged",this._onNavChanged,this));this._check(n.account)};n.onDeactivateUI=function(){Jx.dispose(this._disposer)};n._onNavChanged=function(n){this._content&&this._dismiss();n.accountChanged&&this._check(n.target.account)};n._check=function(n){var i,r,u;n&&(i=this._settings,i.dismissedWelcomeMessage||(r=n.platform.accountManager.getConnectedAccountsByScenario(t.ApplicationScenario.mail,t.ConnectedFilter.normal,t.AccountSort.name),u=r.count>1,r.dispose(),u||n.accountType===t.AccountType.imap?i.dismissedWelcomeMessage=true:this._show(n)))};n._show=function(n){this._commandManager.disableCommands("welcomeMessage");this._componentsToDisable.forEach(function(n){n.setEnabled(false)});var t=this._content=new Mail.WelcomeMessageContent(n,this._selection,this._animator);this._host.hostComponent(t)};n._dismiss=function(){var n=this._content;n&&(this._settings.dismissedWelcomeMessage=true,n.close(),this._content=null,this._commandManager.enableCommands("welcomeMessage"),this._componentsToDisable.forEach(function(n){n.setEnabled(true)}))}});Jx.delayDefine(Mail,"WelcomeMessageContent",function(){"use strict";var i=Microsoft.WindowsLive.Platform,t=Mail.WelcomeMessageContent=function(n,t,i){this.initComponent();this._account=n;this._selection=t;this._animator=i;this._element=null;this._hooks=null},n;Jx.augment(t,Jx.Component);n=t.prototype;n.getUI=function(n){n.html="<div id='"+this._id+"' class='welcomeMessage'><div class='welcomeMessageContent'><div class='heading'>"+Jx.escapeHtml(Jx.res.getString("mailFirstRunHeading"))+"<\/div><div class='buttons'>"+[{name:"addAccount",text:"mailFirstRunAddAccountButton"},{name:"inbox",text:"mailFirstRunInboxButton"}].reduce(function(n,t,i){return n+"<button class='"+t.name+(i===0?" defaultButton":"")+" button'>"+Jx.escapeHtml(Jx.res.getString(t.text))+"<\/button>"},"")+"<\/div><\/div><\/div>"};n.onActivateUI=function(){var t=this._element=document.getElementById(this._id),n=t.querySelector(".welcomeMessageContent"),i=n.querySelector(".inbox"),r=n.querySelector(".addAccount");this._hooks=new Mail.Disposer(new Mail.EventHook(i,"click",this._onInboxClick,this),new Mail.EventHook(r,"click",this._onAddAccountClick,this));this._animator.setWelcomeMessageElement(n)};n.onDeactivateUI=function(){Jx.dispose(this._hooks)};n.close=function(){this._animator.setWelcomeMessageElement(null);WinJS.UI.Animation.exitContent(this._element).done(this._cleanup.bind(this))};n._cleanup=function(){var n=this.getParent();n&&n.removeChild(this);this.shutdownUI();this.shutdownComponent()};n._onInboxClick=function(){this._selection.updateNav(this._account,this._account.inboxView)};n._onAddAccountClick=function(n){People.Accounts.showAccountSettingsPage(this._account.platform,i.ApplicationScenario.mail,People.Accounts.AccountSettingsPage.upsells,{launchedFromApp:true});n.preventDefault()}})