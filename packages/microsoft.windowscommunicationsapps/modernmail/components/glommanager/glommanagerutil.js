Jx.delayDefine(Mail,"GlomManagerUtil",function(){Mail.GlomManagerUtil=function(n,t){Jx.EventManager.addListener(Jx.root,"openEml",this._onOpenEml,this);this._glomManager=n;this._selection=t};var n=Mail.GlomManagerUtil.prototype;n.dispose=function(){Jx.EventManager.removeListener(Jx.root,"openEml",this._onOpenEml,this)};n._onOpenEml=function(n){var t=n.data[0],i=Mail.Globals.platform,r=this._selection.account.platformObject,u=Mail.UIDataModel.FolderCache.getPlatformFolder(r,Microsoft.WindowsLive.Platform.MailFolderType.inbox);i.mailManager.createMessageFromMimeAsync(u,t,false).done(function(n){n&&this.openChildMailWindow(n,true)}.bind(this))};n.openChildMailWindow=function(n,t){var i,r,u,e,f;if(Mail.writeProfilerMark("Glom ManagerUtil openChildMailWindow"),Jx.ptStart("Mail-ChildStart"),i=n.getKeepAlive(),i){if(t)if(r=Mail.Globals.platform,u=r.mailManager.loadMessage(i.objectId),u)e=Mail.Account.load(u.accountId,r),Mail.synchronousScrub(r,new Mail.UIDataModel.MailMessage(u,e));else{i.dispose();return}else Mail.guiState.navigateBackward();f={messageId:i.objectId,instanceNumber:n.instanceNumber,isEmlMessage:t,isParentVisible:this._glomManager.getParentVisible()};Jx.isFunction(this._glomManager.addKeepAlive)&&this._glomManager.addKeepAlive(i);Jx.glomManager.createOrShowGlom(f.messageId,f,Jx.GlomManager.ShowType.shareScreen)}}})