Jx.delayDefine(Mail,"CommandBarSelectionHelper",function(){"use strict";var n=Mail.Instrumentation;Mail.CommandBarSelectionHelper=function(){var n,t;this._appBar=null;n=Mail.Globals.commandManager;this._hooks=new Mail.Disposer(new Mail.EventHook(n,Mail.Commands.Events.onAddContext,this._onAddContext,this),new Mail.EventHook(n,Mail.Commands.Events.onRemoveContext,this._onRemoveContext,this));t=n.getContext("composeSelection");t&&this._onAddContext("composeSelection")};Mail.CommandBarSelectionHelper.prototype.activate=function(n){this._appBar=n};Mail.CommandBarSelectionHelper.prototype.dispose=function(){Jx.dispose(this._hooks);this._hooks=null;this._appBar=null};Mail.CommandBarSelectionHelper.prototype._onComposeSelectionChange=function(){var t=Mail.Globals.commandManager,i=t.getContext("composeSelection"),r;i&&(r=i.getSelectionState(),r.hasNonEmptySelection?(t.appBar.appBarSelectionSticky=true,this._appBar.hidden&&(this._appBar.show(),n.instrumentAppBarInvoke(n.AppBarInvokeType.composeSelection))):t.appBar.appBarSelectionSticky&&this._appBar.hide())};Mail.CommandBarSelectionHelper.prototype._onComposeContextMenu=function(t){this._appBar.hidden&&n.instrumentAppBarInvoke(n.AppBarInvokeType.rightClick);this._appBar.toggleVisibility();t.preventDefault()};Mail.CommandBarSelectionHelper.prototype._onAddContext=function(n){if(n==="composeSelection"){var t=Mail.Globals.commandManager.getContext(n);t.addListener("selectionchange",this._onComposeSelectionChange,this);t.addListener("contextmenu",this._onComposeContextMenu,this)}};Mail.CommandBarSelectionHelper.prototype._onRemoveContext=function(n){if(n==="composeSelection"){var t=Mail.Globals.commandManager.getContext(n);t.removeListener("selectionchange",this._onComposeSelectionChange,this);t.removeListener("contextmenu",this._onComposeContextMenu,this)}}})