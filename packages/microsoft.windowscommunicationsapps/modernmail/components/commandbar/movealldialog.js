Jx.delayDefine(Mail,"showMoveAllDialog",function(){"use strict";function r(n,t,i,r){Mail.writeProfilerMark("MoveAllDialog_onMoveAll",Mail.LogEvent.start);n.forEach(function(n){Mail.SweepRules.runMoveAllRule(n.emailAddress,t,i,r)});Mail.writeProfilerMark("MoveAllDialog_onMoveAll",Mail.LogEvent.stop)}var i=Microsoft.WindowsLive.Platform,t=Mail.SweepRules,n=function(n,t){Mail.writeProfilerMark("MoveAllDialogContent_constructor",Mail.LogEvent.start);this._selection=n;this._senders=t;this._chosenView=null;this._confirmButton=null;this._chooseFolderLink=null;this._onChooseFolder=this._onChooseFolder.bind(this);this.initComponent();Mail.writeProfilerMark("MoveAllDialogContent_constructor",Mail.LogEvent.stop)};Jx.augment(n,Jx.Component);n.prototype._getDescription=function(){var i=this._senders,n,t;return i.length===1?(t=i[0],n=Jx.escapeHtmlToSingleLine(Jx.res.loadCompoundString("mailMoveAllDialogMessage",t.calculatedUIName,t.emailAddress))):n=Jx.escapeHtml(Jx.res.getString("mailMoveAllDialogMessagePlural")),n};n.prototype.getUI=function(n){var o=this._getDescription(),s=Jx.escapeHtml(Jx.res.getString("mailMoveAllDialogNoFolder")),h="<button id='moveAllChooseFolderLink'>"+s+"<\/button>",e=t.getScopeFolder(i.MailRuleActionType.move,t.sweepType.moveAll,this._selection.view),r,u,f;e?(f=Mail.UIDataModel.MailFolder.getName(e),r=Jx.res.loadCompoundString("mailMoveAllDialogMoveAllInFolder",f),u=Jx.res.loadCompoundString("mailMoveAllDialogMoveAllFutureInFolder",f)):(r=Jx.res.getString("mailMoveAllDialogMoveAllInAccount"),u=Jx.res.getString("mailMoveAllDialogMoveAllFutureInAccount"));n.html="<div id='moveAllDialogRoot'><div id='dlgDescription' class='moveAllDialogDescription' role='heading'>"+o+"<\/div><label class='mailMoveAllTypeOption' ><input id='mailMoveAllFirstOption' type='radio' value='moveAll' class='mailMoveAllRadio' checked='true' >"+Jx.escapeHtmlToSingleLine(r)+"<\/label><label class='mailMoveAllTypeOption' ><input type='radio' value='moveAllFuture' class='mailMoveAllRadio' >"+Jx.escapeHtmlToSingleLine(u)+"<\/label><label class='mailMoveAllTypeOption' ><input type='radio' value='moveNotMostRecent' class='mailMoveAllRadio' >"+Jx.escapeHtmlToSingleLine(Jx.res.getString("mailMoveAllDialogMoveNotMostRecentInAccount"))+"<\/label><label class='mailMoveAllTypeOption' ><input type='radio' value='moveTenDays' class='mailMoveAllRadio' >"+Jx.escapeHtmlToSingleLine(Jx.res.getString("mailMoveAllDialogMoveOlderInAccount"))+"<\/label><div class='mailMoveAllChooseFolder'>"+Jx.res.loadCompoundString("mailMoveAllDialogFolderChooserWrapper",h)+"<\/div><\/div>"};n.prototype.activateUI=function(){Mail.writeProfilerMark("MoveAllDialogContent_activateUI",Mail.LogEvent.start);this._chooseFolderLink=document.getElementById("moveAllChooseFolderLink");this._chooseFolderLink.addEventListener("click",this._onChooseFolder);Array.prototype.forEach.call(document.querySelectorAll(".mailMoveAllRadio"),function(n){n.name="moveType"});var n=document.getElementById("mailMoveAllFirstOption");Jx.safeSetActive(n);Jx.Component.prototype.activateUI.call(this);Mail.writeProfilerMark("MoveAllDialogContent_activateUI",Mail.LogEvent.stop)};n.prototype.deactivateUI=function(){Mail.writeProfilerMark("MoveAllDialogContent_deactivateUI",Mail.LogEvent.start);this._chooseFolderLink&&this._chooseFolderLink.removeEventListener("click",this._onChooseFolder);Jx.Component.prototype.deactivateUI.call(this);Mail.writeProfilerMark("MoveAllDialogContent_deactivateUI",Mail.LogEvent.stop)};n.prototype._onChooseFolder=function(n){Mail.writeProfilerMark("MoveAllDialogContent_onChooseFolder",Mail.LogEvent.start);n.preventDefault();var t=document.getElementById("moveAllDialogRoot");Mail.MoveFlyout.showMoveAllChooserFlyout(t,this,this._selection);Mail.writeProfilerMark("MoveAllDialogContent_onChooseFolder",Mail.LogEvent.stop)};Object.defineProperty(n.prototype,"chosenView",{get:function(){return this._chosenView},set:function(n){this._chosenView=n;this._chooseFolderLink.innerText=n.name;this._confirmButton&&(this._confirmButton.disabled="")},enumerable:true});Object.defineProperty(n.prototype,"chosenSweepType",{get:function(){var n=document.querySelector(".mailMoveAllRadio:checked");return n?t.sweepType[n.value]:t.sweepType.moveAll},enumerable:true});Object.defineProperty(n.prototype,"confirmButton",{get:function(){return this._confirmButton},set:function(n){this._confirmButton=n},enumerable:true});Mail.showMoveAllDialog=function(i){Mail.writeProfilerMark("MoveAllDialog_showMoveAllDialog",Mail.LogEvent.start);var o=t.getSenders(i),f=new n(i,o),u=new People.Dialog(Jx.res.getString("mailMoveAllDialogTitle"),f),e=new People.DialogButton("idMoveAllConfirm",Jx.res.getString("mailMoveAllDialogConfirm"),"submit");e.addListener("click",function(){var n=f.chosenView,t=f.chosenSweepType;u.close();r(o,i.view,n,t)});u.buttons.push(e);f.confirmButton=e;u.buttons.push(new People.CloseButton("idMoveAllCancel",Jx.res.getString("mailMoveAllDialogCancel"),u));u.show(true)&&(e.disabled="disabled");Mail.writeProfilerMark("MoveAllDialog_showMoveAllDialog",Mail.LogEvent.stop)}})