Jx.delayDefine(Mail.Commands,["Factory","ParentFactory"],function(){"use strict";var n=Mail.Commands,t=n.Contexts,i=Microsoft.WindowsLive.Platform.MailViewType;n.Factory=function(r){n.BaseFactory.call(this);var u=this.commands;u.compose=new n.Item({id:"compose",icon:"",shortcuts:[{control:true,keyCode:Jx.KeyCode.n}],shortcutLabel:"Ctrl+N",shortcutLabelId:"mailCommandComposeToolTip",type:"button",handler:function(n,t){Mail.Utilities.ComposeHelper.onNewButton(t)},enableContext:["accountState","selection"],isEnabled:t.doesAccountSupportMail,dismissAfterInvoke:true});u.move=new n.Item({id:"move",icon:"",shortcuts:[],shortcutLabel:"Ctrl+M",shortcutLabelId:"mailCommandMoveToolTip",labelLocId:"mailCommandMoveLabel",type:"flyout",handler:function(t,i){n.Handlers.onMoveButton(t,i,"move")},enableContext:["selection","guiState"],isEnabled:function(n){return t.nonEmptySelection()&&Mail.ViewCapabilities.canMoveFrom(n.view)&&t.selectionSupportMoving()},dismissAfterInvoke:false});u.moveShortcut=new n.Item({id:"moveShortcut",type:"shortcut",shortcuts:[{control:true,keyCode:Jx.KeyCode.m},{control:true,shift:true,keyCode:Jx.KeyCode.v}],handler:function(t,i){n.Handlers.onMoveButton(t,i,"move")},isEnabled:function(n){return!t.composeInFocus()&&u.move.isEnabled(n)}});u.moveMenu=new n.MenuItem(u.move,{id:"moveMenu",handler:function(t,i){n.Handlers.onMoveButton(t,i,"moreMenu")}});u.sweep=new n.Item({id:"sweep",icon:"",useCustomFont:true,shortcuts:[{control:true,shift:true,keyCode:Jx.KeyCode.s}],shortcutLabel:"Ctrl+Shift+S",shortcutLabelId:"mailCommandSweepToolTip",labelLocId:"mailCommandSweepLabel",type:"flyout",handler:Mail.SweepFlyout.onSweepButton,enableContext:["selection","guiState","isSearching"],isEnabled:function(n){return t.selectedMessagesSupportSweep(n)&&Mail.ViewCapabilities.supportsSweep(n.view)&&!Mail.SearchHandler.isSearchingAllViews},dismissAfterInvoke:false});u.sweepMenu=new n.MenuItem(u.sweep,{id:"sweepMenu"});u.folderOperations=new n.Item({id:"folderOperations",icon:"",useCustomFont:true,shortcuts:[{control:true,shift:true,keyCode:Jx.KeyCode.e}],shortcutLabel:"Ctrl+Shift+E",shortcutLabelId:"mailCommandFolderOperationsToolTip",labelLocId:"mailCommandFolderOperationsLabel",type:"flyout",handler:function(t){n.FolderOperations.onFolderOptionsButton("folderOperations",t)},enableContext:["resourceState","guiState","isSearching","folderChange"],isEnabled:n.FolderOperations.folderOperationsEnabled,dismissAfterInvoke:false});u.folderOperationsMenu=new n.MenuItem(u.folderOperations,{id:"folderOperationsMenu",handler:function(t){n.FolderOperations.onFolderOptionsButton("moreMenu",t)}});u.syncMenu=new n.Item({id:"syncMenu",icon:"",shortcuts:[{keyCode:Jx.KeyCode.f5}],shortcutLabel:"F5",shortcutLabelId:"mailCommandSyncToolTip",labelLocId:"mailCommandSyncLabel",type:"button",handler:n.Handlers.onSyncButton,dismissAfterInvoke:false});u.toggleSelectionMode=new n.ToggleItem({id:"toggleSelectionMode",icon:Jx.isRtl()?"":"",shortcuts:[],shortcutLabelId:{off:"mailCommandEnterSelectionModeToolTip",on:"mailCommandExitSelectionModeToolTip"},labelLocId:"mailCommandSelectionModeLabel",handler:n.Handlers.onToggleSelectionMode,type:"toggle",toggleBackground:true,toggleContext:["selectionMode"],enableContext:["selection","isSearching","guiState"],isEnabled:function(){return t.nonEmptySelection()&&t.supportMultiSelect()&&t.isMessageListActive()},isToggledOn:function(){return Mail.SelectionHandler.isSelectionMode},dismissAfterInvoke:false});u.toggleSelectionModeMenu=new n.ToggleMenuItem(u.toggleSelectionMode,{id:"toggleSelectionModeMenu"});u.pinFolder=new n.Item({id:"pinFolder",shortcuts:[{control:true,shift:true,keyCode:Jx.KeyCode["!"]}],type:"shortcut",handler:n.Handlers.onPinFolder,isEnabled:function(n){return!t.composeInFocus()&&t.showPin(n)&&t.allowFolderOperations(n)},enableContext:["showAppBar","folderChange","pinnedFolder","guiState"]});u.nextMessage=new n.Item({id:"nextMessage",shortcuts:[{control:true,keyCode:Jx.KeyCode.period}],type:"shortcut",handler:n.Handlers.showNextMessage});u.prevMessage=new n.Item({id:"prevMessage",shortcuts:[{control:true,keyCode:Jx.KeyCode[","]}],type:"shortcut",handler:n.Handlers.showPreviousMessage});u.applyAllFilter=new n.Item({id:"applyAllFilter",shortcuts:[{control:true,shift:true,keyCode:Jx.KeyCode.a}],type:"shortcut",handler:n.Handlers.applyAllFilter,isEnabled:t.allowFilterSwitch});u.applyUnreadFilter=new n.Item({id:"applyUnreadFilter",shortcuts:[{control:true,shift:true,keyCode:Jx.KeyCode.u}],type:"shortcut",handler:n.Handlers.applyUnreadFilter,isEnabled:t.allowFilterSwitch});u.reapplyFilter=new n.Item({id:"reapplyFilter",shortcuts:[{keyCode:Jx.KeyCode.f5}],type:"shortcut",handler:n.Handlers.reapplyFilter,isEnabled:t.allowFilterSwitch});u.enterSearch=new n.Item({id:"enterSearch",shortcuts:[{control:true,keyCode:Jx.KeyCode.e}],shortcutLabel:"Ctrl+E",shortcutLabelId:"mailMessageListStartSearchTooltip",type:"shortcut",handler:Mail.SearchHandler.enterSearch,isEnabled:function(){return!Mail.SearchHandler.isSearching&&!Mail.SearchHandler.isSearchHeaderVisible}});u.dismissSearch=new n.Item({id:"dismissSearch",shortcuts:[{keyCode:Jx.KeyCode.escape}],shortcutLabel:"Escape",shortcutLabelId:"mailMessageListCancelSearchTooltip",type:"shortcut",handler:Mail.SearchHandler.dismissSearch,isEnabled:function(){return Mail.SearchHandler.isSearching||Mail.SearchHandler.isSearchHeaderVisible}});u.exitSelectionMode=new n.Item({id:"exitSelectionMode",shortcuts:[{keyCode:Jx.KeyCode.escape}],type:"shortcut",handler:Mail.SelectionHandler.exitSelectionMode,isEnabled:function(){return Mail.SelectionHandler.isSelectionMode}});u.back=new n.Item({id:"back",icon:"",shortcuts:[{alt:true,keyCode:Jx.isRtl()?Jx.KeyCode.rightarrow:Jx.KeyCode.leftarrow},{keyCode:Jx.KeyCode.browserback},{keyCode:Jx.KeyCode.backspace},{keyCode:Jx.KeyCode.escape}],shortcutLabel:Jx.isRtl()?"Alt + RightArrow":"Alt + LeftArrow",shortcutLabelId:"composeAppBarBackTooltip",labelLocId:"mailCommandBackLabel",type:"button",handler:Mail.Globals.animator.animateNavigateBack,dismissAfterInvoke:true});u.newChildWindow=new n.Item({id:"newChildWindow",icon:"",shortcuts:[{control:true,keyCode:Jx.KeyCode.o}],shortcutLabel:"Ctrl+O",shortcutLabelId:"mailNewChildWindowButtonTooltip",labelLocId:"mailNewChildWindowButton",type:"button",handler:function(n){Mail.Commands.Handlers.newChildWindow(n,r.handleCommandBarNewChild.bind(r))},enableContext:["selection","guiState"],isEnabled:t.singleSelection,dismissAfterInvoke:true,noAnimationOnDismiss:true});u.edit=new n.Item({id:"edit",icon:"",shortcuts:[{control:true,keyCode:Jx.KeyCode.t}],shortcutLabel:"Ctrl+T",shortcutLabelId:"mailCommandEditToolTip",type:"button",handler:function(t){n.Handlers.edit(t,r)},enableContext:["guiState","selection"],isEnabled:function(){return t.singleSelection()&&t.selectionSupportsEditCommand()&&t.isReadingPaneActive()},dismissAfterInvoke:true});u.selectMenuSeperator=new n.Item({id:"selectMenuSeperator",shortcuts:[],type:"separator",handler:Jx.fnEmpty,enableContext:["resourceState","guiState","isSearching","folderChange","selection"],isEnabled:function(n){return this.commands.folderOperationsMenu.isEnabled(n)||this.commands.toggleSelectionModeMenu.isEnabled(n)}.bind(this)});u.moveSeparator=new n.Item({id:"moveSeparator",shortcuts:[],type:"separator",handler:Jx.fnEmpty,enableContext:["selection","guiState"],isEnabled:function(n){return this.commands.move.isEnabled(n)||this.commands.sweep.isEnabled(n)||this.commands.unjunkMessages.isEnabled(n)||this.commands.junkMessages.isEnabled(n)}.bind(this)});u.moveMenuSeperator=new n.MenuItem(u.moveSeparator,{id:"moveMenuSeperator"});u.sweepMenuSeperator=new n.Item({id:"sweepMenuSeperator",shortcuts:[],type:"separator",handler:Jx.fnEmpty,enableContext:["selection","guiState"],isEnabled:function(n){return this.commands.sweep.isEnabled(n)}.bind(this)});u.junkMessages=new n.Item({id:"junkMessages",icon:"",useCustomFont:true,shortcuts:[{control:true,keyCode:Jx.KeyCode.j}],labelLocId:"mailCommandJunkLabel",shortcutLabel:"Ctrl+J",shortcutLabelId:"mailCommandJunkToolTip",type:"button",handler:n.Handlers.onJunkButton,enableContext:["guiState","selection"],isEnabled:function(n){return t.nonEmptySelection()&&t.folderSupportsJunkCommand(n)&&t.selectionSupportMoving()&&!t.draftsAreSelected(n)},dismissAfterInvoke:true});u.unjunkMessages=new n.Item({id:"unjunkMessages",icon:"",useCustomFont:true,shortcuts:[{control:true,keyCode:Jx.KeyCode.j}],shortcutLabel:"Ctrl+J",shortcutLabelId:"mailCommandUnjunkToolTip",labelLocId:"mailCommandUnjunkLabel",type:"button",handler:n.Handlers.onUnjunkButton,enableContext:["guiState","selection"],isEnabled:function(n){return t.nonEmptySelection()&&n.view.type===i.junkMail&&t.isMessageListActive()&&t.selectionSupportMoving()&&!t.draftsAreSelected(n)},dismissAfterInvoke:true});u.junkMessagesMenu=new n.MenuItem(u.junkMessages,{id:"junkMessagesMenu"});u.unjunkMessagesMenu=new n.MenuItem(u.unjunkMessages,{id:"unjunkMessagesMenu"});u.feedback=new n.Item({id:"feedback",icon:"",labelLocId:"/strings/sasSurveyHeader",shortcuts:[],type:"button",handler:function(){},enableContext:["sasStatus"],isEnabled:SasManager.commandShown,dismissAfterInvoke:true});u.moreMenu=new n.Item({id:"moreMenu",icon:"more",shortcuts:[],labelLocId:"composeAppBarEllipseLabel",shortcutLabelId:"composeAppBarEllipseLabel",type:"flyout",handler:function(){n.FlyoutHandler.onHostButton("moreMenu","moreMenu")},dismissAfterInvoke:false});u.messageSeparator=new n.Item({id:"messageSeparator",shortcuts:[],type:"separator",handler:Jx.fnEmpty,enableContext:["guiState","selection","flagStatus","readStatus"],isEnabled:function(n){return this.commands.toggleUnread.isEnabled(n)||this.commands.deleteMessage.isEnabled(n)||this.commands.toggleFlag.isEnabled(n)}.bind(this)})};Jx.mix(n.Factory.prototype,n.BaseFactory.prototype);Mail.Commands.ParentFactory=Mail.Commands.Factory})