Jx.delayDefine(Mail,"NavPaneFlyout",function(){"use strict";function u(n){Jx.mark("Mail.NavPaneFlyout."+n+",StartTA,Mail")}function f(n){Jx.mark("Mail.NavPaneFlyout."+n+",StopTA,Mail")}function e(n){Jx.mark("Mail.NavPaneFlyout."+n+",StartTM,Mail")}function o(n){Jx.mark("Mail.NavPaneFlyout."+n+",StopTM,Mail")}function t(n){Mail.writeProfilerMark("Mail.NavPaneFlyout: "+n)}var i={people:{width:320,crossover:540,skinny:200},folders:{width:320,crossover:540,skinny:200},accounts:{width:260,crossover:380,skinny:200}},r=Mail.NavPaneFlyout=function(n,t,r){this.initComponent();this._host=n;this._content=t;this._type=r;this.append(t);this._backgroundElement=this._contentElement=null;this._isVisible=this._desiredVisibility=false;this._hooks=null;this._entryPointHooks=null},n;Jx.augment(r,Jx.Component);n=r.prototype;n.getUI=function(n){n.html="<div id='"+this._id+"' class='navPaneFlyout invisible' role='menuitem' aria-label='"+Jx.escapeHtml(Jx.res.getString("mailCloseFlyout"))+"'><div tabIndex='0' aria-hidden='true'><\/div><div id='content"+this._id+"' class='navPaneFlyoutContent "+this._type+" hidden' role='menu' aria-flowto='"+this._id+"'>"+Jx.getUI(this._content).html+"<\/div><div tabIndex='0' aria-hidden='true'><\/div><\/div>"};n.activateUI=function(){u("activateUI");var n=this._backgroundElement=document.getElementById(this._id);this._contentElement=n.querySelector(".navPaneFlyoutContent");this._hooks=new Mail.Disposer(new Mail.EventHook(n,"focusout",this._onFocusOut,this),new Mail.EventHook(n,"keydown",this._onKeyDown,this),new Mail.EventHook(n,"click",this._onClick,this),new Mail.EventHook(n.firstChild,"focus",this._onFirstFocus,this),new Mail.EventHook(n.lastChild,"focus",this._onLastFocus,this),Mail.EventHook.createEventManagerHook(this,"contentUpdated",this._onContentUpdated,this));Jx.Component.prototype.activateUI.call(this);f("activateUI")};n.deactivateUI=function(){u("deactivateUI");Jx.Component.prototype.deactivateUI.call(this);this._animation&&this._animation.cancel();Jx.dispose(this._hooks);this._hooks=null;f("deactivateUI")};n.setEntryPoint=function(n){var t,i;this._entryPoint!==n&&(this._entryPoint=n,t=null,n&&(i=n.parentElement,t=[new Mail.EventHook(i,"click",this._onEntryPointClick,this,true),new Mail.EventHook(i,"MSPointerDown",this._onEntryPointPointerDown,this,true)]),this._entryPointHooks=this._hooks.replace(this._entryPointHooks,t))};n._onEntryPointPointerDown=function(n){this._isVisible&&Mail.isElementOrDescendant(n.target,this._entryPoint)&&(t("inhibited pointer down"),n.preventDefault())};n._onEntryPointClick=function(n){this._isVisible&&Mail.isElementOrDescendant(n.target,this._entryPoint)&&(t("entry point clicked"),Jx.safeSetActive(this._entryPoint),n.stopPropagation(),n.preventDefault())};n._onKeyDown=function(n){if(n.key==="Esc"){t("escape pressed");var i=this._entryPoint;i&&i.focus();this.hide();n.stopPropagation();n.preventDefault()}};n._onClick=function(n){if(n.target===this._backgroundElement){t("background clicked");var i=this._entryPoint;i&&Jx.safeSetActive(i);this.hide();n.stopPropagation();n.preventDefault()}};n._onFocusOut=function(n){var i=n.relatedTarget,f=this._backgroundElement,u=this._options,r;u&&u.sticky||i&&Mail.isElementOrDescendant(i,f)||(t("lost focus to "+(i?i.id+" "+i.className:"null")),i||(r=this._entryPoint,r&&Jx.safeSetActive(r)),this.hide())};n._onContentUpdated=function(n){n.stage===Jx.EventManager.Stages.bubbling&&document.activeElement===null&&this._setFocus(true,false)};n.show=function(n){return this._options=n,this._showHide(true)};n.hide=function(){return this._options=null,this._showHide(false)};n._showHide=function(n){var i,u,r;return t("requested "+(n?"show":"hide")),u=this._desiredVisibility,u!==n&&(this._desiredVisibility=n,i=this._animation,i||(i=this._animation=this._runAnimation(),r=function(){this._animation=null}.bind(this),i.done(r,r))),Jx.Promise.fork(i)};n._runAnimation=function(){var n=this._desiredVisibility,i,t,u,f,r;return n===this._isVisible?null:(e(n?"show":"hide"),i=this._backgroundElement,t=this._contentElement,Jx.setClass(i,"invisible",!n),n&&(t.classList.remove("hidden"),this._isVisible=true,this._beforeShow()),f=this._getWidth(),r={left:(Jx.isRtl()?f:-f)+"px",top:"0px"},i.style.overflow="",n?u=WinJS.UI.Animation.showEdgeUI(t,r,{mechanism:"transition"}):(t.style.transform="translate("+r.left+", "+r.top+")",u=WinJS.UI.Animation.hideEdgeUI(t,r,{mechanism:"transition"})),Jx.Promise.cancelable(u).then(function(){return i.style.overflow="visible",n||(t.style.transform="",i.style.overflow="",t.classList.add("hidden"),this._isVisible=false,this._afterHide()),o(n?"show":"hide"),this._runAnimation()}.bind(this)))};n._getWidth=function(){var t=this._host.windowWidth,n=i[this._type];return t>=n.crossover?n.width:n.skinny};Object.defineProperty(n,"isVisible",{get:function(){return this._desiredVisibility}});n._beforeShow=function(){t("beforeShow");this._content.beforeShow();var n=this._options;this._placeAbovePeekBar(n&&n.abovePeekBar);this._setFocus(true,n&&n.viaKeyboard)};n._afterHide=function(){t("afterHide");this._placeAbovePeekBar(false);this._content.afterHide()};n._onFirstFocus=function(){t("onFirstFocus");this._setFocus(false,true)};n._onLastFocus=function(){t("onLastFocus");this._setFocus(true,true)};n._setFocus=function(n,i){var f,u,e,r;if(f=this._contentElement.querySelectorAll("[tabIndex='0']"),f)for(u=0,e=f.length;u<e;u++)if(r=f[n?u:e-u-1],t("setting focus to "+r.id+" "+r.className),i?r.focus():Jx.safeSetActive(r),r===document.activeElement)return;t("nothing to focus");this._contentElement.focus()};n._placeAbovePeekBar=function(n){Jx.setClass(this._backgroundElement,"abovePeekBar",n)};n.dispose=function(){var n=this.getParent();n&&n.removeChild(this);this.shutdownUI();this.shutdownComponent()}})