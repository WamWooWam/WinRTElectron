Jx.delayDefine(Mail,"AccountSwitcherAggregator",function(){"use strict";function t(n){return n>999?"999":n}function i(n){return n>999?"⁺":""}Mail.AccountSwitcherAggregator=function(n){Mail.log("AccountSwitcherAggregator_Ctor",Mail.LogEvent.start);this.initComponent();this._accounts=n;this._disposer=new Mail.Disposer(Mail.ItemDemux.createHook(n,this._onAccountChanged,this),new Mail.EventHook(n,"collectionchanged",this._onAccountsCollectionChanged,this));Mail.log("AccountSwitcherAggregator_Ctor",Mail.LogEvent.stop)};Jx.augment(Mail.AccountSwitcherAggregator,Jx.Component);var n=Mail.AccountSwitcherAggregator.prototype;n.shutdownComponent=function(){Jx.dispose(this._disposer);Jx.Component.prototype.shutdownComponent.call(this)};n.getUI=function(n){var r=this._unseenInboxCount();n.html="<div id='"+this._id+"' class='accountSwitcherAggregator"+(this._hasError()?" showError":"")+(r>0?" showUnseenInbox":"")+(this._hasUnseenFav()?" showUnseenFav":"")+"' tabIndex='-1'><div class='aggregatedError icon-acError'><\/div><div class='aggregatedUnseenInbox'><span class='unseenCount'>"+t(r)+"<\/span><span class='unseenPlus'>"+i(r)+"<\/span><\/div><div class='aggregatedUnseenFav'><\/div><\/div>"};n._onAccountChanged=function(n){var t=document.getElementById(this._id);t&&(Mail.Validators.hasPropertyChanged(n,"unseenInboxCount")&&this._updateUnseenInbox(t),Mail.Validators.hasPropertyChanged(n,"hasUnseenFav")&&this._updateUnseenFav(t),Mail.Validators.hasPropertyChanged(n,"hasError")&&this._updateErrorState(t))};n._onAccountsCollectionChanged=function(n){var i=Microsoft.WindowsLive.Platform.CollectionChangeType,t;(n.eType===i.itemRemoved||n.eType===i.itemAdded||n.eType===i.reset)&&(t=document.getElementById(this._id),t&&(this._updateUnseenInbox(t),this._updateUnseenFav(t),this._updateErrorState(t)))};n._updateUnseenInbox=function(n){var r=this._unseenInboxCount();Jx.setClass(n,"showUnseenInbox",r>0);n.querySelector(".unseenCount").innerText=t(r);n.querySelector(".unseenPlus").innerText=i(r)};n._updateUnseenFav=function(n){Jx.setClass(n,"showUnseenFav",this._hasUnseenFav())};n._updateErrorState=function(n){Jx.log.error("updateAggregatedError: "+this._hasError());Jx.setClass(n,"showError",this._hasError())};n._hasError=function(){return this._accounts.reduce(function(n,t){return n||t.hasError},false)};n._unseenInboxCount=function(){return this._accounts.reduce(function(n,t){return n+t.unseenInboxCount},0)};n._hasUnseenFav=function(){return this._accounts.reduce(function(n,t){return n||t.hasUnseenFav},false)}})