Jx.delayDefine(Mail,"SelectedAccountOofPresenter",function(){"use strict";var t=Microsoft.WindowsLive.Platform,n,i;Mail.SelectedAccountOofPresenter=function(){this._mb=null;this._selection=null;this._className="";this._oofIndicatorSwitcher=null;this._account=null;this._disposer=null};n=Mail.SelectedAccountOofPresenter.prototype;i="oofIndicator";n.init=function(n,t,i){this._mb=n;this._selection=t;this._className=i;this._oofIndicatorSwitcher=new Mail.OofIndicatorSwitcher(this._showOofPresenter.bind(this),this._hideOofPresenter.bind(this),true);this._disposer=new Mail.Disposer(this._oofIndicatorSwitcher,new Mail.EventHook(t,"navChanged",this._onNavigation,this));this._setAccount(t.account.platformObject)};n.dispose=function(){Jx.dispose(this._disposer)};n._showOofPresenter=function(){this._mb.addErrorMessage(i,0,{messageText:Jx.res.getString("mailOofPresenterMessage"),button1:{text:Jx.res.getString("mailOofPresenterTurnOffBtn"),tooltip:Jx.res.getString("mailOofPresenterTurnOffBtn"),callback:this._turnOffOof.bind(this)},button2:{text:Jx.res.getString("mailOofPresenterIgnoreBtn"),tooltip:Jx.res.getString("mailOofPresenterIgnoreBtn"),callback:this._ignoreOof.bind(this)},cssClass:this._className})};n._hideOofPresenter=function(){this._mb.removeMessage(i)};n._turnOffOof=function(){var n=this._account,i=n.getResourceByType(t.ResourceType.mail),r=n.getServerByType(t.ServerType.eas);r.oofState=false;i.isSyncNeeded=true;try{n.commit()}catch(u){Jx.log.exception("Mail.SelectedAccountOofPresenter._turnOffOof failed on commit.",u)}this._hideOofPresenter()};n._ignoreOof=function(){var n=this._account,i=n.getServerByType(t.ServerType.eas);i.oofLastIgnoredTime=new Date;try{n.commit()}catch(r){Jx.log.exception("Mail.SelectedAccountOofPresenter._ignoreOof failed on commit.",r)}this._hideOofPresenter()};n._setAccount=function(n){this._account=n;this._oofIndicatorSwitcher.setAccount(n)};n._onNavigation=function(n){n.accountChanged&&this._setAccount(n.target.account.platformObject)}})