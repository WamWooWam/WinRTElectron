Jx.delayDefine(Mail,"AriaFlows",function(){"use strict";function i(n){var t=n.id;return t||(t=n.id="ariaFlowStep"+Jx.uid()),t}var t=Mail.AriaFlows=function(n,t){this.initComponent();this._child=n;this.appendChild(n);this._excluded=t;this._job=null;this._startId="ariaFlowStart"+this._id;this._endId="ariaFlowEnd"+this._id},n;Jx.inherit(t,Jx.Component);n=t.prototype;n.getUI=function(n){n.html="<div id='"+this._id+"'><div id='"+this._startId+"' aria-hidden='true'><\/div>"+Jx.getUI(this._child).html+"<div id='"+this._endId+"' aria-hidden='true'><\/div><\/div>"};n.onActivateUI=function(){this.on("contentUpdated",this._queueUpdate,this);this._queueUpdate()};n.onDeactivateUI=function(){Jx.dispose(this._job);this.detach("contentUpdated",this._queueUpdate,this)};n._queueUpdate=function(){Jx.dispose(this._job);this._job=Jx.scheduler.addJob(null,Mail.Priority.updateAriaFlow,null,this._update,this)};n._update=function(){for(var c=document.getElementById(this._id),s=c.querySelectorAll("[role]"),u=[],f=[],h=this._excluded,e,o,n,t=0,r=s.length;t<r;++t)n=s[t],n.getAttribute("role")!=="list"&&(Jx.isNonEmptyString(h)&&n.matches(h)||getComputedStyle(n).display==="none"?f.push(n):u.push(n));for(e=0,t=0,r=u.length;t<r;++t)u[t].getAttribute("role")==="option"&&e++;for(o=0,t=0,r=u.length;t<r;++t)n=u[t],Mail.setAttribute(n,"x-ms-aria-flowfrom",t>0?i(u[t-1]):this._startId),Mail.setAttribute(n,"aria-flowto",t<r-1?i(u[t+1]):this._endId),n.getAttribute("role")==="option"?(o++,Mail.setAttribute(n,"aria-posinset",o.toString()),Mail.setAttribute(n,"aria-setsize",e.toString())):(n.removeAttribute("aria-posinset"),n.removeAttribute("aria-setsize")),n.removeAttribute("aria-hidden");for(t=0,r=f.length;t<r;++t)n=f[t],n.removeAttribute("x-ms-aria-flowfrom"),n.removeAttribute("aria-flowto"),n.removeAttribute("aria-posinset"),n.removeAttribute("aria-setsize"),Mail.setAttribute(n,"aria-hidden","true")}})