(function(){"use strict";function o(n,t){var r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),i=new Date(r);return i.setDate(i.getDate()-6),t>=i}function f(n,t){var i=new Date(n.getFullYear()-1,n.getMonth(),n.getDate()+1);return t>=i}function u(n,t){return n.getDate()===t.getDate()&&n.getMonth()===t.getMonth()&&n.getFullYear()===t.getFullYear()}var n=Mail.Utilities,e=Microsoft.WindowsLive.Platform,t=e.Result,i={},r;n.minValidDate=-116417952e5;n.msInOneHour=36e5;n.msInFourHours=n.msInOneHour*4;n.msInOneDay=n.msInOneHour*24;i[t.e_HTTP_BAD_REQUEST]="mailSendErrorMessageTooLarge";i[t.e_HTTP_DISK_SPACE]="mailSendErrorMessageTooLarge";i[t.e_NEXUS_STATUS_MAILBOX_SENDQUOTAEXCEEDED]="mailSendErrorMessageTooLarge";i[t.e_NEXUS_STATUS_MESSAGE_ATTACHMENTSTOOLARGE]="mailSendErrorMessageTooLarge";i[t.e_HTTP_REQUEST_TOO_LARGE]="mailSendErrorMessageTooLarge";i[t.ixp_E_SMTP_552_STORAGE_OVERFLOW]="mailSendErrorProblemWithAttachments";i[t.e_NEXUS_STATUS_MESSAGE_RECEIPIENTUNRESOLVED]="mailSendErrorUnresolvedRecipient";i[t.e_NEXUS_STATUS_MESSAGE_HASNORECIPIENT]="mailSendErrorUnresolvedRecipient";i[t.e_NEXUS_STATUS_MESSAGE_REPLYNOTALLOWED]="mailSendErrorReplyNotAllowed";i[t.e_NEXUS_STATUS_ITEM_NOTFOUND]="mailSendErrorOriginalEventDeleted";r=function(){if(Mail.writeProfilerMark("Utilities.initializeFormatters",Mail.LogEvent.start),!n.shortTimeFormatter){var t=Windows.Globalization.DateTimeFormatting;n.shortDateFormatterSameYear=new t.DateTimeFormatter(t.YearFormat.none,t.MonthFormat.abbreviated,t.DayFormat["default"],t.DayOfWeekFormat.none);n.shortTimeFormatter=new t.DateTimeFormatter("shorttime");n.shortWeekDayFormatter=new t.DateTimeFormatter(t.YearFormat.none,t.MonthFormat.none,t.DayFormat.none,t.DayOfWeekFormat.abbreviated);n.shortDateFormatter=t.DateTimeFormatter.shortDate;n.abbreviatedDateFormatter=new t.DateTimeFormatter(t.YearFormat.abbreviated,t.MonthFormat.abbreviated,t.DayFormat.default,t.DayOfWeekFormat.abbreviated);n.abbreviatedDateFormatterSameYear=new t.DateTimeFormatter(t.YearFormat.none,t.MonthFormat.abbreviated,t.DayFormat.default,t.DayOfWeekFormat.abbreviated);n.verboseDateFormatter=new t.DateTimeFormatter("year month dayofweek day");n.longDateFormatter=t.DateTimeFormatter.longDate}r=Jx.fnEmpty;Mail.writeProfilerMark("Utilities.initializeFormatters",Mail.LogEvent.stop)};n.getAbbreviatedDateString=function(t){return t?(r(),f(new Date,t)?n.abbreviatedDateFormatterSameYear.format(t):n.abbreviatedDateFormatter.format(t)):" "};n.getVerboseDateString=function(t){return t?(r(),n.verboseDateFormatter.format(t)):""};n.getShortTimeString=function(t){return t?(r(),n.shortTimeFormatter.format(t)):""};n.getShortDateString=function(t){return t?n._formatShortDate(new Date,t):""};n._formatShortDate=function(t,i){var s,e;return i?(s="",i&&i.getTime()!==0&&(e=null,r(),u(t,i)?e=n.shortTimeFormatter:(t>i&&(o(t,i)?e=n.shortWeekDayFormatter:f(t,i)&&(e=n.shortDateFormatterSameYear)),e||(e=n.shortDateFormatter)),s=e.format(i)),s):" "};n.getCalendarEventTimeRange=function(t,i){var o,f,s,c,y,l,p,a,e,h,v,w,b;if(o=i.startDate,f=i.endDate,o<n.minValidDate||f<n.minValidDate)return"";if(r(),s=n.longDateFormatter,c=n.shortTimeFormatter,i.eventType===Microsoft.WindowsLive.Platform.Calendar.EventType.series){y=Mail.Globals.platform;l=y.calendarManager;try{p=l.getEventFromUID(t,i.uid);a=l.getNextEvent(p.id);a&&(i=a)}catch(k){}}return e=s.format(o),i.allDayEvent?(f=new Date(f.getTime()-1),e=u(o,f)?Jx.res.loadCompoundString("AllDaySuffix",e):Jx.res.loadCompoundString("DateRange",e,s.format(f))):(h=c.format(o).replace(/ /g," "),o.getTime()===f.getTime()?e+=" "+h:(v=c.format(f).replace(/ /g," "),u(o,f)?e+=" "+Jx.res.loadCompoundString("TimeRange",h,v):(w=e+" "+h,b=s.format(f)+" "+v,e=Jx.res.loadCompoundString("DateRange",w,b)))),e};n.isRtlScript={arab:true,armi:true,avst:true,cprt:true,egyd:true,egyh:true,hebr:true,ital:true,khar:true,linb:true,lydi:true,mand:true,merc:true,nkoo:true,orkh:true,phli:true,phlp:true,phlv:true,phnx:true,prti:true,samr:true,sarb:true,syrc:true,syre:true,syrj:true,syrn:true,thaa:true};n._currentInputMethodLanguageTag=null;n._currentHaveRtlLanguage=null;n.haveRtlLanguage=function(){var t=Windows.Globalization.Language.currentInputMethodLanguageTag,i;return n._currentInputMethodLanguageTag!==t&&(Mail.writeProfilerMark("Utilities.haveRtlLanguage",Mail.LogEvent.start),n._currentInputMethodLanguageTag=t,i=Windows.System.UserProfile.GlobalizationPreferences.languages,n._currentHaveRtlLanguage=i.some(function(t){var i=new Windows.Globalization.Language(t);return n.isRtlScript[i.script.toLowerCase()]}),Mail.writeProfilerMark("Utilities.haveRtlLanguage",Mail.LogEvent.stop)),n._currentHaveRtlLanguage};n.getSendErrorString=function(n,r){var u=i[n];return Jx.res.loadCompoundString(Jx.isNonEmptyString(u)?u:"mailSendErrorGeneric",r.emailAddress)}})()