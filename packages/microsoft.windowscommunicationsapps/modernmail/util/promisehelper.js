Jx.delayDefine(Mail,"Promises",function(){var n=Mail.Promises={waitForEvent:function(n,t,i){var r=null;return new WinJS.Promise(function(u){r=new Mail.EventHook(n,t,function(n){(!i||i(n))&&(u(n),r.dispose())})},function(){Jx.dispose(r)})},waitForEventWithTimeout:function(n,t,i,r){var u=Mail.Promises.waitForEvent(n,t,i);return WinJS.Promise.timeout(r||5e3,u).then(function(n){return n},Jx.fnEmpty)},wrapWithRAF:function(n){return new WinJS.Promise(function(t){var i=function(){n().done(function(){t()})};requestAnimationFrame(i)})}};n.AsyncJob=function(n,t,i){this._func=n;this._context=t;this._args=i;this._promise=new WinJS.Promise(function(n){this._complete=n}.bind(this))};n.AsyncJob.prototype={execute:function(){this._func&&(this._func.apply(this._context,this._args),this._complete())},dispose:function(){this._func=null;this._context=null;this._args=null;this._promise&&(this._promise.cancel(),this._promise=null)},get promise(){return WinJS.Promise.as(this._promise)}}})