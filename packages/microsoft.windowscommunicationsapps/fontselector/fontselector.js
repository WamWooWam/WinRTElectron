Jx.delayDefine(window,"FontSelector",function(){"use strict";var n,t,r,u,i;window.FontSelector={};n=window.FontSelector;n.BaseFontControl=function(n){this.initComponent();this._host=null;this._parseConfig(n);this._values=[]};Jx.augment(n.BaseFontControl,Jx.Component);Jx.augment(n.BaseFontControl,Jx.Events);t=n.BaseFontControl.prototype;t.addSelection=function(n){this._addElement(n)};t.focus=function(){this._getElement().focus()};t._addElement=function(){};t._createElement=function(){};t._parseConfig=function(n){var t,r,i;if(n)for(t in n)r="_"+t,i="_config_"+t,i in this&&Jx.isFunction(this[i])?this[i](n[t]):this.hasOwnProperty(r)&&(this[r]=n[t])};t._select=function(n){var t=this._getElement();t.value=n};t._validValue=function(n){return this._values.indexOf(n)!==-1};t._getElement=function(){return this._host?this._host.querySelector(this._selector):document.getElementById(this._id)};t._onChange=function(n){var t=this._getElement();this._value=t.value;n.value=this._value;this.raiseEvent("change",n)};t.activateUI=function(){Jx.Component.prototype.activateUI.call(this);var n=this._getElement();n.addEventListener("change",this._onChange,false);this._value&&this._select(this._value)};t.deactivateUI=function(){Jx.Component.prototype.deactivateUI.call(this);var n=this._getElement();n.removeEventListener("change",this._onChange,false)};n.NameControl=function(t){this._newOnFail=false;this._size=null;n.BaseFontControl.call(this,t);this._selector=".fontNameControl";this._onChange=this._onChange.bind(this);this._tmpOptions=[]};Jx.inherit(n.NameControl,n.BaseFontControl);r=n.NameControl.prototype;r._addElement=function(n,t){if(t=!Jx.isBoolean(t)||t,!this._validValue(n)&&(this._values.push(n),t&&this.hasUI())){var i=document.createElement("option"),r=this._getElement();i.value=n;i.innerText=n;i.style.fontFamily=n;r.appendChild(i)}};r.clear=function(){for(var t=this._getElement(),i=t.querySelectorAll("[data-temporary=true]"),n=i.length;n--;)t.removeChild(i[n]);this._tmpOptions=[]};r.getUI=function(n){var f=this._getFontNameList(),e={},t,o="",i,r,u;for(this._values=[],r=0;r<f.length;r++)t=f[r],e[t]||(i=Jx.escapeHtml(t),o+='<option value="'+i+'" style="font-family: '+i+';">'+i+"<\/option>",e[t]=true,this._values.push(t));u="";Boolean(this._size)&&(u=" size='"+this._size+"' ");n.html='<select id="'+this._id+'" class="fontNameControl" aria-label="'+Jx.res.getString("fontSelectorNameLabel")+'" aria-role="combobox" '+u+">"+o+"<\/select>"};r._validValue=function(n){return this._tmpOptions.indexOf(n)!==-1||this._values.indexOf(n)!==-1};r._getFontNameList=function(){var i,s;Jx.mark("getFontFamilies, StartTA, FontSelector");var o=Windows.System.UserProfile.GlobalizationPreferences.languages,u=false,f,e,t,n=[];for(i=0,s=o.length;i<s;i++)f=o[i].replace(/((ploc)|(locr))-/i,""),u||(e=Windows.Globalization.Language(f).script.toLowerCase(),(e==="latn"||e==="latin")&&(u=true)),t=new Windows.Globalization.Fonts.LanguageFontGroup(f),t.traditionalDocumentFont&&n.push(t.traditionalDocumentFont.fontFamily),t.modernDocumentFont&&n.push(t.modernDocumentFont.fontFamily),t.fixedWidthTextFont&&n.push(t.fixedWidthTextFont.fontFamily),t.documentAlternate1Font&&n.push(t.documentAlternate1Font.fontFamily),t.documentAlternate2Font&&n.push(t.documentAlternate2Font.fontFamily);return u&&(n=n.concat(["Arial","Times New Roman","Tahoma","Verdana","Georgia"])),Jx.mark("getFontFamilies, StopTA, FontSelector"),n=n.concat(this._values),n.sort(),this._values=n,r._getFontNameList=function(){return n},this._values};r._config_fonts=function(n){this._getFontNameList=function(){for(var t=0;t<n.length;t++)this._addElement(n[t],false);return this._values}};Object.defineProperty(r,"value",{get:function(){return this._value},set:function(n){if(!this._validValue(n))if(!this._newOnFail||Jx.isNullOrUndefined(n))n=null;else{var t=document.createElement("option"),i=this._getElement();t.value=n;t.innerText=n;t.setAttribute("data-temporary","true");t.style.fontFamily=n;i.appendChild(t);this._tmpOptions.push(n)}this._value=n;this.hasUI()&&this._select(n)},enumerable:true});n.SizeControl=function(t){this._size=null;n.BaseFontControl.call(this,t);this._selector=".fontSizeControl";this._onChange=this._onChange.bind(this)};Jx.inherit(n.SizeControl,n.BaseFontControl);u=n.SizeControl.prototype;u.getUI=function(n){for(var u=this._getFontSizes(),f="",t,r,i=u.length;i--;)t=u[i],f+='<option value="'+t+'pt">'+t+"<\/option>";return r="",Boolean(this._size)&&(r=" size='"+this._size+"' "),n.html='<select class="fontSizeControl" id="'+this._id+'" aria-label="'+Jx.res.getString("fontSelectorSizeLabel")+'" aria-role="combobox" '+r+">"+f+"<\/select>",n};u._addElement=function(n,t){if(t=!Jx.isBoolean(t)||t,!this._validValue(n)&&(this._values.push(n),t&&this.hasUI())){var r=this._getElement(),i=document.createElement("option");i.value=n+"pt";i.innerText=n;r.appendChild(i)}};u._getFontSizes=function(){for(var t=[36,24,18,14,13,12,11,10,8],n=t.length;n--;)this._addElement(t[n],false);return this._values};u._config_sizes=function(n){this._getFontSizes=function(){for(var t=0;t<n.length;t++)this._addElement(n[t],false);return this._values}};Object.defineProperty(u,"value",{get:function(){return Jx.isNumber(this._value)?this._value+"pt":this._value},set:function(n){var t=null;if(Jx.isNullOrUndefined(n)||Jx.isNumber(n))t=n;else if(/^[0-9]+(\.[0-9]+)?pt$/.test(n))t=Number(n.replace("pt",""));else if(/^[0-9]+(\.[0-9]+)?px$/.test(n))t=Math.round(Number(n.replace("px",""))*.75);else return;this._validValue(t)||(t=null);this._value=t;this.hasUI()&&this._select(Jx.isNullOrUndefined(t)?null:t+"pt")},enumerable:true});n.ColorControl=function(t){this._menuArrowKeyHandler=true;this._itemsTabbable=true;this._label=Jx.res.getString("fontSelectorColorLabel");n.BaseFontControl.call(this,t);this._selector=".fontColorControl";this._onClick=this._onClick.bind(this);this._selectedButton=null;this._onMutation=this._onMutation.bind(this);this._observer=null};Jx.inherit(n.ColorControl,n.BaseFontControl);i=n.ColorControl.prototype;i.activateUI=function(){var n=this._getElement(),t,i;this._menuArrowKeyHandler&&(t={querySelector:"[role='menuitemradio']",itemsTabbable:this._itemsTabbable},i=new MenuArrowKeyHandler(n,t),this.appendChild(i));Jx.Component.prototype.activateUI.call(this);n.addEventListener("click",this._onClick,false);this._value&&this._select(this._value);this._observer=new MutationObserver(this._onMutation);this._observer.observe(n,{attributes:true,subtree:true,attributeFilter:["aria-checked"]})};i.deactivateUI=function(){Jx.Component.prototype.deactivateUI.call(this);var n=this._getElement();n.removeEventListener("click",this._onClick,false);this._observer.disconnect();this._observer=null};i._onClick=function(n){var t=n.target;t.nodeName==="BUTTON"&&(Jx.isObject(this._selectedButton)&&t!==this._selectedButton&&this._selectedButton.setAttribute("aria-checked","false"),t.setAttribute("aria-checked","true"))};i._onMutation=function(n){var t,i;if(n.length===1){n[0].target.setAttribute("aria-checked","true");this._selectedButton||(this._selectedButton=n[0].target,this._value=this._selectedButton.value,this.raiseEvent("change",{value:this._value}));this._observer.takeRecords();return}for(t=n.length;t--;)i=n[t],i.target.getAttribute("aria-checked")==="true"&&(this._selectedButton=i.target,this._value=this._selectedButton.value,this.raiseEvent("change",{value:this._value}))};i.getUI=function(n){var h=this._getColors(),c=-1,r=-1,u,l="",a="",f,t,s;this._gridLayout&&this._rows&&this._columns&&(a="-ms-grid-rows: "+this._rows+"; -ms-grid-columns: "+this._columns+"; display: -ms-grid;",c=this._rows.trim().split(" ").length,r=this._columns.trim().split(" ").length);var v=1,e=1,o="",i="";for(t=1;t<=h.length;t++)u=h[t-1],f="",this._gridLayout&&c>0&&r>0&&(f+="-ms-grid-row: "+v+"; -ms-grid-column: "+e+++";",e>r&&(v++,e=1)),s="",o=u.name,i=u.value.toUpperCase(),i==="#FFFFFF"&&(s='<div class="whiteButton"><\/div>'),l+='<button role="menuitemradio" id="'+this._id+t+'" style="background-color: '+i+";"+f+'" title="'+o+'" aria-label="'+o+'" unselectable="on" class="fontColorButton'+t+' fontColorButton" value="'+i+'">'+s+"<\/button>",this._values.push(i);n.html='<div unselectable="on" class="fontColorControl" role="menu" id="'+this._id+'" style="'+a+'" tabindex="0" aria-label="'+this._label+'">'+l+"<\/div>"};i._addElement=function(){};i._select=function(n){var u=this._getElement(),r,i,t;for(r=u.childNodes,this._selectedButton=null,i=0;i<r.length;i++)t=r[i],t.value===n&&(this._selectedButton=t,this._value=this._selectedButton.value),t.setAttribute("aria-checked",t.value===n?"true":"false");this._observer.takeRecords()};Object.defineProperty(i,"value",{get:function(){return this._value},set:function(n){var t;if(/rgb\(.*\)/i.test(n)){t=n.replace(/[\srgb\(\)]/gi,"").split(",");var i=this._mapToHex(t[0]),r=this._mapToHex(t[1]),u=this._mapToHex(t[2]);n=("#"+i+r+u).toUpperCase()}this._validValue(n)||(n=null);this._value=n;this.hasUI()&&this._select(n)},enumerable:true});i._mapToHex=function(n){var t=Number(n).toString(16).toUpperCase();return t.length===1&&(t="0"+t),t};i._config_colors=function(n){this._getColors=function(){return n}};i._config_gridLayout=function(n){this._gridLayout=Jx.isObject(n);this._gridLayout&&(this._rows=n.rows,this._columns=n.columns)}})