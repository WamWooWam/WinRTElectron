// --------------------------------------------------
// <auto-generated>
//     This code was generated by tswinrt.
//     Generated from Windows 255.255.255.255 at Fri Mar 26 17:23:00 2021
// </auto-generated>
// --------------------------------------------------

import { DataPackageOperation } from "./DataPackageOperation";
import { DataPackagePropertySetView } from "./DataPackagePropertySetView";
import { IMapView } from "../../Foundation/Collections/IMapView`2";
import { IVectorView } from "../../Foundation/Collections/IVectorView`1";
import { AsyncOperation, IAsyncOperation } from "../../Foundation/IAsyncOperation`1";
import { GenerateShim } from "../../Foundation/Interop/GenerateShim";
import { Uri } from "../../Foundation/Uri";
import { IStorageItem } from "../../Storage/IStorageItem";
import { RandomAccessStreamReference } from "../../Storage/Streams/RandomAccessStreamReference";
import { StandardDataFormats } from "./StandardDataFormats";
import { Dictionary } from "../../Foundation/Interop/Dictionary`2";
import { Vector } from "../../Foundation/Interop/Vector`1";
const { clipboard } = require('electron')

@GenerateShim('Windows.ApplicationModel.DataTransfer.ClipboardPackageView')
export class ClipboardPackageView {
    constructor() {
        console.log(clipboard.availableFormats());
        this.availableFormats = new Vector();
        this.properties = new DataPackagePropertySetView();
        this.requestedOperation = DataPackageOperation.copy;
    }

    availableFormats: IVectorView<string> = null;
    properties: DataPackagePropertySetView = null;
    requestedOperation: DataPackageOperation = null;
    reportOperationCompleted(value: DataPackageOperation): void {
        console.warn('DataPackageView#reportOperationCompleted not implemented')
    }
    contains(formatId: string): boolean {
        // throw new Error('DataPackageView#contains not implemented')
        let formats = clipboard.availableFormats();
        if (formatId == StandardDataFormats.text && formats.includes("text/plain"))
            return true;

        return false;
    }
    getDataAsync(formatId: string): IAsyncOperation<any> {
        throw new Error('DataPackageView#getDataAsync not implemented')
    }
    getTextAsync(): IAsyncOperation<string> {
        // throw new Error('DataPackageView#getTextAsync not implemented')
        return AsyncOperation.from(async () => {
            return clipboard.readText();
        })
    }
    getCustomTextAsync(formatId: string): IAsyncOperation<string> {
        throw new Error('DataPackageView#getCustomTextAsync not implemented')
    }
    getUriAsync(): IAsyncOperation<Uri> {
        return AsyncOperation.from(async () => {
            return new Uri(clipboard.readBookmark().url);
        })
    }
    getHtmlFormatAsync(): IAsyncOperation<string> {
        return AsyncOperation.from(async () => {
            return clipboard.readHTML();
        })
    }
    getResourceMapAsync(): IAsyncOperation<IMapView<string, RandomAccessStreamReference>> {
        // throw new Error('DataPackageView#getResourceMapAsync not implemented')
        return AsyncOperation.from(async () => new Dictionary());
    }
    getRtfAsync(): IAsyncOperation<string> {
        return AsyncOperation.from(async () => {
            return clipboard.readRTF();
        })
    }
    getBitmapAsync(): IAsyncOperation<RandomAccessStreamReference> {
        throw new Error('DataPackageView#getBitmapAsync not implemented')
    }
    getStorageItemsAsync(): IAsyncOperation<IVectorView<IStorageItem>> {
        throw new Error('DataPackageView#getStorageItemsAsync not implemented')
    }
    getApplicationLinkAsync(): IAsyncOperation<Uri> {
        throw new Error('DataPackageView#getApplicationLinkAsync not implemented')
    }
    getWebLinkAsync(): IAsyncOperation<Uri> {
        throw new Error('DataPackageView#getWebLinkAsync not implemented')
    }
}
